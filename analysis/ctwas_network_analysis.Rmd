---
title: "cTWAS network analysis"
output: html_document
date: '2025-9-7'
editor_options: 
  chunk_output_type: console
---


```{r echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
library(igraph)
library(ggraph)
library(tidygraph)
library(tidyverse)
```

### LDL
Functions of clusters in the network
* The biggest cluster is Cholesterol metabolism.
* DMTN, INHBB, ACVR1C: Activin receptor signaling pathway. 
* USP53, USP39, TRIM39: Ubiquitin carboxyl-terminal hydrolase. TRIM39 is an E3 ubiquitin ligase. 
* GAS6 and TIMD4: phosphatidylserine binding .
* ABCA8, ADH1B, CYP2A6: ABCA8 is ATP-dependent lipophilic drug transporter. ADH1B and CYP2A6 involve in drug metabolism.
```{r,echo=FALSE, message=FALSE, warning=FALSE, fig.width= 5, fig.height= 5}
string <- read.table("/project/xinhe/shengqian/cTWAS_paper_figures/data/string_LDL.tsv",header = F)
graph <- graph_from_data_frame(d = string, directed = FALSE)
comp <- components(graph)
V(graph)$component <- comp$membership
set.seed(123)
ggraph(graph, layout = "fr", niter = 1000, area = vcount(graph)^2.4) +
  geom_edge_link(aes(alpha = 0.4), color = "grey70") +
  geom_node_point(aes(color = factor(component)), size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void() + theme(legend.position = "none")
```

### IBD
Functions of clusters in the network
* The biggest cluster is Leukocyte and Lymphocyte activiation. 
* GPR35 and RGS14: They are connected in the G protein signaling network. GPR35, when activated, signals through G proteins. RGS14 can regulate the duration and strength of such GPCR signals by accelerating GPT hydrolysis in Ga subunits
* ADAM15 and IP6K2: cell adhesion, migration and apoptosis. 
```{r,echo=FALSE, message=FALSE, warning=FALSE, fig.width= 5, fig.height= 5}
string <- read.table("/project/xinhe/shengqian/cTWAS_paper_figures/data/string_IBD.tsv",header = F)
graph <- graph_from_data_frame(d = string, directed = FALSE)
comp <- components(graph)
V(graph)$component <- comp$membership
set.seed(1233)
ggraph(graph, layout = "fr", niter = 1000, area = vcount(graph)^2.4) +
  geom_edge_link(aes(alpha = 0.4), color = "grey70") +
  geom_node_point(aes(color = factor(component)), size = 5) +
  geom_node_text(aes(label = name), repel = TRUE) +
  theme_void() + theme(legend.position = "none")
```