---
title: "Comparing Munro st & Susie st models in multi-group analysis"
author: "XSun"
date: "2025-04-07"
output:
  workflowr::wflow_html:
    code_folding: hide
    toc: true
---

# Introduction

The Susie st models are trained here https://sq-96.github.io/multigroup_ctwas_analysis/data_weight_training_fusionscale_rsqupdated_allhaveqtl.html

The Munro's model are from this paper https://www.nature.com/articles/s41467-024-54840-8

```{r warning=F,message=F}
library(ctwas)
library(ggplot2)
library(tidyverse)

source("/project/xinhe/xsun/multi_group_ctwas/data/samplesize.R")

folder_results_munroST <- "/project/xinhe/shengqian/ctwas_GWAS_analysis/snakemake_outputs/"
folder_results_susieST <- "/project/xinhe/xsun/multi_group_ctwas/15.susie_weights/snakemake_outputs/"
folder_results_woST <- "/project/xinhe/shengqian/ctwas_GWAS_analysis/snakemake_outputs/"

# mapping_predictdb <- readRDS("/project2/xinhe/shared_data/multigroup_ctwas/weights/mapping_files/PredictDB_mapping.RDS")
# mapping_munro <- readRDS("/project2/xinhe/shared_data/multigroup_ctwas/weights/mapping_files/Munro_mapping.RDS")
# mapping_two <- rbind(mapping_predictdb,mapping_munro)

colors <- c(  "#1f77b4", "#ff7f0e", "#2ca02c", "#d62728",  "#9467bd", "#8c564b", "#e377c2", "#7f7f7f",  "#bcbd22",  "#17becf",  "#f7b6d2",  "#c5b0d5",  "#9edae5", "#ffbb78",  "#98df8a",  "#ff9896" )

plot_piechart <- function(ctwas_parameters, colors, by, title) {
  # Create the initial data frame
  data <- data.frame(
    category = names(ctwas_parameters$prop_heritability),
    percentage = ctwas_parameters$prop_heritability
  )
  
  # Split the category into context and type
  data <- data %>%
    mutate(
      context = sub("\\|.*", "", category),
      type = sub(".*\\|", "", category)
    )
  
  # Aggregate the data based on the 'by' parameter
  if (by == "type") {
    data <- data %>%
      group_by(type) %>%
      summarize(percentage = sum(percentage)) %>%
      mutate(category = type)  # Use type as the new category
  } else if (by == "context") {
    data <- data %>%
      group_by(context) %>%
      summarize(percentage = sum(percentage)) %>%
      mutate(category = context)  # Use context as the new category
  } else {
    stop("Invalid 'by' parameter. Use 'type' or 'context'.")
  }
  
  # Calculate percentage labels for the chart
  data$percentage_label <- paste0(round(data$percentage * 100, 1), "%")
  
  # Create the pie chart
  pie <- ggplot(data, aes(x = "", y = percentage, fill = category)) +
    geom_bar(stat = "identity", width = 1) +
    coord_polar("y", start = 0) +
    theme_void() +  # Remove background and axes
    geom_text(aes(label = percentage_label), 
              position = position_stack(vjust = 0.5), size = 3) +  # Adjust size as needed
    scale_fill_manual(values = colors) +  # Custom colors
    labs(fill = "Category") +  # Legend title
    ggtitle(title)  # Title
  
  return(pie)
}


```


# LDL-ukb-d-30780_irnt

## Setting: shared_all, thin = 0.1

```{r warning=F,message=F}
trait <- "LDL-ukb-d-30780_irnt"
thin <- 0.1
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```

## Setting: shared_all, thin = 0.5

```{r warning=F,message=F}
thin <- 0.5
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```


## Setting: shared_all, thin = 1

```{r warning=F,message=F}
thin <- 1
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```


## Setting: shared_type, thin = 0.1

```{r warning=F,message=F}
thin <- 0.1
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```







## Setting: shared_type, thin = 0.5

```{r warning=F,message=F}
thin <- 0.5
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```







## Setting: shared_type, thin = 1

```{r warning=F,message=F}
thin <- 1
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```


```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```








# IBD-ebi-a-GCST004131

## Setting: shared_all, thin = 0.1

```{r warning=F,message=F}
trait <- "IBD-ebi-a-GCST004131"
thin <- 0.1
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```

## Setting: shared_all, thin = 0.5

```{r warning=F,message=F}
thin <- 0.5
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```


## Setting: shared_all, thin = 1

```{r warning=F,message=F}
thin <- 1
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```


## Setting: shared_type, thin = 0.1

```{r warning=F,message=F}
thin <- 0.1
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```







## Setting: shared_type, thin = 0.5

```{r warning=F,message=F}
thin <- 0.5
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```







## Setting: shared_type, thin = 1

```{r warning=F,message=F}
thin <- 1
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```


```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```








# T2D-panukb

## Setting: shared_all, thin = 0.1

```{r warning=F,message=F}
trait <- "T2D-panukb"
thin <- 0.1
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```

## Setting: shared_all, thin = 0.5

```{r warning=F,message=F}
thin <- 0.5
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```


## Setting: shared_all, thin = 1

```{r warning=F,message=F}
thin <- 1
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```


## Setting: shared_type, thin = 0.1

```{r warning=F,message=F}
thin <- 0.1
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```







## Setting: shared_type, thin = 0.5

```{r warning=F,message=F}
thin <- 0.5
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```







## Setting: shared_type, thin = 1

```{r warning=F,message=F}
thin <- 1
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```


```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```








# BMI-panukb


## Setting: shared_all, thin = 0.1

```{r warning=F,message=F}
trait <- "BMI-panukb"
thin <- 0.1
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```

## Setting: shared_all, thin = 0.5

```{r warning=F,message=F}
thin <- 0.5
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```


## Setting: shared_all, thin = 1

```{r warning=F,message=F}
thin <- 1
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```


## Setting: shared_type, thin = 0.1

```{r warning=F,message=F}
thin <- 0.1
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```







## Setting: shared_type, thin = 0.5

```{r warning=F,message=F}
thin <- 0.5
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```







## Setting: shared_type, thin = 1

```{r warning=F,message=F}
thin <- 1
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```


```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```









# RBC-panukb


## Setting: shared_all, thin = 0.1

```{r warning=F,message=F}
trait <- "RBC-panukb"
thin <- 0.1
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```

## Setting: shared_all, thin = 0.5

```{r warning=F,message=F}
thin <- 0.5
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```


## Setting: shared_all, thin = 1

```{r warning=F,message=F}
thin <- 1
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```


## Setting: shared_type, thin = 0.1

```{r warning=F,message=F}
thin <- 0.1
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```







## Setting: shared_type, thin = 0.5

```{r warning=F,message=F}
thin <- 0.5
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```

```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```







## Setting: shared_type, thin = 1

```{r warning=F,message=F}
thin <- 1
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F}
st <- "without_ST"

param_woST <- readRDS(paste0(folder_results_woST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_woST <- summarize_param(param_woST, gwas_n)
total_nonSNPpve_woST <- 1- ctwas_parameters_woST$prop_heritability["SNP"]
pve_pie_by_type_woST <- plot_piechart(ctwas_parameters = ctwas_parameters_woST, colors = colors, by = "type", title = paste0("withoutST - nonSNP %h2g:",round(total_nonSNPpve_woST, digits = 4)))

```

```{r warning=F,message=F}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

```

```{r warning=F,message=F}

st <- "with_ST"
param_munroST <- readRDS(paste0(folder_results_munroST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)

ctwas_parameters_munroST <- summarize_param(param_munroST, gwas_n)
total_nonSNPpve_munroST <- 1- ctwas_parameters_munroST$prop_heritability["SNP"]
pve_pie_by_type_munroST <- plot_piechart(ctwas_parameters = ctwas_parameters_munroST, colors = colors, by = "type", title = paste0("munroST - nonSNP %h2g:",round(total_nonSNPpve_munroST, digits = 4)))

```


```{r warning=F,message=F,fig.width=12, fig.height=5}
gridExtra::grid.arrange(pve_pie_by_type_woST, pve_pie_by_type_susieST,pve_pie_by_type_munroST, 
                        ncol = 3, top = paste0(trait,"-thin",thin,"-",var_struc))        

```









# aFib-ebi-a-GCST006414

## Setting: shared_all, thin = 0.1

```{r warning=F,message=F}
trait <- "aFib-ebi-a-GCST006414"
thin <- 0.1
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```


```{r warning=F,message=F,fig.width=5, fig.height=5}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

pve_pie_by_type_susieST

```



## Setting: shared_all, thin = 0.5

```{r warning=F,message=F}
thin <- 0.5
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```
```{r warning=F,message=F,fig.width=5, fig.height=5}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

pve_pie_by_type_susieST

```

## Setting: shared_all, thin = 1

```{r warning=F,message=F}
thin <- 1
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F,fig.width=5, fig.height=5}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

pve_pie_by_type_susieST

```

## Setting: shared_type, thin = 0.1

```{r warning=F,message=F}
thin <- 0.1
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F,fig.width=5, fig.height=5}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

pve_pie_by_type_susieST

```






## Setting: shared_type, thin = 0.5

```{r warning=F,message=F}
thin <- 0.5
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F,fig.width=5, fig.height=5}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

pve_pie_by_type_susieST

```




## Setting: shared_type, thin = 1

```{r warning=F,message=F}
thin <- 1
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F,fig.width=5, fig.height=5}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

pve_pie_by_type_susieST

```



# SCZ-ieu-b-5102

## Setting: shared_all, thin = 0.1

```{r warning=F,message=F}
trait <- "SCZ-ieu-b-5102"
thin <- 0.1
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```


```{r warning=F,message=F,fig.width=5, fig.height=5}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

pve_pie_by_type_susieST

```



## Setting: shared_all, thin = 0.5

```{r warning=F,message=F}
thin <- 0.5
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```
```{r warning=F,message=F,fig.width=5, fig.height=5}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

pve_pie_by_type_susieST

```


## Setting: shared_all, thin = 1

```{r warning=F,message=F}
thin <- 1
var_struc <- "shared_all"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F,fig.width=5, fig.height=5}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

pve_pie_by_type_susieST

```

## Setting: shared_type, thin = 0.1

```{r warning=F,message=F}
thin <- 0.1
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F,fig.width=5, fig.height=5}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

pve_pie_by_type_susieST

```






## Setting: shared_type, thin = 0.5

```{r warning=F,message=F}
thin <- 0.5
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F,fig.width=5, fig.height=5}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

pve_pie_by_type_susieST

```




## Setting: shared_type, thin = 1

```{r warning=F,message=F}
thin <- 1
var_struc <- "shared_type"

gwas_n <- samplesize[trait]
```

```{r warning=F,message=F,fig.width=5, fig.height=5}
st <- "with_susieST"

param_susieST <- readRDS(paste0(folder_results_susieST,"/",trait,"/",trait,".",st,".thin",thin,".",var_struc,".param.RDS"))


ctwas_parameters_susieST <- summarize_param(param_susieST, gwas_n)
total_nonSNPpve_susieST <- 1- ctwas_parameters_susieST$prop_heritability["SNP"]
pve_pie_by_type_susieST <- plot_piechart(ctwas_parameters = ctwas_parameters_susieST, colors = colors, by = "type", title = paste0("susieST - nonSNP %h2g:",round(total_nonSNPpve_susieST, digits = 4)))

pve_pie_by_type_susieST

```

