---
title: "Enrichment analysis for 6 Traits, 5 tissues, eQTL + sQTL + stQTL -- compute ukbb LD, eqtl, sqtl from predictdb; stQTL from Munro et al"
author: "XSun"
date: "2024-10-16"
output:
  workflowr::wflow_html:
    code_folding: hide
    toc: true
---

We do enrichment analysis for the results here: https://sq-96.github.io/multigroup_ctwas_analysis/multi_group_6traits_15weights_ess.html

# Methods 

## Non-redundant Go terms

- Do enrichment analysis with all the genes with PIP > 0.8, using `enrichR`
- Rank all GO terms by their significance (p-values). 
- A term was considered redundant if all the cTWAS genes in that term had already been included in a more significant GO term

## Fractional model 

The model is:  `glm(PIP ~ gene set membership, family = quasibinomial('logit'))`. We do this regression for one gene set at a time.

The PIP vector contains: 

-  all genes within the credible set: we use their actual PIPs
-  genes without the credible set & PIP < 0.1:  we set the PIPs as `0.5*min(gene pip within credible set)`

## Fisher exact test

We assign 1 to the genes with PIP > 0.5/0.8 & in cs and 0 for others. We name this vector as binarized_PIP. We test the association between the binarized_PIP and geneset_membership. 

The testing matrix is: 

| geneset_membership | 0   | 1   |
|--------------------|-----|-----|
| **binarized_pip 0**|  a  |  b  |
| **binarized_pip 1**|  c  |  d  |

Where:

- `a` is the count where `binarized_pip = 0` and `geneset_membership = 0`.
- `b` is the count where `binarized_pip = 0` and `geneset_membership = 1`.
- `c` is the count where `binarized_pip = 1` and `geneset_membership = 0`.
- `d` is the count where `binarized_pip = 1` and `geneset_membership = 1`.



# Summary for the number of Go terms with FDR < 0.05 

|                  |               | aFib | LDL  | IBD  | SBP  | SCZ  | WBC  |
|------------------|---------------|------|------|------|------|------|------|
| Non-redundant Go | gobp - pip0.8 | 18   | 10   | 18   | 1    | 2    | 11   |
|                  | gocc - pip0.8 | 7    | 14   | 1    | 0    | 0    | 4    |
|                  | gomf - pip0.8 | 2    | 3    | 3    | 0    | 0    | 0    |
| Fractional model | gobp          | 5806 | 4497 | 5122 | 3757 | 4291 | 1701 |
|                  | gocc          | 671  | 582  | 613  | 461  | 506  | 200  |
|                  | gomf          | 2148 | 1174 | 2144 | 1578 | 1800 | 699  |
| Fisher exact     | gobp - pip0.5 | 32   | 29   | 0    | 0    | 0    | 39   |
|                  | gocc - pip0.5 | 16   | 17   | 0    | 0    | 0    | 0    |
|                  | gomf - pip0.5 | 0    | 0    | 0    | 0    | 0    | 0    |
|                  | gobp - pip0.8 | 3    | 22   | 1    | 0    | 0    | 3    |
|                  | gocc - pip0.8 | 1    | 23   | 0    | 0    | 0    | 0    |
|                  | gomf - pip0.8 | 0    | 2    | 0    | 0    | 0    | 0    |


# Summary of non-redundant GO terms related to trait (summaried by chatgpt)

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}
DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
```


# Summary of GO terms selected by Fisher exact test (PIP > 0.5) (summaried by chatgpt)

|      |      | pathway                                            |
|------|------|----------------------------------------------------|
| aFib | gobp | cardiac conduction                                 |
|      |      | cell communication involved in cardiac conduction  |
|      |      | cardiac muscle contraction                         |
|      |      | regulation of heart rate                           |
|      |      | cardiac muscle cell action potential               |
|      |      | regulation of cardiac muscle contraction           |
|      |      | cell-cell signaling involved in cardiac conduction |
|      |      | regulation of heart rate by cardiac conduction     |
|      |      | heart contraction                                  |
|      |      | heart process                                      |
|      | gocc | sarcolemma                                         |
|      |      | contractile fiber                                  |
|      |      | myofibril                                          |
|      |      | sarcoplasm                                         |
|      |      | sarcomere                                          |
|      |      | Z disc                                             |
|      |      | I band                                             |
|      |      | cell junction                                      |
|      | gomf | /                                                  |
| LDL  | gobp | Cholesterol Transport                              |
|      |      | Lipoprotein Metabolic Process                      |
|      |      | Lipid Metabolic Process                            |
|      |      | Regulation of Plasma Lipoprotein Particle Levels   |
|      |      | Triglyceride Metabolic Process                     |
|      |      | Cholesterol Biosynthetic Process                   |
|      | gocc | endoplasmic reticulum                              |
|      |      | endocytic vesicle                                  |
|      |      | clathrin-coated endocytic vesicle membrane         |
|      |      | protein-lipid complex                              |
|      |      | plasma lipoprotein particle                        |
|      |      | lipoprotein particle                               |
|      |      | high-density lipoprotein particle                  |
|      |      | endosome membrane                                  |
|      |      | COPII-coated ER to Golgi transport vesicle         |
|      | gomf | /                                                  |
| IBD  | gobp | /                                                  |
|      | gocc | /                                                  |
|      | gomf | /                                                  |
| SBP  | gobp | /                                                  |
|      | gocc | /                                                  |
|      | gomf | /                                                  |
| SCZ  | gobp | /                                                  |
|      | gocc | /                                                  |
|      | gomf | /                                                  |
| WBC  | gobp | leukocyte activation                               |
|      |      | immune system process                              |
|      |      | myeloid leukocyte activation                       |
|      |      | myeloid leukocyte migration                        |
|      |      | leukocyte activation involved in immune response   |
|      |      | leukocyte mediated immunity                        |
|      |      | neutrophil mediated immunity                       |
|      |      | neutrophil activation                              |
|      |      | leukocyte degranulation                            |
|      |      | granulocyte migration                              |
|      |      | granulocyte activation                             |
|      |      | immune effector process                            |
|      |      | neutrophil activation involved in immune response  |
|      |      | neutrophil degranulation                           |
|      |      | leukocyte migration                                |
|      | gocc | /                                                  |
|      | gomf | /                                                  |

# Summary of GO terms selected by Fisher exact test (PIP > 0.8) (summaried by chatgpt)

|      |      | pathway                                          |
|------|------|--------------------------------------------------|
| aFib | gobp | sarcomere organization                           |
|      | gocc | /                                                |
|      | gomf | /                                                |
| LDL  | gobp | triglyceride metabolic process                   |
|      |      | cholesterol transport                            |
|      |      | sterol transport                                 |
|      |      | plasma lipoprotein particle clearance            |
|      |      | regulation of plasma lipoprotein particle levels |
|      |      | receptor-mediated endocytosis                    |
|      |      | low-density lipoprotein particle remodeling      |
|      |      | lipoprotein metabolic process                    |
|      | gocc | LDL particle structure and composition           |
|      |      | LDL receptor-mediated endocytosis                |
|      |      | Intracellular processing of LDL                  |
|      |      | Regulation of LDL receptor levels                |
|      |      | Synthesis and secretion of lipoproteins          |
|      | gomf | /                                                |
| IBD  | gobp | cellular response to cytokine stimulus           |
|      | gocc | /                                                |
|      | gomf | /                                                |
| SBP  | gobp | /                                                |
|      | gocc | /                                                |
|      | gomf | /                                                |
| SCZ  | gobp | /                                                |
|      | gocc | /                                                |
|      | gomf | /                                                |
| WBC  | gobp | /                                                |
|      | gocc | /                                                |
|      | gomf | /                                                |

# aFib-ebi-a-GCST006414

## Non-redundant Go terms

### GO biological process

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

trait <- "aFib-ebi-a-GCST006414"

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Biological_Process_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```

### GO cellular component 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Cellular_Component_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```


### GO molecular function 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Molecular_Function_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```


## Fractional model

### GO biological process

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


## Fisher 

### GO biological process -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```











### GO biological process -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```










# LDL-ukb-d-30780_irnt

## Non-redundant Go terms

### GO biological process

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

trait <- "LDL-ukb-d-30780_irnt"

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Biological_Process_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```

### GO cellular component 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Cellular_Component_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```


### GO molecular function 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Molecular_Function_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```


## Fractional model

### GO biological process

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


## Fisher 

### GO biological process -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```











### GO biological process -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```










# IBD-ebi-a-GCST004131

## Non-redundant Go terms

### GO biological process

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

trait <- "IBD-ebi-a-GCST004131"

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Biological_Process_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```

### GO cellular component 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Cellular_Component_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```


### GO molecular function 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Molecular_Function_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```


## Fractional model

### GO biological process

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


## Fisher 

### GO biological process -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```











### GO biological process -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```





# SBP-ukb-a-360

## Non-redundant Go terms

### GO biological process

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

trait <- "SBP-ukb-a-360"

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Biological_Process_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```

### GO cellular component 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Cellular_Component_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```


### GO molecular function 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Molecular_Function_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```


## Fractional model

### GO biological process

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


## Fisher 

### GO biological process -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```











### GO biological process -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```








# SCZ-ieu-b-5102

## Non-redundant Go terms

### GO biological process

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

trait <- "SCZ-ieu-b-5102"

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Biological_Process_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```

### GO cellular component 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Cellular_Component_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```


### GO molecular function 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Molecular_Function_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```


## Fractional model

### GO biological process

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


## Fisher 

### GO biological process -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```











### GO biological process -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```















# WBC-ieu-b-30

## Non-redundant Go terms

### GO biological process

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

trait <- "WBC-ieu-b-30"

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Biological_Process_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```

### GO cellular component 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Cellular_Component_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```


### GO molecular function 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

file <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_nonredundant_",trait,"_GO_Molecular_Function_2021.rdata")

if(file.exists(file)) {
  
  load(file)
  db_enrichment <- db_enrichment[db_enrichment$Adjusted.P.value < 0.05,]
  
  if(nrow(db_enrichment) > 0) {
    db_enrichment <- db_enrichment[,c("Term","Overlap","Adjusted.P.value","Odds.Ratio","Genes")]
    DT::datatable(db_enrichment,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO biological process'),options = list(pageLength = 10) )
  }else{
    print("No enriched Go terms")
  }
  
}else{
  print("No enriched Go terms")
}

```


## Fractional model

### GO biological process

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function 

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


## Fisher 

### GO biological process -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function -- cutoff pip>0.5

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip05_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```











### GO biological process -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gobp.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}
```

### GO cellular component -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gocc.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```


### GO molecular function -- cutoff pip>0.8

```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5}

load(paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_pip08_", trait, "_gomf.rdata"))

sprintf("the number of pathways included: %s", nrow(summary))
sprintf("the number of pathways with FDR <0.05 : %s", nrow(summary[summary$fdr < 0.05,]))

summary <- summary[order(summary$fdr, decreasing = F),]


if(nrow(summary[summary$fdr < 0.05,]) >= 1) {
  summary <- summary[1:nrow(summary[summary$fdr < 0.05,]),]
  DT::datatable(summary,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Enrichment results for GO molecular function , pathways with FDR < 0.05 are shown'),options = list(pageLength = 10) )
}

```













