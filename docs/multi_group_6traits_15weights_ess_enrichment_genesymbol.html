<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="XSun" />

<meta name="date" content="2024-10-23" />

<title>Enrichment analysis for 6 Traits, 5 tissues, eQTL + sQTL + stQTL – compute ukbb LD, eqtl, sqtl from predictdb; stQTL from Munro et al</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.22/datatables.js"></script>
<link href="site_libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">multigroup_ctwas_analysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sq-96/multigroup_ctwas_analysis">
    <span class="fab fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Enrichment analysis for 6 Traits, 5
tissues, eQTL + sQTL + stQTL – compute ukbb LD, eqtl, sqtl from
predictdb; stQTL from Munro et al</h1>
<h4 class="author">XSun</h4>
<h4 class="date">2024-10-23</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2024-10-31
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 6
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 1
</p>
<p>
<strong>Knit directory:</strong> <code>multigroup_ctwas_analysis/</code>
<span class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.0). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguncommittedchanges">
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> <strong>R Markdown file:</strong> uncommitted
changes </a>
</p>
</div>
<div id="strongRMarkdownfilestronguncommittedchanges"
class="panel-collapse collapse">
<div class="panel-body">
<p>The R Markdown file has unstaged changes. To know which version of
the R Markdown file created these results, you’ll want to first commit
it to the Git repo. If you’re still working on the analysis, you can
ignore this warning. When you’re finished, you can run
<code>wflow_publish</code> to commit the R Markdown file and build the
HTML.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20231112code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20231112)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20231112code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20231112)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomsq96multigroupctwasanalysistree0fa71fe9b2d585ef58fdb40b1fe60a91d7d8f8bdtargetblank0fa71fea">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/tree/0fa71fe9b2d585ef58fdb40b1fe60a91d7d8f8bd" target="_blank">0fa71fe</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomsq96multigroupctwasanalysistree0fa71fe9b2d585ef58fdb40b1fe60a91d7d8f8bdtargetblank0fa71fea"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/tree/0fa71fe9b2d585ef58fdb40b1fe60a91d7d8f8bd" target="_blank">0fa71fe</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory

Unstaged changes:
    Modified:   analysis/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were
made to the R Markdown
(<code>analysis/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd</code>)
and HTML
(<code>docs/multi_group_6traits_15weights_ess_enrichment_genesymbol.html</code>)
files. If you’ve configured a remote Git repository (see
<code>?wflow_git_remote</code>), click on the hyperlinks in the table
below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/0fa71fe9b2d585ef58fdb40b1fe60a91d7d8f8bd/analysis/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd" target="_blank">0fa71fe</a>
</td>
<td>
XSun
</td>
<td>
2024-10-29
</td>
<td>
update
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sq-96/multigroup_ctwas_analysis/0fa71fe9b2d585ef58fdb40b1fe60a91d7d8f8bd/docs/multi_group_6traits_15weights_ess_enrichment_genesymbol.html" target="_blank">0fa71fe</a>
</td>
<td>
XSun
</td>
<td>
2024-10-29
</td>
<td>
update
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/ba30dddddae8600c16db1444c17bbf09b5627d38/analysis/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd" target="_blank">ba30ddd</a>
</td>
<td>
XSun
</td>
<td>
2024-10-24
</td>
<td>
update
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sq-96/multigroup_ctwas_analysis/ba30dddddae8600c16db1444c17bbf09b5627d38/docs/multi_group_6traits_15weights_ess_enrichment_genesymbol.html" target="_blank">ba30ddd</a>
</td>
<td>
XSun
</td>
<td>
2024-10-24
</td>
<td>
update
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/244688776de36e4d801484a4ddb259dcdc03287f/analysis/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd" target="_blank">2446887</a>
</td>
<td>
XSun
</td>
<td>
2024-10-23
</td>
<td>
update
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sq-96/multigroup_ctwas_analysis/244688776de36e4d801484a4ddb259dcdc03287f/docs/multi_group_6traits_15weights_ess_enrichment_genesymbol.html" target="_blank">2446887</a>
</td>
<td>
XSun
</td>
<td>
2024-10-23
</td>
<td>
update
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<pre class="r"><code> library(tidyr)
 library(dplyr)
 library(VennDiagram)
 library(ggplot2)

traits &lt;- c(&quot;LDL-ukb-d-30780_irnt&quot;,&quot;SBP-ukb-a-360&quot;,&quot;WBC-ieu-b-30&quot;,&quot;aFib-ebi-a-GCST006414&quot;,&quot;SCZ-ieu-b-5102&quot;,&quot;IBD-ebi-a-GCST004131&quot;)
dbs &lt;- c(&quot;GO_Biological_Process_2023&quot;,&quot;GO_Cellular_Component_2023&quot;,&quot;GO_Molecular_Function_2023&quot;)

# trait&lt;- &quot;LDL-ukb-d-30780_irnt&quot;
# db &lt;- &quot;GO_Biological_Process_2023&quot;

pval_threshold &lt;- 0.001</code></pre>
<div id="methods" class="section level1">
<h1>Methods</h1>
<p>We do enrichment analysis for the genes with PIP &gt; 0.8 here: <a
href="https://sq-96.github.io/multigroup_ctwas_analysis/multi_group_6traits_15weights_ess.html"
class="uri">https://sq-96.github.io/multigroup_ctwas_analysis/multi_group_6traits_15weights_ess.html</a></p>
<p>The gene set membership was downloaded here: <a
href="https://maayanlab.cloud/Enrichr/#libraries"
class="uri">https://maayanlab.cloud/Enrichr/#libraries</a></p>
<div id="background-genes" class="section level2">
<h2>Background genes</h2>
<p>For Fractional model and Fisher exact test, we selected 2 kind of
backgroud genes</p>
<ul>
<li>All genes used in ctwas</li>
<li>All genes in the selected geneset database.</li>
</ul>
<p>For enrichR, the background genes are not modifiable. The background
genes are all genes in the selected geneset database</p>
</div>
<div id="using-enrichr-package." class="section level2">
<h2>Using EnrichR package.</h2>
<p>This package was used in our earlier ctwas paper.</p>
<ul>
<li>It takes a list of genes(genes with PIP &gt; 0.8) as input and
returns the enriched GO terms with adjusted p-values.</li>
</ul>
</div>
<div id="fractional-model" class="section level2">
<h2>Fractional model</h2>
<div id="model" class="section level3">
<h3>Model</h3>
<p>The model is:
<code>glm(PIP ~ gene set membership, family = quasibinomial('log10it'))</code>.
We do this regression for one gene set at a time.</p>
<p>The PIP vector contains:</p>
<ul>
<li>all genes within the credible set: we use their actual PIPs</li>
<li>genes without the credible set &amp; PIP &lt; 0.1: we set the PIPs
as <code>0.5*min(gene pip within credible set)</code></li>
</ul>
<p>The 2 different baselines:</p>
<ol style="list-style-type: decimal">
<li>All genes from ctwas. Here,
<code>genes without the credible set &amp; PIP &lt; 0.1</code> includes
only the genes used in ctwas.</li>
<li>All genes from the geneset database. Here,
<code>genes without the credible set &amp; PIP &lt; 0.1</code> includes
the union of all genes from the GO terms in the geneset database.</li>
</ol>
</div>
<div id="p-value-calibration" class="section level3">
<h3>p-value calibration</h3>
<p>We used <strong>permutation testing</strong> to assess the
significance of associations between <code>combined_pip</code> and GO
terms. Permutation testing creates a “null” distribution by shuffling
data and recalculating p-values.</p>
<ol style="list-style-type: decimal">
<li><p><strong>Initial log10istic Regression</strong>: For each GO term,
a log10istic regression is performed using
<code>glm(PIP ~ gene set membership, family = quasibinomial('log10it'))</code>.
The observed p-value (<code>pval_origin</code>) measures the association
strength in the actual data.</p></li>
<li><p><strong>Null Distributions via Permutation</strong>:</p>
<ul>
<li>Then we simulate random associations by shuffling the GO term
membership (<code>x</code>) multiple times and recalculating the
log10istic regression p-value for each shuffle.</li>
<li>These shuffled p-values represent what would be expected if there
were no real association and create a “null” distribution.</li>
</ul></li>
<li><p><strong>Calibrated p-values with Increasing
Permutations</strong>:</p>
<ul>
<li>The initial permutation test uses 1,000 shuffles
(<code>n_permutations = 1000</code>) to compute a calibrated p-value
(<code>pval_calibrated</code>), comparing the observed p-value against
the null distribution.</li>
<li><strong>Further Calibration</strong>: If the calibrated p-value is
significant ( <code>pval_calibrated &lt; 0.05</code>), additional rounds
of permutations (100,000 shuffles) are conducted to improve accuracy for
small p-values. Each round refines the calibrated p-value by expanding
the null distribution, enhancing the robustness of significance
estimates.</li>
</ul></li>
<li><p><strong>Final Significance</strong>: The final p-value reflects
the proportion of permutation-derived p-values that are more extreme
than the observed one. If only a small number of permutation p-values
are smaller, the association is considered statistically
significant.</p></li>
</ol>
<!-- This multi-stage permutation testing approach minimizes false positives in high-dimensional data, offering a robust significance estimate for associations with initially strong p-values. -->
</div>
</div>
<div id="fisher-exact-test" class="section level2">
<h2>Fisher exact test</h2>
<p>We assign 1 to the genes with PIP &gt; 0.5/0.8 &amp; in cs and 0 for
others. We name this vector as binarized_PIP. We test the association
between the binarized_PIP and geneset_membership.</p>
<p>The testing matrix is:</p>
<table>
<thead>
<tr class="header">
<th>geneset_membership</th>
<th>0</th>
<th>1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>binarized_pip 0</strong></td>
<td>a</td>
<td>b</td>
</tr>
<tr class="even">
<td><strong>binarized_pip 1</strong></td>
<td>c</td>
<td>d</td>
</tr>
</tbody>
</table>
<p>Where:</p>
<ul>
<li><code>a</code> is the count where <code>binarized_pip = 0</code> and
<code>geneset_membership = 0</code>.</li>
<li><code>b</code> is the count where <code>binarized_pip = 0</code> and
<code>geneset_membership = 1</code>.</li>
<li><code>c</code> is the count where <code>binarized_pip = 1</code> and
<code>geneset_membership = 0</code>.</li>
<li><code>d</code> is the count where <code>binarized_pip = 1</code> and
<code>geneset_membership = 1</code>.</li>
</ul>
<p>The 2 different baselines:</p>
<ol style="list-style-type: decimal">
<li>All genes from ctwas. Here, <code>geneset_membership</code> matrix
includes only the genes used in ctwas.</li>
<li>All genes from the geneset database. Here,
<code>geneset_membership</code> matrix includes the union of all genes
from the GO terms in the geneset database.</li>
</ol>
</div>
</div>
<div
id="comparing-the-p-values-from-enrichr-and-fisher-exact-test-baseline-genes-are-all-genes-from-gene-sets"
class="section level1">
<h1>Comparing the p-values from Enrichr and Fisher exact test – baseline
genes are all genes from gene sets</h1>
<pre class="r"><code> p_enrichr &lt;- c()
 p_fet &lt;- c()

 #compare_diff &lt;- c()
 for (trait in traits) {
   for (db in dbs) {

     file_enrichr &lt;- paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_redundant_&quot;,trait,&quot;_&quot;,db,&quot;.rdata&quot;)
     if(file.exists(file_enrichr)) {
       load(file_enrichr)
       load(paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_blgeneset_pip08_&quot;,trait,&quot;_&quot;,db,&quot;.rdata&quot;))

       merged &lt;- merge(db_enrichment, summary, by.x = &quot;Term&quot;, by.y = &quot;GO&quot;)
       p_enrichr &lt;- c(p_enrichr, merged$P.value)
       p_fet &lt;- c(p_fet, merged$pvalue)

       #compare_diff &lt;- rbind(compare_diff, merged)
     }

   }
 }


 p_enrichr &lt;- as.numeric(p_enrichr)
 p_fet &lt;- as.numeric(p_fet)

 lgp_enrichr &lt;- log10(p_enrichr)
 lgp_fet &lt;- log10(p_fet)
 
 df &lt;- data.frame(lgp_enrichr = lgp_enrichr, lgp_fet = lgp_fet)

 # Fit a linear model to calculate the slope
 # fit &lt;- lm(lgp_fet ~ lgp_enrichr)
 # slope &lt;- coef(fit)[2]
 # intercept &lt;- coef(fit)[1]

 ggplot(df, aes(x = lgp_enrichr, y = lgp_fet)) +
   geom_point() +  # Add points
   geom_abline(intercept = 0, slope = 1, color = &quot;red&quot;, linetype = &quot;dashed&quot;) +  # y = x line
   #geom_smooth(method = &quot;lm&quot;, se = FALSE, color = &quot;blue&quot;) +  # Best-fit line
   # annotate(&quot;text&quot;, x = max(lgp_enrichr) * 0.8, y = max(lgp_fet) * 0.9, 
   #          label = paste0(&quot;Slope: &quot;, round(slope, 3)),
   #          color = &quot;blue&quot;) +  # Slope text
   annotate(&quot;text&quot;, x = max(lgp_enrichr) * 0.8, y = max(lgp_enrichr) * 0.8, 
            label = &quot;y = x&quot;, color = &quot;red&quot;, size = 5,hjust = 1, vjust = -0.5) +  # y = x text near the line
   ggtitle(&quot;Comparison of p-values between enrichr and FET, baseline -- all genes from gene sets&quot;) +  # Add title
   xlab(&quot;Enrichr log10(p)&quot;) +  # x-axis label
   ylab(&quot;FET log10(p)&quot;) +  # y-axis label
   theme_minimal()</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd/unnamed-chunk-2-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-2-1">
Past versions of unnamed-chunk-2-1.png
</button>
</p>
<div id="fig-unnamed-chunk-2-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/0fa71fe9b2d585ef58fdb40b1fe60a91d7d8f8bd/docs/figure/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd/unnamed-chunk-2-1.png" target="_blank">0fa71fe</a>
</td>
<td>
XSun
</td>
<td>
2024-10-29
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/ba30dddddae8600c16db1444c17bbf09b5627d38/docs/figure/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd/unnamed-chunk-2-1.png" target="_blank">ba30ddd</a>
</td>
<td>
XSun
</td>
<td>
2024-10-24
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="summary-for-the-number-of-go-terms-with-p-values-0.001"
class="section level1">
<h1>Summary for the number of Go terms with p-values &lt; 0.001</h1>
<pre class="r"><code> load(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_summary_for_all_redundant_p.rdata&quot;)

summary_show &lt;- summary[grep(pattern = &quot;ctwasgene&quot;,summary$method),] 

DT::datatable(summary_show,caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Number of enriched GO terms under different settings&#39;),options = list(pageLength = 20) )</code></pre>
<div id="htmlwidget-4de263013227ca78a293" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-4de263013227ca78a293">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Number of enriched GO terms under different settings<\/caption>","data":[["1","2","3","4","5","6","7","8","9"],["fractional_baseline-ctwasgenes","fractional_baseline-ctwasgenes","fractional_baseline-ctwasgenes","fractional_calibrated_baseline-ctwasgenes","fractional_calibrated_baseline-ctwasgenes","fractional_calibrated_baseline-ctwasgenes","fisher_baseline-ctwasgenes","fisher_baseline-ctwasgenes","fisher_baseline-ctwasgenes"],["GO_Biological_Process_2023","GO_Cellular_Component_2023","GO_Molecular_Function_2023","GO_Biological_Process_2023","GO_Cellular_Component_2023","GO_Molecular_Function_2023","GO_Biological_Process_2023","GO_Cellular_Component_2023","GO_Molecular_Function_2023"],["63","8","12","33","6","6","6","2","1"],["58","20","8","30","14","5","10","6","1"],["43","3","4","14","1","2","5","0","0"],["16","1","5","7","0","0","3","0","0"],["36","2","1","12","3","0","0","0","0"],["40","8","3","Running","2","0","8","2","1"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>method<\/th>\n      <th>db<\/th>\n      <th>aFib-ebi-a-GCST006414<\/th>\n      <th>LDL-ukb-d-30780_irnt<\/th>\n      <th>IBD-ebi-a-GCST004131<\/th>\n      <th>SBP-ukb-a-360<\/th>\n      <th>SCZ-ieu-b-5102<\/th>\n      <th>WBC-ieu-b-30<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":20,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p><!-- # Summary of non-redundant GO terms (by Enrichr) related to trait (summaried by chatgpt) --></p>
<p><!-- ```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5} -->
<!-- load("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrich_nonredundant_annotated_2023_enrichr.rdata") -->
<!-- sum_all$relatedornot_bychatgpt[sum$relatedornot_bychatgpt != T] <- F -->
<!-- sprintf("total GO terms at FDR < 0.05 = %s ",nrow(sum_all)) -->
<!-- sprintf("number of trait-related GO terms(by chatgpt) = %s ",sum(sum_all$relatedornot_bychatgpt)) --></p>
<p><!-- DT::datatable(sum_all[sum_all$relatedornot_bychatgpt == T,],caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Summary of non-redundant GO terms (by Enrichr) related to trait (summaried by chatgpt)'),options = list(pageLength = 10) ) --></p>
<p><!-- sum_enrichr_nonredundant <- sum_all --> <!-- ``` --></p>
<p><!-- # Summary of GO terms (by fractional model) related to trait (summaried by chatgpt) --></p>
<p><!-- ```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5} -->
<!-- load("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrich_fractional_annotated_2023.rdata") -->
<!-- sum_all$relatedornot_bychatgpt[sum$relatedornot_bychatgpt != T] <- F -->
<!-- sprintf("total GO terms at FDR < 0.05 = %s ",nrow(sum_all)) -->
<!-- sprintf("number of trait-related GO terms(by chatgpt) = %s ",sum(sum_all$relatedornot_bychatgpt)) --></p>
<p><!-- DT::datatable(sum_all[sum_all$relatedornot_bychatgpt == T,],caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Summary of GO terms (by fractional model) related to trait (summaried by chatgpt)'),options = list(pageLength = 10) ) --></p>
<p><!-- sum_fractional <- sum_all --></p>
<p><!-- sum_fractional <- sum_fractional %>% -->
<!--   separate(GO, into = c("GO_term"), sep = " \\((GO:[0-9]+)\\)", remove = T) --></p>
<p><!-- ``` --></p>
</div>
<div
id="comparing-the-go-terms-reported-by-fet-and-fractional-model-pvalues-calibrated-p-values-0.001-baseline-genes-are-genes-used-in-ctwas-redundant-terms-not-removed"
class="section level1">
<h1>Comparing the GO terms reported by FET and Fractional model (pvalues
calibrated) – p-values &lt; 0.001, baseline genes are genes used in
ctwas, redundant terms NOT removed</h1>
<div id="afib-ebi-a-gcst006414" class="section level2">
<h2>aFib-ebi-a-GCST006414</h2>
<div id="comparing-calibrated-fractional-model-and-fet"
class="section level3">
<h3>Comparing Calibrated fractional model and FET</h3>
<pre class="r"><code>all_fractional &lt;- c()
all_fet &lt;- c()

trait &lt;- &quot;aFib-ebi-a-GCST006414&quot; 
 
for (db in dbs) {

    file_fet &lt;- paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_blctwas_pip08_&quot;,trait,&quot;_&quot;,db,&quot;.rdata&quot;)
    load(file_fet)
    all_fet &lt;- rbind(all_fet,summary)

    file_fractional &lt;- paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fractional_calibrated_&quot;,trait,&quot;_&quot;,db,&quot;.rdata&quot;)
    load(file_fractional)
    summary$trait &lt;- trait
    summary$db &lt;- db
    all_fractional &lt;- rbind(all_fractional,summary)

}

all_fractional$id &lt;- paste0(all_fractional$trait,&quot;-&quot;,all_fractional$db,&quot;-&quot;,all_fractional$GO)
all_fet$id &lt;- paste0(all_fet$trait,&quot;-&quot;,all_fet$db,&quot;-&quot;,all_fet$GO)

fractional_pass &lt;- all_fractional[as.numeric(all_fractional$pvalue_calibrated) &lt; pval_threshold, ]
fractional_pass &lt;-  fractional_pass[complete.cases( fractional_pass$fdr_origin),]
fet_pass &lt;- all_fet[as.numeric(all_fet$pvalue) &lt; pval_threshold, ]

venn.plot &lt;- draw.pairwise.venn(
     area1 = nrow(fractional_pass),          # Size of Group A
     area2 = nrow(fet_pass),          # Size of Group B
     cross.area = sum(fractional_pass$id %in%  fet_pass$id),     # Overlap between Group A and Group B
     category = c(&quot;Fractional&quot;, &quot;FET&quot;),  # Labels for the groups
     fill = c(&quot;red&quot;, &quot;blue&quot;),             # Colors for the groups
     lty = &quot;blank&quot;,                       # Line type for the circles
     cex = 2,                             # Font size for the numbers
     cat.cex = 2                          # Font size for the labels
   )</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd/unnamed-chunk-4-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-4-1">
Past versions of unnamed-chunk-4-1.png
</button>
</p>
<div id="fig-unnamed-chunk-4-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/0fa71fe9b2d585ef58fdb40b1fe60a91d7d8f8bd/docs/figure/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd/unnamed-chunk-4-1.png" target="_blank">0fa71fe</a>
</td>
<td>
XSun
</td>
<td>
2024-10-29
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/244688776de36e4d801484a4ddb259dcdc03287f/docs/figure/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd/unnamed-chunk-4-1.png" target="_blank">2446887</a>
</td>
<td>
XSun
</td>
<td>
2024-10-23
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>all_fractional &lt;- all_fractional[,c(&quot;trait&quot;,&quot;db&quot;,&quot;GO&quot;,&quot;pvalue_origin&quot;,&quot;fdr_origin&quot;,&quot;pvalue_calibrated&quot;,&quot;fdr_calibrated&quot;,&quot;id&quot;)]

merged_two &lt;- merge(all_fractional,all_fet, by = &quot;id&quot;)
merged_two &lt;- merged_two[,c(&quot;trait.x&quot;,&quot;db.x&quot;,&quot;GO.x&quot;,&quot;pvalue_origin&quot;,&quot;fdr_origin&quot;,&quot;pvalue_calibrated&quot;,&quot;fdr_calibrated&quot;,&quot;pvalue&quot;,&quot;fdr&quot;,&quot;Overlap&quot;,&quot;Genes&quot;)]
colnames(merged_two) &lt;- c(&quot;trait&quot;,&quot;db&quot;,&quot;GO&quot;,&quot;pvalue_origin_fractional&quot;,&quot;fdr_origin_fractional&quot;,&quot;pvalue_calibrated_fractional&quot;,&quot;fdr_calibrated_fractional&quot;,&quot;pvalue_fet&quot;,&quot;fdr_fet&quot;,&quot;Overlap_fet&quot;,&quot;Overlapped_Genes_fet&quot;)
unique_fractional &lt;- merged_two[as.numeric(merged_two$pvalue_calibrated_fractional) &lt; pval_threshold &amp; as.numeric(merged_two$pvalue_fet) &gt; pval_threshold,]
unique_fractional &lt;- unique_fractional[complete.cases(unique_fractional),]
unique_fractional &lt;- unique_fractional[order(as.numeric(unique_fractional$pvalue_calibrated_fractional)),]
DT::datatable(unique_fractional,caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Unique GO terms for fractional model&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-20575149739a71fc930f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-20575149739a71fc930f">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Unique GO terms for fractional model<\/caption>","data":[["444","5505","1723","4107","4926","322","4253","2117","5471","1110","51","3824","5953","6040","2897","4075","1694","2641","5985","19","2115","5522","2679","1676","1117","1155","4460","6626","1796","627","4794","186","5569","5941","328","326","1983"],["aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414","aFib-ebi-a-GCST006414"],["GO_Biological_Process_2023","GO_Cellular_Component_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Cellular_Component_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Molecular_Function_2023","GO_Molecular_Function_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Molecular_Function_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Cellular_Component_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Molecular_Function_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Cellular_Component_2023","GO_Molecular_Function_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023"],["Cellular Response To Growth Hormone Stimulus (GO:0071378)","Cortical Endoplasmic Reticulum (GO:0032541)","Negative Regulation By Host Of Viral Process (GO:0044793)","Regulation Of Heart Rate By Cardiac Conduction (GO:0086091)","Sarcomere Organization (GO:0045214)","Cardiac Conduction (GO:0061337)","Regulation Of Membrane Depolarization (GO:0003254)","Negative Regulation Of Potassium Ion Transport (GO:0043267)","Cell-Cell Contact Zone (GO:0044291)","Growth Hormone Receptor Signaling Pathway (GO:0060396)","Actomyosin Structure Organization (GO:0031032)","Regulation Of Cardiac Muscle Cell Contraction (GO:0086004)","Adenylate Cyclase Binding (GO:0008179)","Calcium Channel Regulator Activity (GO:0005246)","Positive Regulation Of Gap Junction Assembly (GO:1903598)","Regulation Of Gap Junction Assembly (GO:1903596)","Myofibril Assembly (GO:0030239)","Positive Regulation Of Actin Filament Depolymerization (GO:0030836)","Ankyrin Binding (GO:0030506)","AV Node Cell Action Potential (GO:0086016)","Negative Regulation Of Potassium Ion Transmembrane Transport (GO:1901380)","Cytoskeleton (GO:0005856)","Positive Regulation Of Axonogenesis (GO:0050772)","Muscle Tissue Development (GO:0060537)","Heart Morphogenesis (GO:0003007)","His-Purkinje System Development (GO:0003164)","Regulation Of Protein Kinase A Signaling (GO:0010738)","Phosphatidylinositol Phosphate Binding (GO:1901981)","Negative Regulation Of Cation Transmembrane Transport (GO:1904063)","Cytochrome Complex Assembly (GO:0017004)","Response To Calcium Ion (GO:0051592)","Atrial Cardiac Muscle Tissue Development (GO:0003228)","Focal Adhesion (GO:0005925)","Actin Binding (GO:0003779)","Cardiac Muscle Cell Contraction (GO:0086003)","Cardiac Muscle Cell Action Potential (GO:0086001)","Negative Regulation Of Ion Transmembrane Transporter Activity (GO:0032413)"],[0.000182670001885736,0.0331184927562333,0.00220264117199914,1.81568159569941e-07,7.50194704355212e-07,1.62232988600463e-06,3.83911608432632e-06,6.79988689167083e-05,8.70810898362326e-06,0.000106235630516563,2.4154670573268e-05,2.0102761526821e-05,0.000222552848964141,4.73881675782907e-05,0.000175486204562633,0.000175486204562633,2.70411306497379e-05,0.00240638501406792,4.02914080189831e-05,0.00246142961040979,0.000100756966379525,0.000236707990966735,7.51080409903519e-05,6.84436739191315e-05,6.33141574940518e-05,0.000187948132620392,0.000197817491956719,0.000119138565783176,0.000177297769337764,0.0305626629896712,0.000119102302480993,0.000188877481951814,0.000249792966907135,0.000303496871711979,0.000120040795810712,0.0001008434037121,0.000112945251238645],[0.0305288969994783,0.476906295689759,0.142280771838484,0.000880424005754644,0.00181884706070921,0.00262222587241216,0.00433263998582817,0.0221255583222579,0.00188095154046262,0.0253077312559193,0.0131122442520579,0.0131122442520579,0.0326549508057134,0.0158118519152897,0.0305288969994783,0.0305288969994783,0.0131122442520579,0.149668942171085,0.0158118519152897,0.151081926340216,0.0253077312559193,0.0215821123407765,0.0227624306726385,0.0221255583222579,0.0221255583222579,0.0305288969994783,0.0309424844676816,0.0298144260872398,0.0305288969994783,0.535088430917739,0.0253077312559193,0.0305288969994783,0.0215821123407765,0.0326549508057134,0.0253077312559193,0.0253077312559193,0.0253077312559193],[9.99990000099999e-06,9.99990000099999e-06,1.9999800002e-05,1.9999800002e-05,3.9999600004e-05,9.99990000099999e-05,0.000139998600014,0.000159998400016,0.000179998200018,0.000209997900021,0.000239997600024,0.000269997300027,0.000279997200028,0.000279997200028,0.000329996700033,0.000329996700033,0.000339996600034,0.000409995900041,0.000419995800042,0.000449995500045,0.000459995400046,0.000519994800051999,0.000529994700053,0.000649993500064999,0.000719992800071999,0.000719992800071999,0.000779992200077999,0.000809991900080999,0.000819991800081999,0.000839991600083999,0.000859991400085999,0.000879991200087999,0.000879991200087999,0.000889991100088999,0.000909990900090999,0.000939990600093999,0.000939990600093999],[0.0323263434032326,0.004319956800432,0.0323263434032326,0.0323263434032326,0.0387916120838792,0.0692707358640699,0.0848566514334857,0.0862035824086204,0.025919740802592,0.101827981720183,0.105795305683307,0.106215128324907,0.140138598614014,0.140138598614014,0.106215128324907,0.106215128324907,0.106215128324907,0.106215128324907,0.140138598614014,0.106215128324907,0.106215128324907,0.0552954470455295,0.116815650025318,0.137035586165877,0.138121649086539,0.138121649086539,0.138121649086539,0.142140578594214,0.138121649086539,0.138121649086539,0.138121649086539,0.138121649086539,0.0623308052633759,0.142140578594214,0.138121649086539,0.138121649086539,0.138121649086539],["0.0698461110377724","1","0.0471147191908438","0.00815497886460549","0.00185751358982611","0.0143831947312179","0.001374182463934","0.00325310744001483","0.00181872078158343","0.0920437789036916","0.00815497886460549","0.00243479466558597","0.00165643504162542","0.114070011872605","0.00325310744001483","0.00325310744001483","0.00691208054175707","0.0471147191908438","0.00790828867124936","0.0471147191908438","0.00533867962302764","0.00129068473444584","0.007885391418155","0.001374182463934","0.00691208054175707","0.00325310744001483","0.00325310744001483","0.0126442886551093","0.007885391418155","1","0.0162637844026335","0.00325310744001483","0.0062958294278143","0.0140459132359135","0.0108707853606511","0.0480981622429966","0.0142731830573869"],["1","1","1","0.760240874498653","0.586318397605339","1","0.586318397605339","0.586318397605339","0.215518412617637","1","0.760240874498653","0.586318397605339","0.949965496372178","1","0.586318397605339","0.586318397605339","0.760240874498653","1","1","1","0.64147201603801","0.203928188042442","0.760240874498653","0.586318397605339","0.760240874498653","0.586318397605339","0.586318397605339","1","0.760240874498653","1","1","0.586318397605339","0.383924108969739","1","0.960481380305488","1","1"],["1/3","0/1","1/2","3/18","3/11","3/22","3/10","2/4","3/10","1/4","3/18","3/12","2/3","1/5","2/4","2/4","3/17","1/2","2/6","1/2","2/5","9/105","2/6","3/10","3/17","2/4","2/4","3/21","2/6","0/1","3/23","2/4","7/86","4/40","2/7","2/15","2/8"],["PXN","","PITX3","CAV1;CAMK2D;PKP2","MYOZ1;SYNPO2L;FLNC","CAV1;CAMK2D;PKP2","TBX5;SCN10A;CAMK2D","CAV1;CASQ2","AKAP6;JAM2;PKP2","PXN","MYOZ1;SYNPO2L;FLNC","CAV1;CAMK2D;PKP2","AKAP6;AKAP12","SGK1","CAV1;TBX5","CAV1;TBX5","MYOZ1;SYNPO2L;FLNC","CFL2","FLNC;PLEC","SCN10A","CAV1;CASQ2","MYOZ1;SYNPO2L;MAPT;WIPF1;PHLDB2;CFL2;PLEC;MTSS1;DTNA","MAPT;RUFY3","MYOZ1;CAV1;POPDC3","SYNPO2L;NKX2-5;RBM20","TBX5;NKX2-5","AKAP6;AKAP12","HIP1R;MAPT;GBF1","CAV1;CAMK2D","","CAV1;CAMK2D;CASQ2","TBX5;NKX2-5","CAV1;PXN;AKAP12;GNA12;PHLDB2;FLNC;PLEC","MYOZ1;SYNPO2L;MAPT;MTSS1","CAMK2D;PKP2","SCN10A;PKP2","CAMK2D;CASQ2"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>trait<\/th>\n      <th>db<\/th>\n      <th>GO<\/th>\n      <th>pvalue_origin_fractional<\/th>\n      <th>fdr_origin_fractional<\/th>\n      <th>pvalue_calibrated_fractional<\/th>\n      <th>fdr_calibrated_fractional<\/th>\n      <th>pvalue_fet<\/th>\n      <th>fdr_fet<\/th>\n      <th>Overlap_fet<\/th>\n      <th>Overlapped_Genes_fet<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>unique_fet&lt;- merged_two[as.numeric(merged_two$pvalue_calibrated_fractional) &gt; pval_threshold &amp; as.numeric(merged_two$pvalue_fet) &lt; pval_threshold,]
unique_fet &lt;- unique_fet[complete.cases(unique_fet),]
DT::datatable(unique_fet,caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Unique GO terms for FET&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-a23c348805048a1f64c7" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a23c348805048a1f64c7">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Unique GO terms for FET<\/caption>","data":[["385"],["aFib-ebi-a-GCST006414"],["GO_Biological_Process_2023"],["Cell-Cell Signaling Involved In Cardiac Conduction (GO:0086019)"],[0.00492366187132182],[0.241159963778177],[0.004419955800442],[0.274773918927477],["1.29107893472947e-05"],["0.0698086380008227"],["3/3"],["TBX5;CASQ2;PKP2"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>trait<\/th>\n      <th>db<\/th>\n      <th>GO<\/th>\n      <th>pvalue_origin_fractional<\/th>\n      <th>fdr_origin_fractional<\/th>\n      <th>pvalue_calibrated_fractional<\/th>\n      <th>fdr_calibrated_fractional<\/th>\n      <th>pvalue_fet<\/th>\n      <th>fdr_fet<\/th>\n      <th>Overlap_fet<\/th>\n      <th>Overlapped_Genes_fet<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>p_fractional_calibrated &lt;- as.numeric(unique_fractional$pvalue_calibrated_fractional)
p_fet &lt;- as.numeric(unique_fractional$pvalue_fet)

lgp_fractional_calibrated &lt;- log10(p_fractional_calibrated)
lgp_fet &lt;- log10(p_fet)
 
df &lt;- data.frame(lgp_fractional_calibrated = lgp_fractional_calibrated, lgp_fet = lgp_fet)

 ggplot(df, aes(x = lgp_fractional_calibrated, y = lgp_fet)) +
   geom_point() +  # Add points
   geom_abline(intercept = 0, slope = 1, color = &quot;red&quot;, linetype = &quot;dashed&quot;) +  # y = x line
   #geom_smooth(method = &quot;lm&quot;, se = FALSE, color = &quot;blue&quot;) +  # Best-fit line
   # annotate(&quot;text&quot;, x = max(lgp_fractional_calibrated) * 0.8, y = max(lgp_fet) * 0.9, 
   #          label = paste0(&quot;Slope: &quot;, round(slope, 3)),
   #          color = &quot;blue&quot;) +  # Slope text
   annotate(&quot;text&quot;, x = max(lgp_fractional_calibrated) * 0.8, y = max(lgp_fractional_calibrated) * 0.8, 
            label = &quot;y = x&quot;, color = &quot;red&quot;, size = 5, hjust = 1, vjust = -0.5) +  # y = x text near the line
   ggtitle(&quot;Comparison of p-values between \n fractional_calibrated and FET \n for unique fractional GO terms&quot;) +  # Add title
   xlab(&quot;fractional_calibrated log10(p)&quot;) +  # x-axis label
   ylab(&quot;FET log10(p)&quot;) +  # y-axis label
   theme_minimal()</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd/unnamed-chunk-4-4.png" width="480" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-4-4">
Past versions of unnamed-chunk-4-4.png
</button>
</p>
<div id="fig-unnamed-chunk-4-4" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/0fa71fe9b2d585ef58fdb40b1fe60a91d7d8f8bd/docs/figure/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd/unnamed-chunk-4-4.png" target="_blank">0fa71fe</a>
</td>
<td>
XSun
</td>
<td>
2024-10-29
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div
id="examining-ctwas-pip-values-for-genes-within-go-terms-associated-with-high-fet-p-values."
class="section level3">
<h3>Examining ctwas PIP values for genes within GO terms associated with
high FET p-values.</h3>
<div
id="go_cellular_component_2023---cortical-endoplasmic-reticulum-go0032541"
class="section level4">
<h4>GO_Cellular_Component_2023 - Cortical Endoplasmic Reticulum (<a
href="GO:0032541" class="uri">GO:0032541</a>)</h4>
<pre class="r"><code>db &lt;- &quot;GO_Cellular_Component_2023&quot;
go &lt;- &quot;Cortical Endoplasmic Reticulum (GO:0032541)&quot;

load(paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/&quot;, trait, &quot;_combinedpip.rdata&quot;))
load(paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/&quot;, trait, &quot;_finemap_annot.rdata&quot;))

genes_notincs &lt;- subset(finemap_gene_res, !gene_name %in% combined_pip_by_type$gene_name)[, &quot;gene_name&quot;]
genes_notincs &lt;- data.frame(gene_name = unique(genes_notincs), combined_pip = 0.5 * min(combined_pip_by_type$combined_pip))
genes_all &lt;- rbind(combined_pip_by_type[, c(&quot;gene_name&quot;, &quot;combined_pip&quot;)], genes_notincs)

load(paste0(&quot;/project/xinhe/xsun/data/Go/membership_&quot;, db, &quot;.rdata&quot;))
membership_ordered &lt;- membership[match(genes_all$gene_name, rownames(membership)), ]

x &lt;- membership_ordered[,colnames(membership_ordered) == go]
gene_ingo &lt;- names(which(x == 1))

print(&quot;ctwas PIP for the genes in GO term&quot;)</code></pre>
<pre><code>[1] &quot;ctwas PIP for the genes in GO term&quot;</code></pre>
<pre class="r"><code>combined_pip_by_type[combined_pip_by_type$gene_name %in% gene_ingo,]</code></pre>
<pre><code>   gene_name combined_pip  eQTL_pip sQTL_pip stQTL_pip
74     STIM1    0.7376334 0.7376334       NA        NA</code></pre>
</div>
<div
id="go_biological_process_2023---cytochrome-complex-assembly-go0017004"
class="section level4">
<h4>GO_Biological_Process_2023 - Cytochrome Complex Assembly (<a
href="GO:0017004" class="uri">GO:0017004</a>)</h4>
<pre class="r"><code>db &lt;- &quot;GO_Biological_Process_2023&quot;
go &lt;- &quot;Cytochrome Complex Assembly (GO:0017004)&quot;

load(paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/&quot;, trait, &quot;_combinedpip.rdata&quot;))
load(paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/&quot;, trait, &quot;_finemap_annot.rdata&quot;))

genes_notincs &lt;- subset(finemap_gene_res, !gene_name %in% combined_pip_by_type$gene_name)[, &quot;gene_name&quot;]
genes_notincs &lt;- data.frame(gene_name = unique(genes_notincs), combined_pip = 0.5 * min(combined_pip_by_type$combined_pip))
genes_all &lt;- rbind(combined_pip_by_type[, c(&quot;gene_name&quot;, &quot;combined_pip&quot;)], genes_notincs)

load(paste0(&quot;/project/xinhe/xsun/data/Go/membership_&quot;, db, &quot;.rdata&quot;))
membership_ordered &lt;- membership[match(genes_all$gene_name, rownames(membership)), ]

x &lt;- membership_ordered[,colnames(membership_ordered) == go]
gene_ingo &lt;- names(which(x == 1))

print(&quot;ctwas PIP for the genes in GO term&quot;)</code></pre>
<pre><code>[1] &quot;ctwas PIP for the genes in GO term&quot;</code></pre>
<pre class="r"><code>combined_pip_by_type[combined_pip_by_type$gene_name %in% gene_ingo,]</code></pre>
<pre><code>   gene_name combined_pip eQTL_pip  sQTL_pip stQTL_pip
77     COX18    0.7264782       NA 0.7264782        NA</code></pre>
</div>
<div
id="go_molecular_function_2023---calcium-channel-regulator-activity-go0005246"
class="section level4">
<h4>GO_Molecular_Function_2023 - Calcium Channel Regulator Activity (<a
href="GO:0005246" class="uri">GO:0005246</a>)</h4>
<pre class="r"><code>db &lt;- &quot;GO_Molecular_Function_2023&quot;
go &lt;- &quot;Calcium Channel Regulator Activity (GO:0005246)&quot;

load(paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/&quot;, trait, &quot;_combinedpip.rdata&quot;))
load(paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/&quot;, trait, &quot;_finemap_annot.rdata&quot;))

genes_notincs &lt;- subset(finemap_gene_res, !gene_name %in% combined_pip_by_type$gene_name)[, &quot;gene_name&quot;]
genes_notincs &lt;- data.frame(gene_name = unique(genes_notincs), combined_pip = 0.5 * min(combined_pip_by_type$combined_pip))
genes_all &lt;- rbind(combined_pip_by_type[, c(&quot;gene_name&quot;, &quot;combined_pip&quot;)], genes_notincs)

load(paste0(&quot;/project/xinhe/xsun/data/Go/membership_&quot;, db, &quot;.rdata&quot;))
membership_ordered &lt;- membership[match(genes_all$gene_name, rownames(membership)), ]

x &lt;- membership_ordered[,colnames(membership_ordered) == go]
gene_ingo &lt;- names(which(x == 1))

print(&quot;ctwas PIP for the genes in GO term&quot;)</code></pre>
<pre><code>[1] &quot;ctwas PIP for the genes in GO term&quot;</code></pre>
<pre class="r"><code>combined_pip_by_type[combined_pip_by_type$gene_name %in% gene_ingo,]</code></pre>
<pre><code>    gene_name combined_pip    eQTL_pip  sQTL_pip stQTL_pip
52       SGK1  0.944520556 0.944520556        NA        NA
74      STIM1  0.737633431 0.737633431        NA        NA
79      YWHAE  0.713523514          NA 0.7135235        NA
439     NRXN1  0.001469662 0.001469662        NA        NA</code></pre>
</div>
</div>
</div>
<div id="ldl-ukb-d-30780_irnt" class="section level2">
<h2>LDL-ukb-d-30780_irnt</h2>
<pre class="r"><code>all_fractional &lt;- c()
all_fet &lt;- c()

trait &lt;- &quot;LDL-ukb-d-30780_irnt&quot; 
 
for (db in dbs) {

    file_fet &lt;- paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_blctwas_pip08_&quot;,trait,&quot;_&quot;,db,&quot;.rdata&quot;)
    load(file_fet)
    all_fet &lt;- rbind(all_fet,summary)

    file_fractional &lt;- paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fractional_calibrated_&quot;,trait,&quot;_&quot;,db,&quot;.rdata&quot;)
    load(file_fractional)
    summary$trait &lt;- trait
    summary$db &lt;- db
    all_fractional &lt;- rbind(all_fractional,summary)

}

all_fractional$id &lt;- paste0(all_fractional$trait,&quot;-&quot;,all_fractional$db,&quot;-&quot;,all_fractional$GO)
all_fet$id &lt;- paste0(all_fet$trait,&quot;-&quot;,all_fet$db,&quot;-&quot;,all_fet$GO)

fractional_pass &lt;- all_fractional[as.numeric(all_fractional$pvalue_calibrated) &lt; pval_threshold, ]
fractional_pass &lt;-  fractional_pass[complete.cases( fractional_pass$fdr_origin),]
fet_pass &lt;- all_fet[as.numeric(all_fet$pvalue) &lt; pval_threshold, ]

venn.plot &lt;- draw.pairwise.venn(
     area1 = nrow(fractional_pass),          # Size of Group A
     area2 = nrow(fet_pass),          # Size of Group B
     cross.area = sum(fractional_pass$id %in%  fet_pass$id),     # Overlap between Group A and Group B
     category = c(&quot;Fractional&quot;, &quot;FET&quot;),  # Labels for the groups
     fill = c(&quot;red&quot;, &quot;blue&quot;),             # Colors for the groups
     lty = &quot;blank&quot;,                       # Line type for the circles
     cex = 2,                             # Font size for the numbers
     cat.cex = 2                          # Font size for the labels
   )</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd/unnamed-chunk-8-1.png" width="480" style="display: block; margin: auto;" /></p>
<pre class="r"><code>all_fractional &lt;- all_fractional[,c(&quot;trait&quot;,&quot;db&quot;,&quot;GO&quot;,&quot;pvalue_origin&quot;,&quot;fdr_origin&quot;,&quot;pvalue_calibrated&quot;,&quot;fdr_calibrated&quot;,&quot;id&quot;)]

merged_two &lt;- merge(all_fractional,all_fet, by = &quot;id&quot;)
merged_two &lt;- merged_two[,c(&quot;trait.x&quot;,&quot;db.x&quot;,&quot;GO.x&quot;,&quot;pvalue_origin&quot;,&quot;fdr_origin&quot;,&quot;pvalue_calibrated&quot;,&quot;fdr_calibrated&quot;,&quot;pvalue&quot;,&quot;fdr&quot;,&quot;Overlap&quot;,&quot;Genes&quot;)]
colnames(merged_two) &lt;- c(&quot;trait&quot;,&quot;db&quot;,&quot;GO&quot;,&quot;pvalue_origin_fractional&quot;,&quot;fdr_origin_fractional&quot;,&quot;pvalue_calibrated_fractional&quot;,&quot;fdr_calibrated_fractional&quot;,&quot;pvalue_fet&quot;,&quot;fdr_fet&quot;,&quot;Overlap_fet&quot;,&quot;Overlapped_Genes_fet&quot;)
unique_fractional &lt;- merged_two[as.numeric(merged_two$pvalue_calibrated_fractional) &lt; pval_threshold &amp; as.numeric(merged_two$pvalue_fet) &gt; pval_threshold,]
unique_fractional &lt;- unique_fractional[complete.cases(unique_fractional),]
unique_fractional &lt;- unique_fractional[order(as.numeric(unique_fractional$pvalue_calibrated_fractional)),]
DT::datatable(unique_fractional,caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Unique GO terms for fractional model&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-93928d62269dcef60a51" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-93928d62269dcef60a51">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Unique GO terms for fractional model<\/caption>","data":[["5542","490","6412","5552","5495","4217","5547","2704","2007","3190","5535","6409","6430","2525","5836","813","6732","5255","2556","2557","5537","3401","4513","2148","5632","57","2524","5037","4930","5034","1152","2199","455"],["LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt","LDL-ukb-d-30780_irnt"],["GO_Cellular_Component_2023","GO_Biological_Process_2023","GO_Molecular_Function_2023","GO_Cellular_Component_2023","GO_Cellular_Component_2023","GO_Biological_Process_2023","GO_Cellular_Component_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Cellular_Component_2023","GO_Molecular_Function_2023","GO_Molecular_Function_2023","GO_Biological_Process_2023","GO_Cellular_Component_2023","GO_Biological_Process_2023","GO_Molecular_Function_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Cellular_Component_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Cellular_Component_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023"],["Endocytic Vesicle Membrane (GO:0030666)","Cellular Response To Nutrient Levels (GO:0031669)","Low-Density Lipoprotein Particle Receptor Binding (GO:0050750)","Endosome Membrane (GO:0010008)","Coated Vesicle Membrane (GO:0030662)","Regulation Of Low-Density Lipoprotein Particle Clearance (GO:0010988)","Endoplasmic Reticulum Membrane (GO:0005789)","Positive Regulation Of Calcium Ion Import (GO:0090280)","Negative Regulation Of Lipoprotein Particle Clearance (GO:0010985)","Positive Regulation Of Protein Export From Nucleus (GO:0046827)","ER To Golgi Transport Vesicle Membrane (GO:0012507)","Lipoprotein Particle Receptor Binding (GO:0070325)","MHC Class II Receptor Activity (GO:0032395)","Peptidyl-Threonine Phosphorylation (GO:0018107)","Transport Vesicle Membrane (GO:0030658)","Endocytosis (GO:0006897)","Pyridoxal Phosphate Binding (GO:0030170)","Very-Low-Density Lipoprotein Particle Remodeling (GO:0034372)","Phosphatidic Acid Biosynthetic Process (GO:0006654)","Phosphatidic Acid Metabolic Process (GO:0046473)","Early Endosome (GO:0005769)","Positive Regulation Of Wnt Signaling Pathway (GO:0030177)","Regulation Of Receptor Recycling (GO:0001919)","Negative Regulation Of Protein Processing (GO:0010955)","MHC Protein Complex (GO:0042611)","Acylglycerol Metabolic Process (GO:0006639)","Peptidyl-Threonine Modification (GO:0018210)","Sterol Metabolic Process (GO:0016125)","Secondary Alcohol Biosynthetic Process (GO:1902653)","Sterol Biosynthetic Process (GO:0016126)","High-Density Lipoprotein Particle Remodeling (GO:0034375)","Negative Regulation Of Signaling (GO:0023057)","Cellular Response To Insulin Stimulus (GO:0032869)"],[2.35854939762207e-06,3.47550952243722e-06,5.295996381603e-06,6.24475906347868e-05,6.41193821558445e-06,0.000114487162690711,0.000136970066904095,0.0245501149102765,9.31520215581081e-05,0.000118724868431672,3.28570943142029e-05,2.14787751139708e-05,2.34408881255563e-05,1.86650287649664e-05,3.06146478633007e-05,9.23725718852332e-05,0.000195625962916343,0.000135183908967629,4.04774968549571e-05,4.04774968549571e-05,0.000223280207998593,7.63362148592612e-05,0.000170612258284318,0.00198723942142569,6.61865125615979e-05,9.81166155562659e-05,8.61718809847337e-05,0.000106422505537437,5.7906496796735e-05,5.7906496796735e-05,4.60769844978005e-05,6.59888478506393e-05,0.000130898897571851],[0.000209439186508839,0.00198606060821051,0.00555881098100275,0.00244890096477912,0.000355862570964937,0.0234846922440034,0.00467805459272446,0.399966953984692,0.0228133736606357,0.0234846922440034,0.00145885498755061,0.00622941601936659,0.00622941601936659,0.00872674935802021,0.00145885498755061,0.0228133736606357,0.0346583997633455,0.0239741670282936,0.0160135204865419,0.0160135204865419,0.00660909415675835,0.0218109529456211,0.0265896619501893,0.127754654304904,0.00244890096477912,0.022936988809358,0.0228133736606357,0.0232014761629946,0.0186133195641005,0.0186133195641005,0.0169267093765848,0.0199635673232846,0.0239741670282936],[3.9999600004e-05,0.000119998800012,0.000129998700013,0.000159998400016,0.000189998100019,0.000219997800022,0.000229997700023,0.000239997600024,0.000279997200028,0.000309996900031,0.000349996500035,0.000349996500035,0.00039999600004,0.000419995800042,0.000429995700043,0.000509994900050999,0.000549994500054999,0.000599994000059999,0.000639993600063999,0.000639993600063999,0.000659993400065999,0.000699993000069999,0.000739992600073999,0.000789992100078999,0.000809991900080999,0.000819991800081999,0.000859991400085999,0.000859991400085999,0.000869991300086999,0.000869991300086999,0.000879991200087999,0.000909990900090999,0.000959990400095999],[0.0035519644803552,0.0685726476068573,0.10629893701063,0.00887991120088799,0.00937323960093732,0.102858971410286,0.0102118978810212,0.102858971410286,0.110771199980308,0.113879575489959,0.0141271314559582,0.10629893701063,0.10629893701063,0.1440025599744,0.015909840901591,0.161382179281655,0.116928830711693,0.161382179281655,0.161382179281655,0.161382179281655,0.022541313048408,0.161382179281655,0.161382179281655,0.161382179281655,0.025688314545426,0.161382179281655,0.161382179281655,0.161382179281655,0.161382179281655,0.161382179281655,0.161382179281655,0.161382179281655,0.164574354256457],["0.00204987181156078","0.00192656845456301","0.00104766311399014","0.00383455556996978","0.00509507862770233","0.00141074958831015","0.00168697543515686","1","0.00278122784140195","0.00141074958831015","0.00449535264229885","0.0021571238327559","0.00104766311399014","0.00384470533720593","0.00574635435244976","0.00895499107815625","0.055088336167392","0.00456932602930336","0.0122566624066396","0.0122566624066396","0.014679084863877","0.0165990610764349","0.00456932602930336","0.0434730113061192","0.00821886651469235","0.00194961868789271","0.00657542999022725","0.00164556401997448","0.00109780037691677","0.00109780037691677","0.00109780037691677","0.0122566624066396","0.00545468942356679"],["0.116353330221466","0.458329923714603","0.400556530582232","0.165234485469607","0.181584797537413","0.458329923714603","0.114232336609193","1","0.601523957538414","0.458329923714603","0.177566429370805","0.494844207234204","0.400556530582232","0.719530167321473","0.181584797537413","0.916704823575594","1","0.719530167321473","1","1","0.289911926061571","1","0.719530167321473","1","0.216430151553565","0.458329923714603","0.79418010650963","0.458329923714603","0.456600510614537","0.456600510614537","0.456600510614537","1","0.771792872599965"],["6/57","4/25","3/8","8/109","4/30","2/3","14/249","0/1","2/4","2/3","4/29","3/10","3/8","3/15","4/31","5/59","1/2","2/5","2/8","2/8","6/85","3/25","2/5","1/2","3/18","3/12","3/18","4/24","3/10","3/10","3/10","2/8","4/33"],["APOB;HLA-DRA;LDLR;TAP1;HLA-DQA1;HLA-DQB2","PCSK9;FADS1;INHBB;PPARD","APOB;SNX17;PCSK9","APOB;HLA-DRA;LDLR;RAB11FIP4;DNAJC13;SNX17;PCSK9;RAC1","HLA-DRA;HLA-DQA1;CNIH4;HLA-DQB2","LDLR;PCSK9","APOB;HLA-DRA;INSIG2;TAP1;ABHD12;FADS1;HLA-DQA1;KDSR;HMGCR;CNIH4;CYP2A6;RAC1;CYP4F12;HLA-DQB2","","LDLR;PCSK9","GAS6;GSK3B","HLA-DRA;HLA-DQA1;CNIH4;HLA-DQB2","APOB;SNX17;PCSK9","HLA-DRA;HLA-DQA1;HLA-DQB2","TNKS;GSK3B;PRKD2","HLA-DRA;HLA-DQA1;CNIH4;HLA-DQB2","LDLR;DNAJC13;ASGR1;GAS6;CSNK1G3","PYGB","CETP;LIPC","LIPC;ACP6","LIPC;ACP6","APOB;LDLR;DNAJC13;SNX17;PCSK9;ADRB1","TNKS;RSPO3;CSNK1G3","LDLR;PCSK9","SERPINF2","HLA-DRA;HLA-DQA1;HLA-DQB2","CETP;PGS1;APOC1","TNKS;GSK3B;PRKD2","APOB;CETP;PPARD;HMGCR","INSIG2;HMGCR;NPC1L1","INSIG2;HMGCR;NPC1L1","CETP;LIPC;APOC1","LDLR;PCSK9","INSIG2;PCSK9;GSK3B;INHBB"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>trait<\/th>\n      <th>db<\/th>\n      <th>GO<\/th>\n      <th>pvalue_origin_fractional<\/th>\n      <th>fdr_origin_fractional<\/th>\n      <th>pvalue_calibrated_fractional<\/th>\n      <th>fdr_calibrated_fractional<\/th>\n      <th>pvalue_fet<\/th>\n      <th>fdr_fet<\/th>\n      <th>Overlap_fet<\/th>\n      <th>Overlapped_Genes_fet<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>unique_fet&lt;- merged_two[as.numeric(merged_two$pvalue_calibrated_fractional) &gt; pval_threshold &amp; as.numeric(merged_two$pvalue_fet) &lt; pval_threshold,]
unique_fet &lt;- unique_fet[complete.cases(unique_fet),]
DT::datatable(unique_fet,caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Unique GO terms for FET&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-16707cd634e93674753d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-16707cd634e93674753d">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Unique GO terms for FET<\/caption>","data":[["1412"],["LDL-ukb-d-30780_irnt"],["GO_Biological_Process_2023"],["Low-Density Lipoprotein Particle Remodeling (GO:0034374)"],[0.0112295457326048],[0.30891839300616],[0.00824991750082499],[0.386639526461878],["1.02303302254912e-05"],["0.0184384651764104"],["3/3"],["APOB;CETP;LIPC"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>trait<\/th>\n      <th>db<\/th>\n      <th>GO<\/th>\n      <th>pvalue_origin_fractional<\/th>\n      <th>fdr_origin_fractional<\/th>\n      <th>pvalue_calibrated_fractional<\/th>\n      <th>fdr_calibrated_fractional<\/th>\n      <th>pvalue_fet<\/th>\n      <th>fdr_fet<\/th>\n      <th>Overlap_fet<\/th>\n      <th>Overlapped_Genes_fet<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>p_fractional_calibrated &lt;- as.numeric(unique_fractional$pvalue_calibrated_fractional)
p_fet &lt;- as.numeric(unique_fractional$pvalue_fet)

lgp_fractional_calibrated &lt;- log10(p_fractional_calibrated)
lgp_fet &lt;- log10(p_fet)
 
df &lt;- data.frame(lgp_fractional_calibrated = lgp_fractional_calibrated, lgp_fet = lgp_fet)

 ggplot(df, aes(x = lgp_fractional_calibrated, y = lgp_fet)) +
   geom_point() +  # Add points
   geom_abline(intercept = 0, slope = 1, color = &quot;red&quot;, linetype = &quot;dashed&quot;) +  # y = x line
   #geom_smooth(method = &quot;lm&quot;, se = FALSE, color = &quot;blue&quot;) +  # Best-fit line
   # annotate(&quot;text&quot;, x = max(lgp_fractional_calibrated) * 0.8, y = max(lgp_fet) * 0.9, 
   #          label = paste0(&quot;Slope: &quot;, round(slope, 3)),
   #          color = &quot;blue&quot;) +  # Slope text
   annotate(&quot;text&quot;, x = max(lgp_fractional_calibrated) * 0.8, y = max(lgp_fractional_calibrated) * 0.8, 
            label = &quot;y = x&quot;, color = &quot;red&quot;, size = 5, hjust = 1, vjust = -0.5) +  # y = x text near the line
   ggtitle(&quot;Comparison of p-values between \n fractional_calibrated and FET \n for unique fractional GO terms&quot;) +  # Add title
   xlab(&quot;fractional_calibrated log10(p)&quot;) +  # x-axis label
   ylab(&quot;FET log10(p)&quot;) +  # y-axis label
   theme_minimal()</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd/unnamed-chunk-8-4.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="ibd-ebi-a-gcst004131" class="section level2">
<h2>IBD-ebi-a-GCST004131</h2>
<pre class="r"><code>all_fractional &lt;- c()
all_fet &lt;- c()

trait &lt;- &quot;IBD-ebi-a-GCST004131&quot; 
 
for (db in dbs) {

    file_fet &lt;- paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_blctwas_pip08_&quot;,trait,&quot;_&quot;,db,&quot;.rdata&quot;)
    load(file_fet)
    all_fet &lt;- rbind(all_fet,summary)

    file_fractional &lt;- paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fractional_calibrated_&quot;,trait,&quot;_&quot;,db,&quot;.rdata&quot;)
    load(file_fractional)
    summary$trait &lt;- trait
    summary$db &lt;- db
    all_fractional &lt;- rbind(all_fractional,summary)

}

all_fractional$id &lt;- paste0(all_fractional$trait,&quot;-&quot;,all_fractional$db,&quot;-&quot;,all_fractional$GO)
all_fet$id &lt;- paste0(all_fet$trait,&quot;-&quot;,all_fet$db,&quot;-&quot;,all_fet$GO)

fractional_pass &lt;- all_fractional[as.numeric(all_fractional$pvalue_calibrated) &lt; pval_threshold, ]
fractional_pass &lt;-  fractional_pass[complete.cases( fractional_pass$fdr_origin),]
fet_pass &lt;- all_fet[as.numeric(all_fet$pvalue) &lt; pval_threshold, ]

venn.plot &lt;- draw.pairwise.venn(
     area1 = nrow(fractional_pass),          # Size of Group A
     area2 = nrow(fet_pass),          # Size of Group B
     cross.area = sum(fractional_pass$id %in%  fet_pass$id),     # Overlap between Group A and Group B
     category = c(&quot;Fractional&quot;, &quot;FET&quot;),  # Labels for the groups
     fill = c(&quot;red&quot;, &quot;blue&quot;),             # Colors for the groups
     lty = &quot;blank&quot;,                       # Line type for the circles
     cex = 2,                             # Font size for the numbers
     cat.cex = 2                          # Font size for the labels
   )</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd/unnamed-chunk-9-1.png" width="480" style="display: block; margin: auto;" /></p>
<pre class="r"><code>all_fractional &lt;- all_fractional[,c(&quot;trait&quot;,&quot;db&quot;,&quot;GO&quot;,&quot;pvalue_origin&quot;,&quot;fdr_origin&quot;,&quot;pvalue_calibrated&quot;,&quot;fdr_calibrated&quot;,&quot;id&quot;)]

merged_two &lt;- merge(all_fractional,all_fet, by = &quot;id&quot;)
merged_two &lt;- merged_two[,c(&quot;trait.x&quot;,&quot;db.x&quot;,&quot;GO.x&quot;,&quot;pvalue_origin&quot;,&quot;fdr_origin&quot;,&quot;pvalue_calibrated&quot;,&quot;fdr_calibrated&quot;,&quot;pvalue&quot;,&quot;fdr&quot;,&quot;Overlap&quot;,&quot;Genes&quot;)]
colnames(merged_two) &lt;- c(&quot;trait&quot;,&quot;db&quot;,&quot;GO&quot;,&quot;pvalue_origin_fractional&quot;,&quot;fdr_origin_fractional&quot;,&quot;pvalue_calibrated_fractional&quot;,&quot;fdr_calibrated_fractional&quot;,&quot;pvalue_fet&quot;,&quot;fdr_fet&quot;,&quot;Overlap_fet&quot;,&quot;Overlapped_Genes_fet&quot;)
unique_fractional &lt;- merged_two[as.numeric(merged_two$pvalue_calibrated_fractional) &lt; pval_threshold &amp; as.numeric(merged_two$pvalue_fet) &gt; pval_threshold,]
unique_fractional &lt;- unique_fractional[complete.cases(unique_fractional),]
unique_fractional &lt;- unique_fractional[order(as.numeric(unique_fractional$pvalue_calibrated_fractional)),]
DT::datatable(unique_fractional,caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Unique GO terms for fractional model&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-37e46cf92521dcbed3f8" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-37e46cf92521dcbed3f8">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Unique GO terms for fractional model<\/caption>","data":[["5540","3295","463","6029","444","3091","2002","5111","2816","3127","4368","6314","3344"],["IBD-ebi-a-GCST004131","IBD-ebi-a-GCST004131","IBD-ebi-a-GCST004131","IBD-ebi-a-GCST004131","IBD-ebi-a-GCST004131","IBD-ebi-a-GCST004131","IBD-ebi-a-GCST004131","IBD-ebi-a-GCST004131","IBD-ebi-a-GCST004131","IBD-ebi-a-GCST004131","IBD-ebi-a-GCST004131","IBD-ebi-a-GCST004131","IBD-ebi-a-GCST004131"],["GO_Cellular_Component_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Molecular_Function_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Molecular_Function_2023","GO_Biological_Process_2023"],["Endocytic Vesicle (GO:0030139)","Positive Regulation Of Stress-Activated Protein Kinase Signaling Cascade (GO:0070304)","Cellular Response To Interleukin-6 (GO:0071354)","CARD Domain Binding (GO:0050700)","Cellular Response To Growth Hormone Stimulus (GO:0071378)","Positive Regulation Of NF-kappaB Transcription Factor Activity (GO:0051092)","Negative Regulation Of Lipid Localization (GO:1905953)","T-helper 17 Cell Differentiation (GO:0072539)","Positive Regulation Of DNA-templated DNA Replication (GO:2000105)","Positive Regulation Of Nuclear Cell Cycle DNA Replication (GO:0010571)","Regulation Of Nuclear Cell Cycle DNA Replication (GO:0033262)","Histone Methyltransferase Binding (GO:1990226)","Positive Regulation Of Transcription By RNA Polymerase II (GO:0045944)"],[6.41292325625419e-06,9.20518524281855e-06,4.7681681935888e-06,1.03882850184762e-05,0.000479122734076235,3.6632437431249e-05,3.02950088554095e-05,1.99514701184065e-05,0.0108718754192496,0.0108718754192496,0.0108718754192496,0.0105447658343678,0.000493050312322559],[0.00269984069088302,0.00984731296292087,0.0078595305724322,0.0103259553083654,0.0644734128375803,0.0181026858678158,0.0181026858678158,0.0140942885336457,0.284235142724729,0.284235142724729,0.284235142724729,0.436729051640068,0.0644734128375803],[0.000149998500015,0.000319996800032,0.000329996700033,0.000369996300037,0.000419995800042,0.00049999500005,0.000549994500054999,0.000759992400075999,0.000819991800081999,0.000819991800081999,0.000819991800081999,0.000979990200097999,0.000989990100098999],[0.0631493685063149,0.256356646959846,0.256356646959846,0.367776322236778,0.256356646959846,0.256356646959846,0.256356646959846,0.256356646959846,0.256356646959846,0.256356646959846,0.256356646959846,0.377716222837772,0.256356646959846],["0.0128316248585708","0.00103227872253961","0.00352214706407161","0.0381152691233998","0.0266327624125789","0.0126134281204244","0.0396888707882662","0.00103227872253961","1","1","1","1","0.00375788820027215"],["1","0.797361578967381","1","1","1","1","1","0.797361578967381","1","1","1","1","1"],["3/39","2/4","2/7","1/3","1/2","3/37","1/3","2/4","0/1","0/1","0/1","0/1","8/197"],["HLA-DQB2;HLA-DQA1;NOD2","CARD9;NOD2","STAT3;SBNO2","NOD2","STAT3","CARD9;STAT3;NOD2","PTPN2","STAT3;RORC","","","","","STAT3;FOSL2;MLX;NOD2;CIITA;SBNO2;ZNF300;NR5A2"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>trait<\/th>\n      <th>db<\/th>\n      <th>GO<\/th>\n      <th>pvalue_origin_fractional<\/th>\n      <th>fdr_origin_fractional<\/th>\n      <th>pvalue_calibrated_fractional<\/th>\n      <th>fdr_calibrated_fractional<\/th>\n      <th>pvalue_fet<\/th>\n      <th>fdr_fet<\/th>\n      <th>Overlap_fet<\/th>\n      <th>Overlapped_Genes_fet<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>unique_fet&lt;- merged_two[as.numeric(merged_two$pvalue_calibrated_fractional) &gt; pval_threshold &amp; as.numeric(merged_two$pvalue_fet) &lt; pval_threshold,]
unique_fet &lt;- unique_fet[complete.cases(unique_fet),]
DT::datatable(unique_fet,caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Unique GO terms for FET&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-99e959167faff8d1fc37" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-99e959167faff8d1fc37">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Unique GO terms for FET<\/caption>","data":[["2114"],["IBD-ebi-a-GCST004131"],["GO_Biological_Process_2023"],["Negative Regulation Of Platelet-Derived Growth Factor Receptor Signaling Pathway (GO:0010642)"],[0.00210420302519957],[0.13607395160993],[0.013079869201308],[0.466281533503683],["0.000174997728514548"],["0.315404239359386"],["2/2"],["PTPN2;PTGIR"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>trait<\/th>\n      <th>db<\/th>\n      <th>GO<\/th>\n      <th>pvalue_origin_fractional<\/th>\n      <th>fdr_origin_fractional<\/th>\n      <th>pvalue_calibrated_fractional<\/th>\n      <th>fdr_calibrated_fractional<\/th>\n      <th>pvalue_fet<\/th>\n      <th>fdr_fet<\/th>\n      <th>Overlap_fet<\/th>\n      <th>Overlapped_Genes_fet<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>p_fractional_calibrated &lt;- as.numeric(unique_fractional$pvalue_calibrated_fractional)
p_fet &lt;- as.numeric(unique_fractional$pvalue_fet)

lgp_fractional_calibrated &lt;- log10(p_fractional_calibrated)
lgp_fet &lt;- log10(p_fet)
 
df &lt;- data.frame(lgp_fractional_calibrated = lgp_fractional_calibrated, lgp_fet = lgp_fet)

 ggplot(df, aes(x = lgp_fractional_calibrated, y = lgp_fet)) +
   geom_point() +  # Add points
   geom_abline(intercept = 0, slope = 1, color = &quot;red&quot;, linetype = &quot;dashed&quot;) +  # y = x line
   #geom_smooth(method = &quot;lm&quot;, se = FALSE, color = &quot;blue&quot;) +  # Best-fit line
   # annotate(&quot;text&quot;, x = max(lgp_fractional_calibrated) * 0.8, y = max(lgp_fet) * 0.9, 
   #          label = paste0(&quot;Slope: &quot;, round(slope, 3)),
   #          color = &quot;blue&quot;) +  # Slope text
   annotate(&quot;text&quot;, x = max(lgp_fractional_calibrated) * 0.8, y = max(lgp_fractional_calibrated) * 0.8, 
            label = &quot;y = x&quot;, color = &quot;red&quot;, size = 5, hjust = 1, vjust = -0.5) +  # y = x text near the line
   ggtitle(&quot;Comparison of p-values between \n fractional_calibrated and FET \n for unique fractional GO terms&quot;) +  # Add title
   xlab(&quot;fractional_calibrated log10(p)&quot;) +  # x-axis label
   ylab(&quot;FET log10(p)&quot;) +  # y-axis label
   theme_minimal()</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd/unnamed-chunk-9-4.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="sbp-ukb-a-360" class="section level2">
<h2>SBP-ukb-a-360</h2>
<pre class="r"><code>all_fractional &lt;- c()
all_fet &lt;- c()

trait &lt;- &quot;SBP-ukb-a-360&quot; 
 
for (db in dbs) {

    file_fet &lt;- paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_blctwas_pip08_&quot;,trait,&quot;_&quot;,db,&quot;.rdata&quot;)
    load(file_fet)
    all_fet &lt;- rbind(all_fet,summary)

    file_fractional &lt;- paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fractional_calibrated_&quot;,trait,&quot;_&quot;,db,&quot;.rdata&quot;)
    load(file_fractional)
    summary$trait &lt;- trait
    summary$db &lt;- db
    all_fractional &lt;- rbind(all_fractional,summary)

}

all_fractional$id &lt;- paste0(all_fractional$trait,&quot;-&quot;,all_fractional$db,&quot;-&quot;,all_fractional$GO)
all_fet$id &lt;- paste0(all_fet$trait,&quot;-&quot;,all_fet$db,&quot;-&quot;,all_fet$GO)

fractional_pass &lt;- all_fractional[as.numeric(all_fractional$pvalue_calibrated) &lt; pval_threshold, ]
fractional_pass &lt;-  fractional_pass[complete.cases( fractional_pass$fdr_origin),]
fet_pass &lt;- all_fet[as.numeric(all_fet$pvalue) &lt; pval_threshold, ]

venn.plot &lt;- draw.pairwise.venn(
     area1 = nrow(fractional_pass),          # Size of Group A
     area2 = nrow(fet_pass),          # Size of Group B
     cross.area = sum(fractional_pass$id %in%  fet_pass$id),     # Overlap between Group A and Group B
     category = c(&quot;Fractional&quot;, &quot;FET&quot;),  # Labels for the groups
     fill = c(&quot;red&quot;, &quot;blue&quot;),             # Colors for the groups
     lty = &quot;blank&quot;,                       # Line type for the circles
     cex = 2,                             # Font size for the numbers
     cat.cex = 2                          # Font size for the labels
   )</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd/unnamed-chunk-10-1.png" width="480" style="display: block; margin: auto;" /></p>
<pre class="r"><code>all_fractional &lt;- all_fractional[,c(&quot;trait&quot;,&quot;db&quot;,&quot;GO&quot;,&quot;pvalue_origin&quot;,&quot;fdr_origin&quot;,&quot;pvalue_calibrated&quot;,&quot;fdr_calibrated&quot;,&quot;id&quot;)]

merged_two &lt;- merge(all_fractional,all_fet, by = &quot;id&quot;)
merged_two &lt;- merged_two[,c(&quot;trait.x&quot;,&quot;db.x&quot;,&quot;GO.x&quot;,&quot;pvalue_origin&quot;,&quot;fdr_origin&quot;,&quot;pvalue_calibrated&quot;,&quot;fdr_calibrated&quot;,&quot;pvalue&quot;,&quot;fdr&quot;,&quot;Overlap&quot;,&quot;Genes&quot;)]
colnames(merged_two) &lt;- c(&quot;trait&quot;,&quot;db&quot;,&quot;GO&quot;,&quot;pvalue_origin_fractional&quot;,&quot;fdr_origin_fractional&quot;,&quot;pvalue_calibrated_fractional&quot;,&quot;fdr_calibrated_fractional&quot;,&quot;pvalue_fet&quot;,&quot;fdr_fet&quot;,&quot;Overlap_fet&quot;,&quot;Overlapped_Genes_fet&quot;)
unique_fractional &lt;- merged_two[as.numeric(merged_two$pvalue_calibrated_fractional) &lt; pval_threshold &amp; as.numeric(merged_two$pvalue_fet) &gt; pval_threshold,]
unique_fractional &lt;- unique_fractional[complete.cases(unique_fractional),]
unique_fractional &lt;- unique_fractional[order(as.numeric(unique_fractional$pvalue_calibrated_fractional)),]
DT::datatable(unique_fractional,caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Unique GO terms for fractional model&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-4a6133f685aa29daac40" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-4a6133f685aa29daac40">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Unique GO terms for fractional model<\/caption>","data":[["610","5041","888","4056"],["SBP-ukb-a-360","SBP-ukb-a-360","SBP-ukb-a-360","SBP-ukb-a-360"],["GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023"],["Contractile Actin Filament Bundle Assembly (GO:0030038)","Stress Fiber Assembly (GO:0043149)","Establishment Of Epithelial Cell Polarity (GO:0090162)","Regulation Of Fatty Acid Biosynthetic Process (GO:0042304)"],[1.06477875589515e-06,1.06477875589515e-06,1.65418304883661e-05,3.81038110178834e-05],[0.00139406158615572,0.00139406158615572,0.0173259132535147,0.0323587295654736],[0.000139998600014,0.000139998600014,0.000309996900031,0.000959990400095999],[0.183293167068329,0.183293167068329,0.324690753092469,0.718209960757535],["0.00375191268478792","0.00375191268478792","0.00181872081939397","0.0540002042166938"],["1","1","1","1"],["2/7","2/7","2/5","1/4"],["RHOA;PHACTR1","RHOA;PHACTR1","RHOA;SIPA1","NR1H3"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>trait<\/th>\n      <th>db<\/th>\n      <th>GO<\/th>\n      <th>pvalue_origin_fractional<\/th>\n      <th>fdr_origin_fractional<\/th>\n      <th>pvalue_calibrated_fractional<\/th>\n      <th>fdr_calibrated_fractional<\/th>\n      <th>pvalue_fet<\/th>\n      <th>fdr_fet<\/th>\n      <th>Overlap_fet<\/th>\n      <th>Overlapped_Genes_fet<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>unique_fet&lt;- merged_two[as.numeric(merged_two$pvalue_calibrated_fractional) &gt; pval_threshold &amp; as.numeric(merged_two$pvalue_fet) &lt; pval_threshold,]
unique_fet &lt;- unique_fet[complete.cases(unique_fet),]
DT::datatable(unique_fet,caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Unique GO terms for FET&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-d72b6eff4afa454a8832" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d72b6eff4afa454a8832">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Unique GO terms for FET<\/caption>","data":[[],[],[],[],[],[],[],[],[],[],[],[]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>trait<\/th>\n      <th>db<\/th>\n      <th>GO<\/th>\n      <th>pvalue_origin_fractional<\/th>\n      <th>fdr_origin_fractional<\/th>\n      <th>pvalue_calibrated_fractional<\/th>\n      <th>fdr_calibrated_fractional<\/th>\n      <th>pvalue_fet<\/th>\n      <th>fdr_fet<\/th>\n      <th>Overlap_fet<\/th>\n      <th>Overlapped_Genes_fet<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>p_fractional_calibrated &lt;- as.numeric(unique_fractional$pvalue_calibrated_fractional)
p_fet &lt;- as.numeric(unique_fractional$pvalue_fet)

lgp_fractional_calibrated &lt;- log10(p_fractional_calibrated)
lgp_fet &lt;- log10(p_fet)
 
df &lt;- data.frame(lgp_fractional_calibrated = lgp_fractional_calibrated, lgp_fet = lgp_fet)

 ggplot(df, aes(x = lgp_fractional_calibrated, y = lgp_fet)) +
   geom_point() +  # Add points
   geom_abline(intercept = 0, slope = 1, color = &quot;red&quot;, linetype = &quot;dashed&quot;) +  # y = x line
   #geom_smooth(method = &quot;lm&quot;, se = FALSE, color = &quot;blue&quot;) +  # Best-fit line
   # annotate(&quot;text&quot;, x = max(lgp_fractional_calibrated) * 0.8, y = max(lgp_fet) * 0.9, 
   #          label = paste0(&quot;Slope: &quot;, round(slope, 3)),
   #          color = &quot;blue&quot;) +  # Slope text
   annotate(&quot;text&quot;, x = max(lgp_fractional_calibrated) * 0.8, y = max(lgp_fractional_calibrated) * 0.8, 
            label = &quot;y = x&quot;, color = &quot;red&quot;, size = 5, hjust = 1, vjust = -0.5) +  # y = x text near the line
   ggtitle(&quot;Comparison of p-values between \n fractional_calibrated and FET \n for unique fractional GO terms&quot;) +  # Add title
   xlab(&quot;fractional_calibrated log10(p)&quot;) +  # x-axis label
   ylab(&quot;FET log10(p)&quot;) +  # y-axis label
   theme_minimal()</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd/unnamed-chunk-10-4.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="scz-ieu-b-5102" class="section level2">
<h2>SCZ-ieu-b-5102</h2>
<pre class="r"><code>all_fractional &lt;- c()
all_fet &lt;- c()

trait &lt;- &quot;SCZ-ieu-b-5102&quot; 
 
for (db in dbs) {

    file_fet &lt;- paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_blctwas_pip08_&quot;,trait,&quot;_&quot;,db,&quot;.rdata&quot;)
    load(file_fet)
    all_fet &lt;- rbind(all_fet,summary)

    file_fractional &lt;- paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fractional_calibrated_&quot;,trait,&quot;_&quot;,db,&quot;.rdata&quot;)
    load(file_fractional)
    summary$trait &lt;- trait
    summary$db &lt;- db
    all_fractional &lt;- rbind(all_fractional,summary)

}

all_fractional$id &lt;- paste0(all_fractional$trait,&quot;-&quot;,all_fractional$db,&quot;-&quot;,all_fractional$GO)
all_fet$id &lt;- paste0(all_fet$trait,&quot;-&quot;,all_fet$db,&quot;-&quot;,all_fet$GO)

fractional_pass &lt;- all_fractional[as.numeric(all_fractional$pvalue_calibrated) &lt; pval_threshold, ]
fractional_pass &lt;-  fractional_pass[complete.cases( fractional_pass$fdr_origin),]
fet_pass &lt;- all_fet[as.numeric(all_fet$pvalue) &lt; pval_threshold, ]

venn.plot &lt;- draw.pairwise.venn(
     area1 = nrow(fractional_pass),          # Size of Group A
     area2 = nrow(fet_pass),          # Size of Group B
     cross.area = sum(fractional_pass$id %in%  fet_pass$id),     # Overlap between Group A and Group B
     category = c(&quot;Fractional&quot;, &quot;FET&quot;),  # Labels for the groups
     fill = c(&quot;red&quot;, &quot;blue&quot;),             # Colors for the groups
     lty = &quot;blank&quot;,                       # Line type for the circles
     cex = 2,                             # Font size for the numbers
     cat.cex = 2                          # Font size for the labels
   )</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd/unnamed-chunk-11-1.png" width="480" style="display: block; margin: auto;" /></p>
<pre class="r"><code>all_fractional &lt;- all_fractional[,c(&quot;trait&quot;,&quot;db&quot;,&quot;GO&quot;,&quot;pvalue_origin&quot;,&quot;fdr_origin&quot;,&quot;pvalue_calibrated&quot;,&quot;fdr_calibrated&quot;,&quot;id&quot;)]

merged_two &lt;- merge(all_fractional,all_fet, by = &quot;id&quot;)
merged_two &lt;- merged_two[,c(&quot;trait.x&quot;,&quot;db.x&quot;,&quot;GO.x&quot;,&quot;pvalue_origin&quot;,&quot;fdr_origin&quot;,&quot;pvalue_calibrated&quot;,&quot;fdr_calibrated&quot;,&quot;pvalue&quot;,&quot;fdr&quot;,&quot;Overlap&quot;,&quot;Genes&quot;)]
colnames(merged_two) &lt;- c(&quot;trait&quot;,&quot;db&quot;,&quot;GO&quot;,&quot;pvalue_origin_fractional&quot;,&quot;fdr_origin_fractional&quot;,&quot;pvalue_calibrated_fractional&quot;,&quot;fdr_calibrated_fractional&quot;,&quot;pvalue_fet&quot;,&quot;fdr_fet&quot;,&quot;Overlap_fet&quot;,&quot;Overlapped_Genes_fet&quot;)
unique_fractional &lt;- merged_two[as.numeric(merged_two$pvalue_calibrated_fractional) &lt; pval_threshold &amp; as.numeric(merged_two$pvalue_fet) &gt; pval_threshold,]
unique_fractional &lt;- unique_fractional[complete.cases(unique_fractional),]
unique_fractional &lt;- unique_fractional[order(as.numeric(unique_fractional$pvalue_calibrated_fractional)),]
DT::datatable(unique_fractional,caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Unique GO terms for fractional model&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-73d12cd98287c4e0164c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-73d12cd98287c4e0164c">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Unique GO terms for fractional model<\/caption>","data":[["5820","1872","138","139","140","146","2062","2074","4617","5583","136","5462","144","3314","4486"],["SCZ-ieu-b-5102","SCZ-ieu-b-5102","SCZ-ieu-b-5102","SCZ-ieu-b-5102","SCZ-ieu-b-5102","SCZ-ieu-b-5102","SCZ-ieu-b-5102","SCZ-ieu-b-5102","SCZ-ieu-b-5102","SCZ-ieu-b-5102","SCZ-ieu-b-5102","SCZ-ieu-b-5102","SCZ-ieu-b-5102","SCZ-ieu-b-5102","SCZ-ieu-b-5102"],["GO_Cellular_Component_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Cellular_Component_2023","GO_Biological_Process_2023","GO_Cellular_Component_2023","GO_Biological_Process_2023","GO_Biological_Process_2023","GO_Biological_Process_2023"],["THO Complex Part Of Transcription Export Complex (GO:0000445)","Negative Regulation Of Defense Response To Virus (GO:0050687)","Antigen Processing And Presentation Of Endogenous Peptide Antigen Via MHC Class I Via ER Pathway (GO:0002484)","Antigen Processing And Presentation Of Endogenous Peptide Antigen Via MHC Class I Via ER Pathway, TAP-independent (GO:0002486)","Antigen Processing And Presentation Of Endogenous Peptide Antigen Via MHC Class Ib (GO:0002476)","Antigen Processing And Presentation Of Peptide Antigen Via MHC Class Ib (GO:0002428)","Negative Regulation Of Natural Killer Cell Mediated Cytotoxicity (GO:0045953)","Negative Regulation Of Neuron Projection Development (GO:0010977)","Regulation Of T Cell Mediated Cytotoxicity (GO:0001914)","Golgi Medial Cisterna (GO:0005797)","Antigen Processing And Presentation Of Endogenous Peptide Antigen (GO:0002483)","COPII-coated ER To Golgi Transport Vesicle (GO:0030134)","Antigen Processing And Presentation Of Peptide Antigen Via MHC Class I (GO:0002474)","Positive Regulation Of T Cell Mediated Cytotoxicity (GO:0001916)","Regulation Of Protein Serine/Threonine Kinase Activity (GO:0071900)"],[0.00725382659067059,3.05146765122329e-07,4.07348958408599e-07,4.07348958408599e-07,4.07348958408599e-07,4.07348958408599e-07,4.00191166801184e-06,1.38529765295617e-05,1.86478038672558e-05,0.000401514926782086,1.49309353840047e-05,5.14252846388243e-05,3.56358278141507e-05,3.39232033728881e-05,6.3316298401363e-05],[0.254965410455167,0.00041500711882668,0.00041500711882668,0.00041500711882668,0.00041500711882668,0.00041500711882668,0.00339762300614205,0.00950727310576502,0.0105546569888668,0.0911438883795335,0.00950727310576502,0.0233470792260262,0.0165026278986622,0.0165026278986622,0.0215022149371029],[9.99990000099999e-06,2.9999700003e-05,4.99995000049999e-05,4.99995000049999e-05,4.99995000049999e-05,4.99995000049999e-05,0.000269997300027,0.000579994200057999,0.000629993700062999,0.000639993600063999,0.000669993300066999,0.000739992600073999,0.000789992100078999,0.000819991800081999,0.000949990500094999],[0.004539954600454,0.0509394906050939,0.0509394906050939,0.0509394906050939,0.0509394906050939,0.0509394906050939,0.229227707722923,0.379216207837922,0.379216207837922,0.111985546811199,0.379216207837922,0.111985546811199,0.379730748147064,0.379730748147064,0.403270967290327],["1","0.0437481283146919","0.0020813085910275","0.0020813085910275","0.0020813085910275","0.0020813085910275","0.0011275019429804","0.00961533895883859","0.00563865727056461","0.0194351568493079","0.00563865727056461","0.0358388443047047","0.00266108653159055","0.00654194296451596","0.208069379172274"],["1","1","1","1","1","1","1","1","1","1","1","1","1","1","1"],["0/1","1/5","2/8","2/8","2/8","2/8","2/6","2/17","2/13","1/2","2/13","2/31","2/9","2/14","1/26"],["","NT5C2","HLA-A;HLA-G","HLA-A;HLA-G","HLA-A;HLA-G","HLA-A;HLA-G","HLA-A;HLA-G","LRP4;TRPV4","HLA-A;HLA-G","HLA-A","HLA-A;HLA-G","HLA-A;HLA-G","HLA-A;ACE","HLA-A;HLA-G","MST1"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>trait<\/th>\n      <th>db<\/th>\n      <th>GO<\/th>\n      <th>pvalue_origin_fractional<\/th>\n      <th>fdr_origin_fractional<\/th>\n      <th>pvalue_calibrated_fractional<\/th>\n      <th>fdr_calibrated_fractional<\/th>\n      <th>pvalue_fet<\/th>\n      <th>fdr_fet<\/th>\n      <th>Overlap_fet<\/th>\n      <th>Overlapped_Genes_fet<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>unique_fet&lt;- merged_two[as.numeric(merged_two$pvalue_calibrated_fractional) &gt; pval_threshold &amp; as.numeric(merged_two$pvalue_fet) &lt; pval_threshold,]
unique_fet &lt;- unique_fet[complete.cases(unique_fet),]
DT::datatable(unique_fet,caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Unique GO terms for FET&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-0796cbf5802287e6981e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-0796cbf5802287e6981e">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Unique GO terms for FET<\/caption>","data":[[],[],[],[],[],[],[],[],[],[],[],[]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>trait<\/th>\n      <th>db<\/th>\n      <th>GO<\/th>\n      <th>pvalue_origin_fractional<\/th>\n      <th>fdr_origin_fractional<\/th>\n      <th>pvalue_calibrated_fractional<\/th>\n      <th>fdr_calibrated_fractional<\/th>\n      <th>pvalue_fet<\/th>\n      <th>fdr_fet<\/th>\n      <th>Overlap_fet<\/th>\n      <th>Overlapped_Genes_fet<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>p_fractional_calibrated &lt;- as.numeric(unique_fractional$pvalue_calibrated_fractional)
p_fet &lt;- as.numeric(unique_fractional$pvalue_fet)

lgp_fractional_calibrated &lt;- log10(p_fractional_calibrated)
lgp_fet &lt;- log10(p_fet)
 
df &lt;- data.frame(lgp_fractional_calibrated = lgp_fractional_calibrated, lgp_fet = lgp_fet)

 ggplot(df, aes(x = lgp_fractional_calibrated, y = lgp_fet)) +
   geom_point() +  # Add points
   geom_abline(intercept = 0, slope = 1, color = &quot;red&quot;, linetype = &quot;dashed&quot;) +  # y = x line
   #geom_smooth(method = &quot;lm&quot;, se = FALSE, color = &quot;blue&quot;) +  # Best-fit line
   # annotate(&quot;text&quot;, x = max(lgp_fractional_calibrated) * 0.8, y = max(lgp_fet) * 0.9, 
   #          label = paste0(&quot;Slope: &quot;, round(slope, 3)),
   #          color = &quot;blue&quot;) +  # Slope text
   annotate(&quot;text&quot;, x = max(lgp_fractional_calibrated) * 0.8, y = max(lgp_fractional_calibrated) * 0.8, 
            label = &quot;y = x&quot;, color = &quot;red&quot;, size = 5, hjust = 1, vjust = -0.5) +  # y = x text near the line
   ggtitle(&quot;Comparison of p-values between \n fractional_calibrated and FET \n for unique fractional GO terms&quot;) +  # Add title
   xlab(&quot;fractional_calibrated log10(p)&quot;) +  # x-axis label
   ylab(&quot;FET log10(p)&quot;) +  # y-axis label
   theme_minimal()</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess_enrichment_genesymbol.Rmd/unnamed-chunk-11-4.png" width="480" style="display: block; margin: auto;" /></p>
<!-- ## WBC-ieu-b-30 -->
<!-- ```{r echo=T, fig.height=5, fig.width=5, message=FALSE, warning=FALSE} -->
<!-- all_fractional <- c() -->
<!-- all_fet <- c() -->
<!-- trait <- "WBC-ieu-b-30" -->
<!-- for (db in dbs) { -->
<!--     file_fet <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_blctwas_pip08_",trait,"_",db,".rdata") -->
<!--     load(file_fet) -->
<!--     all_fet <- rbind(all_fet,summary) -->
<!--     file_fractional <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fractional_calibrated_",trait,"_",db,".rdata") -->
<!--     load(file_fractional) -->
<!--     summary$trait <- trait -->
<!--     summary$db <- db -->
<!--     all_fractional <- rbind(all_fractional,summary) -->
<!-- } -->
<!-- all_fractional$id <- paste0(all_fractional$trait,"-",all_fractional$db,"-",all_fractional$GO) -->
<!-- all_fet$id <- paste0(all_fet$trait,"-",all_fet$db,"-",all_fet$GO) -->
<!-- fractional_pass <- all_fractional[as.numeric(all_fractional$pvalue_calibrated) < pval_threshold, ] -->
<!-- fractional_pass <-  fractional_pass[complete.cases( fractional_pass$fdr_origin),] -->
<!-- fet_pass <- all_fet[as.numeric(all_fet$pvalue) < pval_threshold, ] -->
<!-- venn.plot <- draw.pairwise.venn( -->
<!--      area1 = nrow(fractional_pass),          # Size of Group A -->
<!--      area2 = nrow(fet_pass),          # Size of Group B -->
<!--      cross.area = sum(fractional_pass$id %in%  fet_pass$id),     # Overlap between Group A and Group B -->
<!--      category = c("Fractional", "FET"),  # Labels for the groups -->
<!--      fill = c("red", "blue"),             # Colors for the groups -->
<!--      lty = "blank",                       # Line type for the circles -->
<!--      cex = 2,                             # Font size for the numbers -->
<!--      cat.cex = 2                          # Font size for the labels -->
<!--    ) -->
<!-- all_fractional <- all_fractional[,c("trait","db","GO","pvalue_origin","fdr_origin","pvalue_calibrated","fdr_calibrated","id")] -->
<!-- merged_two <- merge(all_fractional,all_fet, by = "id") -->
<!-- merged_two <- merged_two[,c("trait.x","db.x","GO.x","pvalue_origin","fdr_origin","pvalue_calibrated","fdr_calibrated","pvalue","fdr","Overlap","Genes")] -->
<!-- colnames(merged_two) <- c("trait","db","GO","pvalue_origin_fractional","fdr_origin_fractional","pvalue_calibrated_fractional","fdr_calibrated_fractional","pvalue_fet","fdr_fet","Overlap_fet","Overlapped_Genes_fet") -->
<!-- unique_fractional <- merged_two[as.numeric(merged_two$pvalue_calibrated_fractional) < pval_threshold & as.numeric(merged_two$pvalue_fet) > pval_threshold,] -->
<!-- unique_fractional <- unique_fractional[complete.cases(unique_fractional),] -->
<!-- unique_fractional <- unique_fractional[order(as.numeric(unique_fractional$pvalue_calibrated_fractional)),] -->
<!-- DT::datatable(unique_fractional,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Unique GO terms for fractional model'),options = list(pageLength = 10) ) -->
<!-- unique_fet<- merged_two[as.numeric(merged_two$pvalue_calibrated_fractional) > pval_threshold & as.numeric(merged_two$pvalue_fet) < pval_threshold,] -->
<!-- unique_fet <- unique_fet[complete.cases(unique_fet),] -->
<!-- DT::datatable(unique_fet,caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Unique GO terms for FET'),options = list(pageLength = 10) ) -->
<!-- p_fractional_calibrated <- as.numeric(unique_fractional$pvalue_calibrated_fractional) -->
<!-- p_fet <- as.numeric(unique_fractional$pvalue_fet) -->
<!-- lgp_fractional_calibrated <- log10(p_fractional_calibrated) -->
<!-- lgp_fet <- log10(p_fet) -->
<!-- df <- data.frame(lgp_fractional_calibrated = lgp_fractional_calibrated, lgp_fet = lgp_fet) -->
<!--  ggplot(df, aes(x = lgp_fractional_calibrated, y = lgp_fet)) + -->
<!--    geom_point() +  # Add points -->
<!--    geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +  # y = x line -->
<!--    #geom_smooth(method = "lm", se = FALSE, color = "blue") +  # Best-fit line -->
<!--    # annotate("text", x = max(lgp_fractional_calibrated) * 0.8, y = max(lgp_fet) * 0.9, -->
<!--    #          label = paste0("Slope: ", round(slope, 3)), -->
<!--    #          color = "blue") +  # Slope text -->
<!--    annotate("text", x = max(lgp_fractional_calibrated) * 0.8, y = max(lgp_fractional_calibrated) * 0.8, -->
<!--             label = "y = x", color = "red", size = 5, hjust = 1, vjust = -0.5) +  # y = x text near the line -->
<!--    ggtitle("Comparison of p-values between \n fractional_calibrated and FET \n for unique fractional GO terms") +  # Add title -->
<!--    xlab("fractional_calibrated log10(p)") +  # x-axis label -->
<!--    ylab("FET log10(p)") +  # y-axis label -->
<!--    theme_minimal() -->
<!-- ``` -->
<!-- <!-- ```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5} -->
<p>–&gt;</p>
<!-- <!--  pval <- 0.001 -->
<p>–&gt;</p>
<!-- <!--  all_fractional <- c() -->
<p>–&gt; <!-- <!--  all_fet <- c() --> –&gt;
<!-- <!--  for (trait in traits) { --> –&gt;
<!-- <!--    for (db in dbs) { --> –&gt;</p>
<!-- <!--      file_fet <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_blctwas_pip08_",trait,"_",db,".rdata") -->
<p>–&gt; <!-- <!--      load(file_fet) --> –&gt;
<!-- <!--      all_fet <- rbind(all_fet,summary[as.numeric(summary$pvalue) < pval,]) -->
–&gt;</p>
<!-- <!--      file_fractional <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fractional_",trait,"_",db,".rdata") -->
<p>–&gt; <!-- <!--      load(file_fractional) --> –&gt;
<!-- <!--      summary$trait <- trait --> –&gt;
<!-- <!--      summary$db <- db --> –&gt;
<!-- <!--      all_fractional <- rbind(all_fractional,summary[as.numeric(summary$pvalue) < pval,]) -->
–&gt;</p>
<!-- <!--    } -->
<p>–&gt; <!-- <!--  } --> –&gt;</p>
<!-- <!--  all_fractional <- all_fractional[complete.cases(all_fractional),] -->
<p>–&gt;
<!-- <!--  all_fractional$id <- paste0(all_fractional$trait,"-",all_fractional$db,"-",all_fractional$GO) -->
–&gt;
<!-- <!--  all_fet$id <- paste0(all_fet$trait,"-",all_fet$db,"-",all_fet$GO) -->
–&gt;</p>
<!-- <!--  venn.plot <- draw.pairwise.venn( -->
<p>–&gt;
<!-- <!--      area1 = nrow(all_fractional),          # Size of Group A -->
–&gt;
<!-- <!--      area2 = nrow(all_fet),          # Size of Group B -->
–&gt;
<!-- <!--      cross.area = sum(all_fractional$id %in% all_fet$id),     # Overlap between Group A and Group B -->
–&gt;
<!-- <!--      category = c("Fractional", "FET"),  # Labels for the groups -->
–&gt;
<!-- <!--      fill = c("red", "blue"),             # Colors for the groups -->
–&gt;
<!-- <!--      lty = "blank",                       # Line type for the circles -->
–&gt;
<!-- <!--      cex = 2,                             # Font size for the numbers -->
–&gt;
<!-- <!--      cat.cex = 2                          # Font size for the labels -->
–&gt; <!-- <!--    ) --> –&gt;</p>
<!-- <!--  all_fractional <- all_fractional[,c("trait","db","GO","pvalue","fdr","id")] -->
<p>–&gt;
<!-- <!--  DT::datatable(all_fractional[!all_fractional$id %in% all_fet$id,],caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Unique GO terms for fractional model'),options = list(pageLength = 10) ) -->
–&gt;</p>
<!-- <!--  DT::datatable(all_fet[!all_fet$id %in% all_fractional$id,],caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Unique GO terms for FET'),options = list(pageLength = 10) ) -->
<p>–&gt;</p>
<!-- <!-- ``` -->
<p>–&gt;</p>
<!-- <!-- # Comparing the GO terms reported by FET and Fractional model -- p-values < 0.001, baseline genes are all genes from gene sets, redundant terms NOT removed -->
<p>–&gt;</p>
<!-- <!-- ```{r, echo=T, message=FALSE, warning=FALSE, fig.width=5, fig.height=5} -->
<p>–&gt;</p>
<!-- <!--  pval <- 0.001 -->
<p>–&gt;</p>
<!-- <!--  all_fractional <- c() -->
<p>–&gt; <!-- <!--  all_fet <- c() --> –&gt;
<!-- <!--  for (trait in traits) { --> –&gt;
<!-- <!--    for (db in dbs) { --> –&gt;</p>
<!-- <!--      file_fet <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fisher_blgeneset_pip08_",trait,"_",db,".rdata") -->
<p>–&gt; <!-- <!--      load(file_fet) --> –&gt;
<!-- <!--      all_fet <- rbind(all_fet,summary[as.numeric(summary$pvalue) < pval,]) -->
–&gt;</p>
<!-- <!--      file_fractional <- paste0("/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/postprocess/enrichment_fractional_blgeneset_",trait,"_",db,".rdata") -->
<p>–&gt; <!-- <!--      load(file_fractional) --> –&gt;
<!-- <!--      summary$trait <- trait --> –&gt;
<!-- <!--      summary$db <- db --> –&gt;
<!-- <!--      all_fractional <- rbind(all_fractional,summary[as.numeric(summary$pvalue) < pval,]) -->
–&gt;</p>
<!-- <!--    } -->
<p>–&gt; <!-- <!--  } --> –&gt;</p>
<!-- <!--  all_fractional <- all_fractional[complete.cases(all_fractional),] -->
<p>–&gt;
<!-- <!--  all_fractional$id <- paste0(all_fractional$trait,"-",all_fractional$db,"-",all_fractional$GO) -->
–&gt;
<!-- <!--  all_fet$id <- paste0(all_fet$trait,"-",all_fet$db,"-",all_fet$GO) -->
–&gt;</p>
<!-- <!--  venn.plot <- draw.pairwise.venn( -->
<p>–&gt;
<!-- <!--      area1 = nrow(all_fractional),          # Size of Group A -->
–&gt;
<!-- <!--      area2 = nrow(all_fet),          # Size of Group B -->
–&gt;
<!-- <!--      cross.area = sum(all_fractional$id %in% all_fet$id),     # Overlap between Group A and Group B -->
–&gt;
<!-- <!--      category = c("Fractional", "FET"),  # Labels for the groups -->
–&gt;
<!-- <!--      fill = c("red", "blue"),             # Colors for the groups -->
–&gt;
<!-- <!--      lty = "blank",                       # Line type for the circles -->
–&gt;
<!-- <!--      cex = 2,                             # Font size for the numbers -->
–&gt;
<!-- <!--      cat.cex = 2                          # Font size for the labels -->
–&gt; <!-- <!--    ) --> –&gt;</p>
<!-- <!--  all_fractional <- all_fractional[,c("trait","db","GO","pvalue","fdr","id")] -->
<p>–&gt;
<!-- <!--  DT::datatable(all_fractional[!all_fractional$id %in% all_fet$id,],caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Unique GO terms for fractional model'),options = list(pageLength = 10) ) -->
–&gt;</p>
<!-- <!--  DT::datatable(all_fet[!all_fet$id %in% all_fractional$id,],caption = htmltools::tags$caption( style = 'caption-side: topleft; text-align = left; color:black;','Unique GO terms for FET'),options = list(pageLength = 10) ) -->
<p>–&gt; <!-- <!-- ``` --> –&gt;</p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.0 (2022-04-22)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: CentOS Linux 7 (Core)

Matrix products: default
BLAS/LAPACK: /software/openblas-0.3.13-el7-x86_64/lib/libopenblas_haswellp-r0.3.13.so

locale:
[1] C

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
[1] ggplot2_3.5.1       VennDiagram_1.7.3   futile.logger_1.4.3
[4] dplyr_1.1.4         tidyr_1.3.0        

loaded via a namespace (and not attached):
 [1] tidyselect_1.2.0     xfun_0.41            bslib_0.3.1         
 [4] purrr_1.0.2          colorspace_2.0-3     vctrs_0.6.5         
 [7] generics_0.1.2       htmltools_0.5.2      yaml_2.3.5          
[10] utf8_1.2.2           rlang_1.1.2          jquerylib_0.1.4     
[13] later_1.3.0          pillar_1.9.0         glue_1.6.2          
[16] withr_2.5.0          lambda.r_1.2.4       lifecycle_1.0.4     
[19] stringr_1.5.1        munsell_0.5.0        gtable_0.3.0        
[22] workflowr_1.7.0      htmlwidgets_1.5.4    evaluate_0.15       
[25] labeling_0.4.2       knitr_1.39           fastmap_1.1.0       
[28] crosstalk_1.2.0      httpuv_1.6.5         fansi_1.0.3         
[31] highr_0.9            Rcpp_1.0.12          promises_1.2.0.1    
[34] scales_1.3.0         DT_0.22              formatR_1.12        
[37] jsonlite_1.8.0       farver_2.1.0         fs_1.5.2            
[40] digest_0.6.29        stringi_1.7.6        rprojroot_2.0.3     
[43] cli_3.6.1            tools_4.2.0          magrittr_2.0.3      
[46] sass_0.4.1           tibble_3.2.1         futile.options_1.0.1
[49] whisker_0.4          pkgconfig_2.0.3      rmarkdown_2.25      
[52] rstudioapi_0.13      R6_2.5.1             git2r_0.30.1        
[55] compiler_4.2.0      </code></pre>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
