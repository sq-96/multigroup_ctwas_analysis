<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="XSun" />

<meta name="date" content="2024-10-15" />

<title>6 Traits, 5 tissues, eQTL + sQTL + stQTL</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.22/datatables.js"></script>
<link href="site_libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">multigroup_ctwas_analysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sq-96/multigroup_ctwas_analysis">
    <span class="fab fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">6 Traits, 5 tissues, eQTL + sQTL +
stQTL</h1>
<h4 class="author">XSun</h4>
<h4 class="date">2024-10-15</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2024-10-16
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 6
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 1
</p>
<p>
<strong>Knit directory:</strong> <code>multigroup_ctwas_analysis/</code>
<span class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.0). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguncommittedchanges">
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> <strong>R Markdown file:</strong> uncommitted
changes </a>
</p>
</div>
<div id="strongRMarkdownfilestronguncommittedchanges"
class="panel-collapse collapse">
<div class="panel-body">
<p>The R Markdown file has unstaged changes. To know which version of
the R Markdown file created these results, you’ll want to first commit
it to the Git repo. If you’re still working on the analysis, you can
ignore this warning. When you’re finished, you can run
<code>wflow_publish</code> to commit the R Markdown file and build the
HTML.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20231112code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20231112)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20231112code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20231112)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomsq96multigroupctwasanalysistree4a84d72e7453cf3617b2b5a0fdd798d0595620e2targetblank4a84d72a">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/tree/4a84d72e7453cf3617b2b5a0fdd798d0595620e2" target="_blank">4a84d72</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomsq96multigroupctwasanalysistree4a84d72e7453cf3617b2b5a0fdd798d0595620e2targetblank4a84d72a"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/tree/4a84d72e7453cf3617b2b5a0fdd798d0595620e2" target="_blank">4a84d72</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    analysis/figure/

Unstaged changes:
    Modified:   analysis/multi_group_6traits_15weights_ess.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were
made to the R Markdown
(<code>analysis/multi_group_6traits_15weights_ess.Rmd</code>) and HTML
(<code>docs/multi_group_6traits_15weights_ess.html</code>) files. If
you’ve configured a remote Git repository (see
<code>?wflow_git_remote</code>), click on the hyperlinks in the table
below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/4a84d72e7453cf3617b2b5a0fdd798d0595620e2/analysis/multi_group_6traits_15weights_ess.Rmd" target="_blank">4a84d72</a>
</td>
<td>
XSun
</td>
<td>
2024-10-15
</td>
<td>
update
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sq-96/multigroup_ctwas_analysis/4a84d72e7453cf3617b2b5a0fdd798d0595620e2/docs/multi_group_6traits_15weights_ess.html" target="_blank">4a84d72</a>
</td>
<td>
XSun
</td>
<td>
2024-10-15
</td>
<td>
update
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="overview" class="section level1">
<h1>Overview</h1>
<div id="traits" class="section level2">
<h2>Traits</h2>
<p>aFib, IBD, LDL, SBP, SCZ, WBC</p>
<p><a
href="https://sq-96.github.io/multigroup_ctwas_analysis/data.html">details</a></p>
</div>
<div id="tissues" class="section level2">
<h2>Tissues</h2>
<p>The independent tissues are selected by <a
href="https://sq-96.github.io/multigroup_ctwas_analysis/matching_tissue_v2_preL.html">single
tissue analysis</a></p>
</div>
<div id="omics" class="section level2">
<h2>Omics</h2>
<p>eQTL, sQTL weights are from Predictdb</p>
<p>stQTL was a combination of <a
href="https://sq-96.github.io/multigroup_ctwas_analysis/data_6modality_Munro.html">Munro
apa + rs QTL</a>, if a gene has both rs-QTL and APA-QTL, we use
rs-QTL.</p>
</div>
<div id="settings" class="section level2">
<h2>Settings</h2>
</div>
<div id="stqtl-from-munro" class="section level2">
<h2>stQTL from Munro</h2>
<ol style="list-style-type: decimal">
<li>Weight processing:</li>
</ol>
<p>PredictDB:</p>
<p>all the PredictDB are converted from FUSION weights</p>
<ul>
<li>drop_strand_ambig = TRUE,</li>
<li>scale_by_ld_variance = F (FUSION converted weights)</li>
<li>load_predictdb_LD = F,</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Parameter estimation and fine-mapping</li>
</ol>
<ul>
<li>niter_prefit = 5,</li>
<li>niter = 30(default),</li>
<li>filter_L = TRUE,</li>
<li>group_prior_var_structure = “shared_type”,</li>
<li>maxSNP = 20000,</li>
<li>min_nonSNP_PIP = 0.5,</li>
</ul>
</div>
<div id="e-s-qtl-from-predictdb" class="section level2">
<h2>e + s QTL from predictdb</h2>
<ol style="list-style-type: decimal">
<li>Weight processing:</li>
</ol>
<p>PredictDB (eqtl, sqtl)</p>
<ul>
<li>drop_strand_ambig = TRUE,</li>
<li>scale_by_ld_variance = T</li>
<li>load_predictdb_LD = F,</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Parameter estimation and fine-mapping</li>
</ol>
<ul>
<li>group_prior_var_structure = “shared_type”,</li>
<li>filter_L = TRUE,</li>
<li>filter_nonSNP_PIP = FALSE,</li>
<li>min_abs_corr = 0.1,</li>
</ul>
<p>mem: 150g 10cores</p>
<pre class="r"><code>library(ctwas)
library(ggplot2)
library(tidyverse)
library(pheatmap)
library(EnsDb.Hsapiens.v86)

ens_db &lt;- EnsDb.Hsapiens.v86

mapping_predictdb &lt;- readRDS(&quot;/project2/xinhe/shared_data/multigroup_ctwas/weights/mapping_files/PredictDB_mapping.RDS&quot;)
mapping_munro &lt;- readRDS(&quot;/project2/xinhe/shared_data/multigroup_ctwas/weights/mapping_files/Munro_mapping.RDS&quot;)
mapping_two &lt;- rbind(mapping_predictdb,mapping_munro)

load(&quot;/project2/xinhe/shared_data/multigroup_ctwas/gwas/samplesize.rdata&quot;)


colors &lt;- c(  &quot;#1f77b4&quot;, &quot;#ff7f0e&quot;, &quot;#2ca02c&quot;, &quot;#d62728&quot;,  &quot;#9467bd&quot;, &quot;#8c564b&quot;, &quot;#e377c2&quot;, &quot;#7f7f7f&quot;,  &quot;#bcbd22&quot;,  &quot;#17becf&quot;,  &quot;#f7b6d2&quot;,  &quot;#c5b0d5&quot;,  &quot;#9edae5&quot;, &quot;#ffbb78&quot;,  &quot;#98df8a&quot;,  &quot;#ff9896&quot; )

plot_piechart &lt;- function(ctwas_parameters, colors, by) {
  # Create the initial data frame
  data &lt;- data.frame(
    category = names(ctwas_parameters$prop_heritability),
    percentage = ctwas_parameters$prop_heritability
  )
  
  # Split the category into context and type
  data &lt;- data %&gt;%
    mutate(
      context = sub(&quot;\\|.*&quot;, &quot;&quot;, category),
      type = sub(&quot;.*\\|&quot;, &quot;&quot;, category)
    )
  
  # Aggregate the data based on the &#39;by&#39; parameter
  if (by == &quot;type&quot;) {
    data &lt;- data %&gt;%
      group_by(type) %&gt;%
      summarize(percentage = sum(percentage)) %&gt;%
      mutate(category = type)  # Use type as the new category
  } else if (by == &quot;context&quot;) {
    data &lt;- data %&gt;%
      group_by(context) %&gt;%
      summarize(percentage = sum(percentage)) %&gt;%
      mutate(category = context)  # Use context as the new category
  } else {
    stop(&quot;Invalid &#39;by&#39; parameter. Use &#39;type&#39; or &#39;context&#39;.&quot;)
  }
  
  # Calculate percentage labels for the chart
  data$percentage_label &lt;- paste0(round(data$percentage * 100, 1), &quot;%&quot;)
  
  # Create the pie chart
  pie &lt;- ggplot(data, aes(x = &quot;&quot;, y = percentage, fill = category)) +
    geom_bar(stat = &quot;identity&quot;, width = 1) +
    coord_polar(&quot;y&quot;, start = 0) +
    theme_void() +  # Remove background and axes
    geom_text(aes(label = percentage_label), 
              position = position_stack(vjust = 0.5), size = 3) +  # Adjust size as needed
    scale_fill_manual(values = colors) +  # Custom colors
    labs(fill = &quot;Category&quot;) +  # Legend title
    ggtitle(&quot;Percent of Heritability&quot;)  # Title
  
  return(pie)
}

draw_gene_piechart_type &lt;- function(data, colors) {
  # Filter data based on combined_pip
  data &lt;- data[data$combined_pip &gt; 0.8, ]
  
  # Count occurrences by eQTL, sQTL, and stQTL
  byeQTL &lt;- nrow(data[data$eQTL_pip / data$combined_pip &gt; 0.8, ])
  bysQTL &lt;- nrow(data[data$sQTL_pip / data$combined_pip &gt; 0.8, ])
  bystQTL &lt;- nrow(data[data$stQTL_pip / data$combined_pip &gt; 0.8, ])
  
  # Count occurrences for combined sQTL and stQTL
  bysQTLstQTL &lt;- nrow(data[((data$stQTL_pip + data$sQTL_pip) / data$combined_pip) &gt; 0.8 &amp;
                             data$stQTL_pip / data$combined_pip &lt; 0.8 &amp;
                             data$sQTL_pip / data$combined_pip &lt; 0.8, ])
  
  # Count unspecified
  unspecified &lt;- nrow(data) - byeQTL - bysQTL - bystQTL - bysQTLstQTL
  
  # Create vectors for plotting
  n &lt;- c(byeQTL, bysQTL, bystQTL, bysQTLstQTL, unspecified)
  prop &lt;- round(n / nrow(data), 3)
  labels = c(&quot;by eQTL&quot;, &quot;by sQTL&quot;, &quot;by stQTL&quot;, &quot;by sQTL+stQTL&quot;, &quot;unspecified&quot;)
  lab.ypos = cumsum(prop) - 0.5 * prop
  
  # Prepare the data frame for plotting
  df &lt;- data.frame(&quot;n&quot; = n,
                   &quot;class&quot; = labels,
                   &quot;prop&quot; = prop,
                   &quot;lab.ypos&quot; = lab.ypos)
  
  # Generate the pie chart
  ggplot(df, aes(x = &quot;&quot;, y = prop, fill = class)) +
    geom_bar(width = 1, stat = &quot;identity&quot;, color = &quot;white&quot;) +
    coord_polar(&quot;y&quot;, start = 0) +
    geom_text(aes(label = n),
              position = position_stack(vjust = 0.5)) +
    scale_fill_manual(values = colors) +  # Ensure &#39;palette&#39; is defined
    theme_void()
}

draw_gene_piechart_tissue &lt;- function(data, colors){
  
  data &lt;- data[data$combined_pip&gt;0.8,]
  tissues &lt;- colnames(data)[3:7]
  tissues &lt;- sub(&quot;_pip$&quot;, &quot;&quot;, tissues)
  colnames(data)[3:7] &lt;- paste0(&quot;tissue&quot;,c(1:5))
  
  
  bytissue1 &lt;- nrow(data[data$tissue1/data$combined_pip&gt;0.8,])
  bytissue2 &lt;- nrow(data[data$tissue2/data$combined_pip&gt;0.8,])
  bytissue3 &lt;- nrow(data[data$tissue3/data$combined_pip&gt;0.8,])
  bytissue4 &lt;- nrow(data[data$tissue4/data$combined_pip&gt;0.8,])
  bytissue5 &lt;- nrow(data[data$tissue5/data$combined_pip&gt;0.8,])
  unspecified &lt;- nrow(data)-bytissue1-bytissue2-bytissue3-bytissue4-bytissue5
  
  n &lt;- c(bytissue1,bytissue2,bytissue3,bytissue4,bytissue5,unspecified)
  
  prop &lt;- round(n/nrow(data),3)
  labels = c(tissues,&quot;unspecified&quot;)
  lab.ypos = cumsum(prop) - 0.5*prop
  df &lt;- data.frame(&quot;n&quot; = n,
                   &quot;class&quot; = labels,
                   &quot;prop&quot; = prop,
                   &quot;lab.ypos&quot; = lab.ypos)
  p &lt;- ggplot(df, aes(x = &quot;&quot;, y = prop, fill = class)) +
    geom_bar(width = 1, stat = &quot;identity&quot;, color = &quot;white&quot;) +
    coord_polar(&quot;y&quot;, start = 0)+
    geom_text(aes(label = n),
              position = position_stack(vjust = 0.5))+
    scale_fill_manual(values = colors) +
    theme_void()
  
  return(p)
}

plot_heatmap &lt;- function(heatmap_data, main) {
  
  rownames(heatmap_data) &lt;- heatmap_data$gene_name
  heatmap_data &lt;- heatmap_data %&gt;% dplyr::select(-gene_name, -combined_pip)
  
  if(nrow(heatmap_data) ==1){
    
    heatmap_data &lt;- rbind(heatmap_data,rep(0,ncol(heatmap_data)))
    rownames(heatmap_data)[2] &lt;- &quot;fake_gene_for_plotting&quot;
    
  }
  
  heatmap_matrix &lt;- as.matrix(heatmap_data)
  
  p &lt;- pheatmap(heatmap_matrix,
                cluster_rows = F,   # Cluster the rows (genes)
                cluster_cols = F,   # Cluster the columns (QTL types)
                color = colorRampPalette(c(&quot;white&quot;, &quot;red&quot;))(50), # Color gradient
                display_numbers = TRUE, # Display numbers in cells
                main = main,labels_row = rownames(heatmap_data), silent = T)
  
  return(p)
}</code></pre>
</div>
</div>
<div id="afib-ebi-a-gcst006414" class="section level1">
<h1>aFib-ebi-a-GCST006414</h1>
<div id="parameters" class="section level2">
<h2>Parameters</h2>
<pre class="r"><code>trait &lt;- &quot;aFib-ebi-a-GCST006414&quot;
gwas_n &lt;- samplesize[trait]
tissue &lt;- c(&quot;Heart_Atrial_Appendage&quot;,&quot;Artery_Tibial&quot;,&quot;Muscle_Skeletal&quot;,&quot;Stomach&quot;,&quot;Thyroid&quot;)

results_dir_multi &lt;- paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/results/&quot;,trait,&quot;/&quot;)
ctwas_res_multi &lt;- readRDS(paste0(results_dir_multi,trait,&quot;.ctwas.res.RDS&quot;))

param_multi &lt;- ctwas_res_multi$param
make_convergence_plots(param_multi, gwas_n, colors = colors)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-2-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-2-1">
Past versions of unnamed-chunk-2-1.png
</button>
</p>
<div id="fig-unnamed-chunk-2-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/4a84d72e7453cf3617b2b5a0fdd798d0595620e2/docs/figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-2-1.png" target="_blank">4a84d72</a>
</td>
<td>
XSun
</td>
<td>
2024-10-15
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>ctwas_parameters_multi &lt;- summarize_param(param_multi, gwas_n)
pve_pie_by_type_multi &lt;- plot_piechart(ctwas_parameters = ctwas_parameters_multi, colors = colors, by = &quot;type&quot;)
pve_pie_by_context_multi &lt;- plot_piechart(ctwas_parameters = ctwas_parameters_multi, colors = colors, by = &quot;context&quot;)

gridExtra::grid.arrange(pve_pie_by_type_multi,pve_pie_by_context_multi, ncol = 2)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-3-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-3-1">
Past versions of unnamed-chunk-3-1.png
</button>
</p>
<div id="fig-unnamed-chunk-3-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/4a84d72e7453cf3617b2b5a0fdd798d0595620e2/docs/figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-3-1.png" target="_blank">4a84d72</a>
</td>
<td>
XSun
</td>
<td>
2024-10-15
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="fine-mapping" class="section level2">
<h2>Fine-mapping</h2>
<pre class="r"><code>susie_alpha_res_multi &lt;- ctwas_res_multi$susie_alpha_res

susie_alpha_res_multi &lt;- anno_susie_alpha_res(susie_alpha_res_multi,
                                        mapping_table = mapping_two,
                                        map_by = &quot;molecular_id&quot;,
                                        drop_unmapped = TRUE)</code></pre>
<pre><code>2024-10-16 11:02:57 INFO::Annotating susie alpha result ...
2024-10-16 11:02:57 INFO::Map molecular traits to genes
2024-10-16 11:03:00 INFO::Split PIPs for molecular traits mapped to multiple genes</code></pre>
<pre class="r"><code>combined_pip_by_type_cs_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;type&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = T)

combined_pip_by_context_cs_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;context&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = T)

DT::datatable(combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$combined_pip&gt;0.8,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Combined PIP by omics&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-4de263013227ca78a293" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-4de263013227ca78a293">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Combined PIP by omics<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71"],["AGAP5","MYOZ1","TPST1","ASAH1","PCM1","SYNPO2L","HIP1R","MAPT","PRRX1","SIDT2","CAV1","KCTD7","FAM13B","TBX5","NACA","PITX3","LINC01314","GBF1","CEP85L","CEP68","GMCL1","CCND2","AKAP6","DPF3","WIPF1","NKX2-5","KLF12","PXN","AKAP12","JAM2","GNA12","FAM43A","PHLDB2","CCT2","IL6R","RBM20","NCOR2","CFL2","PCCB","GNB4","FLNC","SCN10A","PLEC","DEK","GYPC","JMJD1C","MXD1","PALMD","CAMK2D","SEC23IP","BRD8","SGK1","ZBTB38","TNFSF13","CASQ2","XPO7","RUFY3","GALK2","POPDC3","MTSS1","PGP","DTNA","PSMB7","PKP2","C5orf47","GLTSCR1","SUN1","SF3B1","RPL3L","SNU13","VPS13A"],["10_73662792_76947056.L1","10_71748755_73662792.L1","7_66224822_68769087.L1","8_17978890_19635329.L1","8_17530367_17978890.L1,8_17978890_19635329.L2,8_17978890_19635329.L5,8_17978890_19635329.L3,8_17978890_19635329.L4","10_71748755_73662792.L4","12_121569746_124493434.L1,12_121569746_124493434.L4","17_44979537_47798656.L1,L3,17_44979537_47798656.L3","1_170588635_173128768.L1","11_116512631_117876395.L2,11_116512631_117876395.L3,L1,11_116512631_117876395.L3","7_114072332_117140124.L1","7_66224822_68769087.L2","5_137040361_139885487.L1","12_113548904_114598797.L1","12_55272053_57155077.L1","10_101189482_102620653.L3","15_78223711_80568637.L1","10_101189482_102620653.L1","6_118641952_119642117.L1","2_64398779_65706310.L1","2_68912432_70528066.L1","12_3567871_4308513.L1","14_31914059_34377045.L1","14_72422907_75978424.L1","2_172274177_174724201.L1","5_171647288_173251324.L1","13_73359952_75096006.L1","12_119316305_121569746.L1","6_149932268_151591568.L1","21_25096809_25898707.L1","7_2022763_2732593.L1,7_2732593_4533797.L1","3_195065945_196244537.L1","3_110794923_113096852.L3","12_69432762_70564207.L1","1_153208353_154797927.L2","10_110801735_113568673.L1","12_121569746_124493434.L2","14_34377045_35390387.L1","3_135738064_137652241.L1,3_135738064_137652241.L3,L1","3_178389377_179656798.L1","7_127229167_129138332.L1","3_38314625_40179807.L1","8_143155464_145078481.L1","6_17386174_19207256.L1","2_126616187_127276771.L1","10_61581937_64034354.L3,L1","2_68912432_70528066.L3","1_99335048_100360849.L1","4_112948946_114745090.L1","10_118831841_120647811.L1","5_137040361_139885487.L2","6_133923105_135903039.L1","3_140235755_141620255.L1","17_7414079_8403107.L1","1_115337972_118296444.L1","8_21804225_23039544.L1","4_70183435_71274841.L1","15_47843851_49715846.L3,L1","6_103535520_105608858.L1","8_124671478_125398675.L1","16_1157206_2714828.L3","18_34200103_36282001.L1","9_124209608_126297386.L1","12_32012658_32924055.L1","5_173251324_174215868.L1","19_46646825_48778970.L1","7_16161_933116.L1","2_197213386_198446401.L1","16_1157206_2714828.L2","22_40149793_42294812.L1","9_76856292_78464139.L1"],[1,1,1,0.99999999999998,0.999999999990425,0.99999999981699,0.999999999493759,0.999999996802596,0.999999966266706,0.999996175977312,0.999995683949449,0.999756678375545,0.999635777704542,0.999556717462967,0.999536516607005,0.999041866352672,0.998265616962052,0.998222583079958,0.99788975818086,0.997157704853587,0.996241187755607,0.995802968953797,0.99529313801543,0.993849336365392,0.992599127695796,0.986907063825664,0.98606549972159,0.985355544303842,0.981350417231595,0.981184625638015,0.975650226939238,0.975371649058748,0.973388650077988,0.972210233205577,0.971453829574038,0.970862030458149,0.968075745496112,0.967924913674015,0.967719956098818,0.967309687633714,0.966757272453023,0.962155965021677,0.960106001031392,0.960007175721292,0.95912017366627,0.956866811042016,0.955074494139947,0.952684361608155,0.952637008982735,0.951021441413128,0.945326804872344,0.944520555914077,0.94367764788844,0.936875517709587,0.936532859908825,0.930059575048099,0.921609700518519,0.917503486751562,0.916755617247168,0.911630141124176,0.911583374482423,0.901707692189325,0.896944125629772,0.890998496247742,0.87633373912725,0.866147866946081,0.838435488128224,0.812295481274371,0.809885460072066,0.804093380196379,0.803716833774922],["10_73662792_76947056.L1",null,null,null,"8_17530367_17978890.L1",null,null,null,"1_170588635_173128768.L1","11_116512631_117876395.L2","7_114072332_117140124.L1","7_66224822_68769087.L2",null,null,null,"10_101189482_102620653.L3","15_78223711_80568637.L1",null,"6_118641952_119642117.L1",null,null,"12_3567871_4308513.L1","14_31914059_34377045.L1","14_72422907_75978424.L1","2_172274177_174724201.L1","5_171647288_173251324.L1","13_73359952_75096006.L1","12_119316305_121569746.L1",null,"21_25096809_25898707.L1","7_2732593_4533797.L1","3_195065945_196244537.L1",null,"12_69432762_70564207.L1",null,null,null,"14_34377045_35390387.L1","3_135738064_137652241.L1,3_135738064_137652241.L3,L1","3_178389377_179656798.L1","7_127229167_129138332.L1","3_38314625_40179807.L1",null,"6_17386174_19207256.L1","2_126616187_127276771.L1","10_61581937_64034354.L3,L1","2_68912432_70528066.L3","1_99335048_100360849.L1",null,"10_118831841_120647811.L1",null,"6_133923105_135903039.L1","3_140235755_141620255.L1","17_7414079_8403107.L1","1_115337972_118296444.L1",null,"4_70183435_71274841.L1",null,"6_103535520_105608858.L1","8_124671478_125398675.L1","16_1157206_2714828.L3",null,"9_124209608_126297386.L1","12_32012658_32924055.L1","5_173251324_174215868.L1","19_46646825_48778970.L1",null,"2_197213386_198446401.L1","16_1157206_2714828.L2","22_40149793_42294812.L1","9_76856292_78464139.L1"],[1,null,null,null,0.0407982430677564,null,null,null,0.999999966266706,0.99826041544968,0.0969118643927329,0.999756678375545,null,null,null,0.999041866352672,0.998265616962052,null,0.99788975818086,null,null,0.995802968953797,0.99529313801543,0.993849336365392,0.992599127695796,0.946763415978181,0.98606549972159,0.985355544303842,null,0.981184625638015,0.194705114810822,0.975371649058748,null,0.972210233205577,null,null,null,0.944807942142093,0.113925612019709,0.416404361653167,0.966757272453023,0.962155965021677,null,0.960007175721292,0.95912017366627,0.956866811042016,0.955074494139947,0.0432574192680262,null,0.798545447600592,null,0.944520555914077,0.38793265981929,0.936875517709587,0.936532859908825,null,0.0686336134092341,null,0.916755617247168,0.911630141124176,0.911583374482423,null,0.896944125629772,0.890998496247742,0.87633373912725,0.866147866946081,null,0.67247139918736,0.809885460072066,0.804093380196379,0.00112890924904085],[null,null,null,null,"8_17530367_17978890.L1,8_17978890_19635329.L2","10_71748755_73662792.L4","12_121569746_124493434.L1,12_121569746_124493434.L4",null,null,"11_116512631_117876395.L3,L1,11_116512631_117876395.L3",null,null,"5_137040361_139885487.L1",null,null,null,null,"10_101189482_102620653.L1",null,"2_64398779_65706310.L1",null,null,null,null,null,"5_171647288_173251324.L1",null,null,null,null,"7_2732593_4533797.L1",null,"3_110794923_113096852.L3",null,"1_153208353_154797927.L2","10_110801735_113568673.L1","12_121569746_124493434.L2",null,null,null,null,null,"8_143155464_145078481.L1",null,null,null,null,"1_99335048_100360849.L1","4_112948946_114745090.L1","10_118831841_120647811.L1",null,null,"3_140235755_141620255.L1",null,null,"8_21804225_23039544.L1",null,"15_47843851_49715846.L3,L1",null,null,null,"18_34200103_36282001.L1",null,null,null,null,"7_16161_933116.L1","2_197213386_198446401.L1",null,null,"9_76856292_78464139.L1"],[null,null,null,null,0.960209152588626,0.99999999981699,0.999999999493759,null,null,0.997801760949396,null,null,0.999635777704542,null,null,null,null,0.998222583079958,null,0.997157704853587,null,null,null,null,null,0.0402544935590698,null,null,null,null,0.0183586580366328,null,0.973388650077988,null,0.971453829574038,0.970862030458149,0.968075745496112,null,null,null,null,null,0.960106001031392,null,null,null,null,0.833372675426802,0.952637008982735,0.152475993812536,null,null,0.526835224623618,null,null,0.930059575048099,null,0.917503486751562,null,null,null,0.901707692189325,null,null,null,null,0.838435488128224,0.163313943922692,null,null,0.292734743558122],[null,"10_71748755_73662792.L1","7_66224822_68769087.L1","8_17978890_19635329.L1","8_17978890_19635329.L5,8_17978890_19635329.L3,8_17978890_19635329.L4",null,null,"17_44979537_47798656.L1,L3,17_44979537_47798656.L3",null,null,"7_114072332_117140124.L1",null,null,"12_113548904_114598797.L1","12_55272053_57155077.L1",null,null,null,null,null,"2_68912432_70528066.L1",null,null,null,null,null,null,null,"6_149932268_151591568.L1",null,"7_2022763_2732593.L1",null,null,null,null,null,null,"14_34377045_35390387.L1","3_135738064_137652241.L3,L1","3_178389377_179656798.L1",null,null,null,null,null,null,null,"1_99335048_100360849.L1",null,null,"5_137040361_139885487.L2",null,"3_140235755_141620255.L1",null,null,null,"4_70183435_71274841.L1",null,null,null,null,null,null,null,null,null,null,null,null,null,"9_76856292_78464139.L1"],[null,1,1,0.99999999999998,0.999999999506957,null,null,0.999999996802596,null,null,0.903083819556716,null,null,0.999556717462967,0.999536516607005,null,null,null,null,null,0.996241187755607,null,null,null,null,null,null,null,0.981350417231595,null,0.969057501458703,null,null,null,null,null,null,0.0231169715319216,0.908315664858762,0.550905325980547,null,null,null,null,null,null,null,0.0760542669133267,null,null,0.945326804872344,null,0.028909763445532,null,null,null,0.852976087109285,null,null,null,null,null,null,null,null,null,null,null,null,null,0.50985318096776]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_cs_id<\/th>\n      <th>eQTL_pip<\/th>\n      <th>sQTL_cs_id<\/th>\n      <th>sQTL_pip<\/th>\n      <th>stQTL_cs_id<\/th>\n      <th>stQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>DT::datatable(combined_pip_by_context_cs_multi[combined_pip_by_context_cs_multi$combined_pip&gt;0.8,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Combined PIP by tissue&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-20575149739a71fc930f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-20575149739a71fc930f">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Combined PIP by tissue<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71"],["AGAP5","MYOZ1","TPST1","ASAH1","PCM1","SYNPO2L","HIP1R","MAPT","PRRX1","SIDT2","CAV1","KCTD7","FAM13B","TBX5","NACA","PITX3","LINC01314","GBF1","CEP85L","CEP68","GMCL1","CCND2","AKAP6","DPF3","WIPF1","NKX2-5","KLF12","PXN","AKAP12","JAM2","GNA12","FAM43A","PHLDB2","CCT2","IL6R","RBM20","NCOR2","CFL2","PCCB","GNB4","FLNC","SCN10A","PLEC","DEK","GYPC","JMJD1C","MXD1","PALMD","CAMK2D","SEC23IP","BRD8","SGK1","ZBTB38","TNFSF13","CASQ2","XPO7","RUFY3","GALK2","POPDC3","MTSS1","PGP","DTNA","PSMB7","PKP2","C5orf47","GLTSCR1","SUN1","SF3B1","RPL3L","SNU13","VPS13A"],["10_73662792_76947056.L1","10_71748755_73662792.L1","7_66224822_68769087.L1","8_17978890_19635329.L1","8_17530367_17978890.L1,8_17978890_19635329.L2,8_17978890_19635329.L5,8_17978890_19635329.L3,8_17978890_19635329.L4","10_71748755_73662792.L4","12_121569746_124493434.L1,12_121569746_124493434.L4","17_44979537_47798656.L1,L3,17_44979537_47798656.L3","1_170588635_173128768.L1","11_116512631_117876395.L2,11_116512631_117876395.L3,L1,11_116512631_117876395.L3","7_114072332_117140124.L1","7_66224822_68769087.L2","5_137040361_139885487.L1","12_113548904_114598797.L1","12_55272053_57155077.L1","10_101189482_102620653.L3","15_78223711_80568637.L1","10_101189482_102620653.L1","6_118641952_119642117.L1","2_64398779_65706310.L1","2_68912432_70528066.L1","12_3567871_4308513.L1","14_31914059_34377045.L1","14_72422907_75978424.L1","2_172274177_174724201.L1","5_171647288_173251324.L1","13_73359952_75096006.L1","12_119316305_121569746.L1","6_149932268_151591568.L1","21_25096809_25898707.L1","7_2022763_2732593.L1,7_2732593_4533797.L1","3_195065945_196244537.L1","3_110794923_113096852.L3","12_69432762_70564207.L1","1_153208353_154797927.L2","10_110801735_113568673.L1","12_121569746_124493434.L2","14_34377045_35390387.L1","3_135738064_137652241.L1,3_135738064_137652241.L3,L1","3_178389377_179656798.L1","7_127229167_129138332.L1","3_38314625_40179807.L1","8_143155464_145078481.L1","6_17386174_19207256.L1","2_126616187_127276771.L1","10_61581937_64034354.L3,L1","2_68912432_70528066.L3","1_99335048_100360849.L1","4_112948946_114745090.L1","10_118831841_120647811.L1","5_137040361_139885487.L2","6_133923105_135903039.L1","3_140235755_141620255.L1","17_7414079_8403107.L1","1_115337972_118296444.L1","8_21804225_23039544.L1","4_70183435_71274841.L1","15_47843851_49715846.L3,L1","6_103535520_105608858.L1","8_124671478_125398675.L1","16_1157206_2714828.L3","18_34200103_36282001.L1","9_124209608_126297386.L1","12_32012658_32924055.L1","5_173251324_174215868.L1","19_46646825_48778970.L1","7_16161_933116.L1","2_197213386_198446401.L1","16_1157206_2714828.L2","22_40149793_42294812.L1","9_76856292_78464139.L1"],[1,1,1,0.99999999999998,0.999999999990425,0.99999999981699,0.999999999493759,0.999999996802596,0.999999966266706,0.999996175977312,0.999995683949449,0.999756678375545,0.999635777704542,0.999556717462967,0.999536516607005,0.999041866352672,0.998265616962052,0.998222583079958,0.99788975818086,0.997157704853587,0.996241187755607,0.995802968953797,0.99529313801543,0.993849336365392,0.992599127695796,0.986907063825664,0.98606549972159,0.985355544303842,0.981350417231595,0.981184625638015,0.975650226939238,0.975371649058748,0.973388650077988,0.972210233205577,0.971453829574038,0.970862030458149,0.968075745496112,0.967924913674015,0.967719956098818,0.967309687633714,0.966757272453023,0.962155965021677,0.960106001031392,0.960007175721292,0.95912017366627,0.956866811042016,0.955074494139947,0.952684361608155,0.952637008982735,0.951021441413128,0.945326804872344,0.944520555914077,0.94367764788844,0.936875517709587,0.936532859908825,0.930059575048099,0.921609700518519,0.917503486751562,0.916755617247168,0.911630141124176,0.911583374482423,0.901707692189325,0.896944125629772,0.890998496247742,0.87633373912725,0.866147866946081,0.838435488128224,0.812295481274371,0.809885460072066,0.804093380196379,0.803716833774922],["10_73662792_76947056.L1","10_71748755_73662792.L1",null,null,"8_17530367_17978890.L1,8_17978890_19635329.L3,8_17978890_19635329.L4","10_71748755_73662792.L4","12_121569746_124493434.L1",null,"1_170588635_173128768.L1","11_116512631_117876395.L2,11_116512631_117876395.L3,L1","7_114072332_117140124.L1",null,"5_137040361_139885487.L1","12_113548904_114598797.L1","12_55272053_57155077.L1","10_101189482_102620653.L3","15_78223711_80568637.L1",null,null,null,null,"12_3567871_4308513.L1","14_31914059_34377045.L1","14_72422907_75978424.L1","2_172274177_174724201.L1","5_171647288_173251324.L1","13_73359952_75096006.L1","12_119316305_121569746.L1",null,"21_25096809_25898707.L1","7_2732593_4533797.L1","3_195065945_196244537.L1","3_110794923_113096852.L3",null,null,"10_110801735_113568673.L1","12_121569746_124493434.L2",null,"3_135738064_137652241.L3,L1","3_178389377_179656798.L1",null,"3_38314625_40179807.L1",null,"6_17386174_19207256.L1","2_126616187_127276771.L1",null,null,"1_99335048_100360849.L1","4_112948946_114745090.L1","10_118831841_120647811.L1",null,null,"3_140235755_141620255.L1","17_7414079_8403107.L1","1_115337972_118296444.L1","8_21804225_23039544.L1","4_70183435_71274841.L1","15_47843851_49715846.L3,L1","6_103535520_105608858.L1","8_124671478_125398675.L1","16_1157206_2714828.L3","18_34200103_36282001.L1","9_124209608_126297386.L1","12_32012658_32924055.L1","5_173251324_174215868.L1","19_46646825_48778970.L1",null,"2_197213386_198446401.L1",null,null,"9_76856292_78464139.L1"],[1,1,null,null,0.999999993651747,0.99999999981699,0.169628077069523,null,0.999999966266706,0.863602314175497,0.0969118643927329,null,0.999635777704542,0.999556717462967,0.887241553259687,0.799980066838685,0.998265616962052,null,null,null,null,0.692765933680599,0.99529313801543,0.993849336365392,0.992599127695796,0.855330367754369,0.98606549972159,0.842298567646028,null,0.860660415172642,0.0560007767240204,0.975371649058748,0.973388650077988,null,null,0.28512774185566,0.126870754249196,null,0.908315664858762,0.691517686769626,null,0.962155965021677,null,0.960007175721292,0.95912017366627,null,null,0.0117023999179243,0.0232259252458609,0.785433256960332,null,null,0.368801994390072,0.936875517709587,0.0248748668618906,0.12938222341987,0.852976087109285,0.164555204791066,0.633850970367898,0.640580595271782,0.685465001994609,0.0665262032409544,0.892267817478206,0.890998496247742,0.87633373912725,0.866147866946081,null,0.446811958091191,null,null,0.0378284958446085],[null,null,"7_66224822_68769087.L1",null,"8_17530367_17978890.L1,8_17978890_19635329.L2",null,"12_121569746_124493434.L1","17_44979537_47798656.L1,L3",null,"11_116512631_117876395.L2,11_116512631_117876395.L3,L1",null,"7_66224822_68769087.L2",null,null,"12_55272053_57155077.L1",null,null,null,"6_118641952_119642117.L1",null,"2_68912432_70528066.L1",null,null,null,null,null,null,"12_119316305_121569746.L1",null,"21_25096809_25898707.L1","7_2022763_2732593.L1,7_2732593_4533797.L1",null,null,null,null,null,"12_121569746_124493434.L2","14_34377045_35390387.L1","3_135738064_137652241.L1",null,null,null,"8_143155464_145078481.L1",null,null,"10_61581937_64034354.L3,L1",null,null,null,"10_118831841_120647811.L1","5_137040361_139885487.L2","6_133923105_135903039.L1","3_140235755_141620255.L1",null,"1_115337972_118296444.L1","8_21804225_23039544.L1",null,null,"6_103535520_105608858.L1",null,"16_1157206_2714828.L3","18_34200103_36282001.L1",null,null,null,null,null,"2_197213386_198446401.L1",null,null,"9_76856292_78464139.L1"],[null,null,1,null,0.29328395669207,null,0.135322784747258,0.999706568734241,null,0.208936621165895,null,0.306977997436583,null,null,0.112294963347318,null,null,null,0.99788975818086,null,0.996241187755607,null,null,null,null,null,null,0.143056976657814,null,0.0564288430800528,0.973431021579085,null,null,null,null,null,0.0453350961199651,0.0231169715319216,0.0441485815030136,null,null,null,0.0534555092787011,null,null,0.956866811042016,null,null,null,0.0368892752212929,0.945326804872344,0.944520555914077,0.123343014569855,null,0.877207246010437,0.0164607278117523,null,null,0.107653992248698,null,0.115424437240531,0.022687486708334,null,null,null,null,null,0.0822712144700657,null,null,0.064153217423507],[null,null,null,null,"8_17530367_17978890.L1",null,"12_121569746_124493434.L1,12_121569746_124493434.L4","17_44979537_47798656.L3",null,"11_116512631_117876395.L3,L1","7_114072332_117140124.L1","7_66224822_68769087.L2",null,null,null,"10_101189482_102620653.L3",null,"10_101189482_102620653.L1",null,"2_64398779_65706310.L1",null,"12_3567871_4308513.L1",null,null,null,null,null,null,null,null,"7_2732593_4533797.L1",null,null,"12_69432762_70564207.L1","1_153208353_154797927.L2","10_110801735_113568673.L1","12_121569746_124493434.L2","14_34377045_35390387.L1","3_135738064_137652241.L3,L1","3_178389377_179656798.L1",null,null,"8_143155464_145078481.L1",null,null,null,"2_68912432_70528066.L3","1_99335048_100360849.L1","4_112948946_114745090.L1","10_118831841_120647811.L1",null,null,"3_140235755_141620255.L1",null,null,"8_21804225_23039544.L1","4_70183435_71274841.L1","15_47843851_49715846.L3,L1","6_103535520_105608858.L1",null,null,"18_34200103_36282001.L1",null,null,null,null,"7_16161_933116.L1","2_197213386_198446401.L1","16_1157206_2714828.L2","22_40149793_42294812.L1","9_76856292_78464139.L1"],[null,null,null,null,0.0407982430677564,null,0.968911408759166,0.487285615182449,null,0.981392774259941,0.903083819556716,0.692778680938963,null,null,null,0.199632981264222,null,0.998222583079958,null,0.997157704853587,null,0.191696491490827,null,null,null,null,null,null,null,null,0.011900484917624,null,null,0.972210233205577,0.971453829574038,0.686883293135733,0.768991412309478,0.944807942142093,0.0713697361121534,0.17355799142977,null,null,0.906660062230693,null,null,null,0.955074494139947,0.863284011234873,0.929411083736874,0.125136141186717,null,null,0.451532638928513,null,null,0.784216623816476,0.0392550570290315,0.822188308670509,0.175250654630573,null,null,0.816319623351101,null,null,null,null,0.838435488128224,0.24797704104492,0.809885460072066,0.804093380196379,0.234751887898913],[null,null,null,null,"8_17530367_17978890.L1,8_17978890_19635329.L2,8_17978890_19635329.L5",null,"12_121569746_124493434.L1,12_121569746_124493434.L4",null,null,"11_116512631_117876395.L3",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"6_149932268_151591568.L1",null,null,null,null,null,null,null,"12_121569746_124493434.L2",null,null,null,null,null,null,null,null,null,null,"1_99335048_100360849.L1",null,"10_118831841_120647811.L1",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2_197213386_198446401.L1",null,null,"9_76856292_78464139.L1"],[null,null,null,null,0.98307066988295,null,0.380969666599475,null,null,0.029988298634263,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.981350417231595,null,null,null,null,null,null,null,0.0268802015402138,null,null,null,null,null,null,null,null,null,null,0.0643518669954024,null,0.00356276804478617,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.00463071586519648,null,null,0.466145966769516],[null,null,null,"8_17978890_19635329.L1",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"12_3567871_4308513.L1",null,null,null,"5_171647288_173251324.L1",null,null,null,"21_25096809_25898707.L1","7_2732593_4533797.L1",null,null,null,null,null,null,null,null,"3_178389377_179656798.L1","7_127229167_129138332.L1",null,null,null,null,null,null,"1_99335048_100360849.L1",null,null,null,null,null,null,"1_115337972_118296444.L1",null,"4_70183435_71274841.L1",null,null,"8_124671478_125398675.L1","16_1157206_2714828.L3",null,"9_124209608_126297386.L1",null,null,null,null,"2_197213386_198446401.L1",null,null,"9_76856292_78464139.L1"],[null,null,null,0.99999999999998,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.112096991210012,null,null,null,0.131913141167501,null,null,null,0.0640953673853202,0.00381904100913022,null,null,null,null,null,null,null,null,0.102234009434318,0.966757272453023,null,null,null,null,null,null,0.0133460834599557,null,null,null,null,null,null,0.0344507470364971,null,0.0293785563802027,null,null,0.271049545852394,0.110837702748109,null,0.010209866340681,null,null,null,null,0.0710114383934024,null,null,0.000837265838377621]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>Heart_Atrial_Appendage_cs_id<\/th>\n      <th>Heart_Atrial_Appendage_pip<\/th>\n      <th>Artery_Tibial_cs_id<\/th>\n      <th>Artery_Tibial_pip<\/th>\n      <th>Muscle_Skeletal_cs_id<\/th>\n      <th>Muscle_Skeletal_pip<\/th>\n      <th>Stomach_cs_id<\/th>\n      <th>Stomach_pip<\/th>\n      <th>Thyroid_cs_id<\/th>\n      <th>Thyroid_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9,11,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>combined_pip_by_group_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;group&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = F)

combined_pip_by_group_sig_multi &lt;- combined_pip_by_group_multi[combined_pip_by_group_multi$combined_pip &gt; 0.8,]

plot_heatmap(heatmap_data = combined_pip_by_group_sig_multi, main = &quot;PIP partitions for genes with PIP&gt;0.8&quot;)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-4-3.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-4-3">
Past versions of unnamed-chunk-4-3.png
</button>
</p>
<div id="fig-unnamed-chunk-4-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/4a84d72e7453cf3617b2b5a0fdd798d0595620e2/docs/figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-4-3.png" target="_blank">4a84d72</a>
</td>
<td>
XSun
</td>
<td>
2024-10-15
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="comparing-with-single-tissue-eqtl-analysis"
class="section level2">
<h2>Comparing with single tissue + eQTL analysis</h2>
<pre class="r"><code>ctwas_res_single &lt;- readRDS(paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/10.single_tissue_1007/results/&quot;,trait,&quot;/&quot;,tissue[1],&quot;/&quot;,trait,&quot;_&quot;,tissue[1], &quot;.ctwas.res.RDS&quot;))

susie_alpha_res_single &lt;- ctwas_res_single$susie_alpha_res

susie_alpha_res_single &lt;- anno_susie_alpha_res(susie_alpha_res_single,
                                        mapping_table = mapping_predictdb,
                                        map_by = &quot;molecular_id&quot;,
                                        drop_unmapped = TRUE)</code></pre>
<pre><code>2024-10-16 11:03:11 INFO::Annotating susie alpha result ...
2024-10-16 11:03:11 INFO::Map molecular traits to genes</code></pre>
<pre class="r"><code>combined_pip_by_type_single &lt;- combine_gene_pips(susie_alpha_res_single, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;type&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = F)

combined_pip_by_type_sig_single &lt;- combined_pip_by_type_single[combined_pip_by_type_single$combined_pip &gt; 0.8,]
combined_pip_by_type_sig_multi &lt;- combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$combined_pip &gt; 0.8,]

sprintf(&quot;Number of genes with PIP &gt; 0.8  -- Multi-group = %s&quot;, nrow(combined_pip_by_type_sig_multi))</code></pre>
<pre><code>[1] &quot;Number of genes with PIP &gt; 0.8  -- Multi-group = 71&quot;</code></pre>
<pre class="r"><code>sprintf(&quot;Number of genes with PIP &gt; 0.8  -- single eQTL = %s&quot;, nrow(combined_pip_by_type_sig_single))</code></pre>
<pre><code>[1] &quot;Number of genes with PIP &gt; 0.8  -- single eQTL = 24&quot;</code></pre>
<pre class="r"><code>sprintf(&quot;Number of overlapped genes = %s&quot;, sum(combined_pip_by_type_sig_single$gene_name %in% combined_pip_by_type_sig_multi$gene_name))</code></pre>
<pre><code>[1] &quot;Number of overlapped genes = 23&quot;</code></pre>
<pre class="r"><code>genes_not_reported &lt;- combined_pip_by_type_sig_single$gene_name[!combined_pip_by_type_sig_single$gene_name %in%combined_pip_by_type_sig_multi$gene_name]

DT::datatable(combined_pip_by_type_sig_single[combined_pip_by_type_sig_single$gene_name %in% genes_not_reported,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Genes not reported by multi-group analysis&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-a23c348805048a1f64c7" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a23c348805048a1f64c7">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Genes not reported by multi-group analysis<\/caption>","data":[["15"],["DLEU1"],[0.934771264222148],[0.934771264222148]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>DT::datatable(combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$gene_name %in% genes_not_reported,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Genes not reported by multi-group analysis&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-93928d62269dcef60a51" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-93928d62269dcef60a51">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Genes not reported by multi-group analysis<\/caption>","data":[["98"],["DLEU1"],["13_48809826_51016955.L1"],[0.577127581910819],["13_48809826_51016955.L1"],[0.577127581910819],[null],[null],[null],[null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_cs_id<\/th>\n      <th>eQTL_pip<\/th>\n      <th>sQTL_cs_id<\/th>\n      <th>sQTL_pip<\/th>\n      <th>stQTL_cs_id<\/th>\n      <th>stQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>gene_multi_unique_type &lt;- combined_pip_by_group_sig_multi[!combined_pip_by_group_sig_multi$gene_name %in%  combined_pip_by_type_sig_single$gene_name,]

plot_heatmap(heatmap_data = gene_multi_unique_type, main = &quot;PIP partition for unique genes found by multi-group analysis&quot;)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-6-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-6-1">
Past versions of unnamed-chunk-6-1.png
</button>
</p>
<div id="fig-unnamed-chunk-6-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/4a84d72e7453cf3617b2b5a0fdd798d0595620e2/docs/figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-6-1.png" target="_blank">4a84d72</a>
</td>
<td>
XSun
</td>
<td>
2024-10-15
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>snp_map_single &lt;- readRDS(paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/10.single_tissue_1007/results/&quot;,trait,&quot;/&quot;,tissue[1],&quot;/&quot;,trait,&quot;_&quot;,tissue[1], &quot;.snp_map.RDS&quot;))
weights_single &lt;- readRDS(paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/10.single_tissue_1007/results/&quot;,trait,&quot;/&quot;,tissue[1],&quot;/&quot;,trait,&quot;_&quot;,tissue[1], &quot;.preprocessed.weights.RDS&quot;))

finemap_res_single &lt;- ctwas_res_single$finemap_res
finemap_res_single$molecular_id &lt;- get_molecular_ids(finemap_res_single)
finemap_res_single &lt;- anno_finemap_res(finemap_res_single,
                                snp_map = snp_map_single,
                                mapping_table = mapping_two,
                                add_gene_annot = TRUE,
                                map_by = &quot;molecular_id&quot;,
                                drop_unmapped = TRUE,
                                add_position = TRUE,
                                use_gene_pos = &quot;mid&quot;)</code></pre>
<pre><code>2024-10-16 11:03:40 INFO::Annotating fine-mapping result ...
2024-10-16 11:03:48 INFO::Map molecular traits to genes
2024-10-16 11:03:54 INFO::Add gene positions
2024-10-16 11:03:55 INFO::Add SNP positions</code></pre>
<pre class="r"><code>make_locusplot(finemap_res_single,
               region_id = &quot;13_48809826_51016955&quot;,
               ens_db = ens_db,
               weights = weights_single,
               highlight_pip = 0.8,
               filter_protein_coding_genes = TRUE,
               filter_cs = TRUE,
               color_pval_by = &quot;cs&quot;,
               color_pip_by = &quot;cs&quot;)</code></pre>
<pre><code>2024-10-16 11:04:10 INFO::Limit to protein coding genes
2024-10-16 11:04:10 INFO::focal id: ENSG00000176124.11|Heart_Atrial_Appendage_eQTL
2024-10-16 11:04:10 INFO::focal molecular trait: DLEU1 Heart_Atrial_Appendage eQTL
2024-10-16 11:04:10 INFO::Range of locus: chr13:48809898-51016397
2024-10-16 11:04:10 INFO::focal molecular trait QTL positions: 50081853
2024-10-16 11:04:10 INFO::Limit PIPs to credible sets</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-7-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-7-1">
Past versions of unnamed-chunk-7-1.png
</button>
</p>
<div id="fig-unnamed-chunk-7-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/4a84d72e7453cf3617b2b5a0fdd798d0595620e2/docs/figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-7-1.png" target="_blank">4a84d72</a>
</td>
<td>
XSun
</td>
<td>
2024-10-15
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>snp_map_multi &lt;- readRDS(paste0(results_dir_multi,trait,&quot;.snp_map.RDS&quot;))
weights_multi &lt;- readRDS(paste0(results_dir_multi,trait,&quot;.preprocessed.weights.RDS&quot;))

finemap_res_multi &lt;- ctwas_res_multi$finemap_res
finemap_res_multi$molecular_id &lt;- get_molecular_ids(finemap_res_multi)
finemap_res_multi &lt;- anno_finemap_res(finemap_res_multi,
                                snp_map = snp_map_multi,
                                mapping_table = mapping_two,
                                add_gene_annot = TRUE,
                                map_by = &quot;molecular_id&quot;,
                                drop_unmapped = TRUE,
                                add_position = TRUE,
                                use_gene_pos = &quot;mid&quot;)</code></pre>
<pre><code>2024-10-16 11:04:30 INFO::Annotating fine-mapping result ...
2024-10-16 11:04:30 INFO::Map molecular traits to genes
2024-10-16 11:04:31 INFO::Split PIPs for molecular traits mapped to multiple genes
2024-10-16 11:04:36 INFO::Add gene positions
2024-10-16 11:04:36 INFO::Add SNP positions</code></pre>
<pre class="r"><code>make_locusplot(finemap_res_multi,
               region_id = &quot;13_48809826_51016955&quot;,
               ens_db = ens_db,
               weights = weights_multi,
               highlight_pip = 0.8,
               filter_protein_coding_genes = TRUE,
               filter_cs = TRUE,
               color_pval_by = &quot;cs&quot;,
               color_pip_by = &quot;cs&quot;)</code></pre>
<pre><code>2024-10-16 11:04:47 INFO::Limit to protein coding genes
2024-10-16 11:04:47 INFO::focal id: ENSG00000176124.11|Heart_Atrial_Appendage_eQTL
2024-10-16 11:04:47 INFO::focal molecular trait: DLEU1 Heart_Atrial_Appendage eQTL
2024-10-16 11:04:47 INFO::Range of locus: chr13:48809898-51016397
2024-10-16 11:04:47 INFO::focal molecular trait QTL positions: 50081853
2024-10-16 11:04:47 INFO::Limit PIPs to credible sets</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-7-2.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="ldl-ukb-d-30780_irnt" class="section level1">
<h1>LDL-ukb-d-30780_irnt</h1>
<div id="parameter" class="section level2">
<h2>Parameter</h2>
<pre class="r"><code>trait &lt;- &quot;LDL-ukb-d-30780_irnt&quot;
gwas_n &lt;- samplesize[trait]
tissue &lt;- c(&quot;Liver&quot;,&quot;Spleen&quot;,&quot;Esophagus_Mucosa&quot;,&quot;Esophagus_Gastroesophageal_Junction&quot;,&quot;Skin_Not_Sun_Exposed_Suprapubic&quot;)

results_dir_multi &lt;- paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/results/&quot;,trait,&quot;/&quot;)
ctwas_res_multi &lt;- readRDS(paste0(results_dir_multi,trait,&quot;.ctwas.res.RDS&quot;))

param_multi &lt;- ctwas_res_multi$param
make_convergence_plots(param_multi, gwas_n, colors = colors)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-8-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-8-1">
Past versions of unnamed-chunk-8-1.png
</button>
</p>
<div id="fig-unnamed-chunk-8-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/4a84d72e7453cf3617b2b5a0fdd798d0595620e2/docs/figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-8-1.png" target="_blank">4a84d72</a>
</td>
<td>
XSun
</td>
<td>
2024-10-15
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>ctwas_parameters_multi &lt;- summarize_param(param_multi, gwas_n)
pve_pie_by_type_multi &lt;- plot_piechart(ctwas_parameters = ctwas_parameters_multi, colors = colors, by = &quot;type&quot;)
pve_pie_by_context_multi &lt;- plot_piechart(ctwas_parameters = ctwas_parameters_multi, colors = colors, by = &quot;context&quot;)

gridExtra::grid.arrange(pve_pie_by_type_multi,pve_pie_by_context_multi, ncol = 2)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-9-1.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
<div id="fine-mapping-1" class="section level2">
<h2>Fine-mapping</h2>
<pre class="r"><code>susie_alpha_res_multi &lt;- ctwas_res_multi$susie_alpha_res

susie_alpha_res_multi &lt;- anno_susie_alpha_res(susie_alpha_res_multi,
                                        mapping_table = mapping_two,
                                        map_by = &quot;molecular_id&quot;,
                                        drop_unmapped = TRUE)</code></pre>
<pre><code>2024-10-16 11:05:06 INFO::Annotating susie alpha result ...
2024-10-16 11:05:06 INFO::Map molecular traits to genes
2024-10-16 11:05:06 INFO::Split PIPs for molecular traits mapped to multiple genes</code></pre>
<pre class="r"><code>combined_pip_by_type_cs_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;type&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = T)

combined_pip_by_context_cs_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;context&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = T)

DT::datatable(combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$combined_pip&gt;0.8,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Combined PIP by omics&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-16707cd634e93674753d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-16707cd634e93674753d">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Combined PIP by omics<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96"],["APOB","GSTM5","HLA-DRA","KMT2E","KPNB1","LDLR","PSRC1","TMED5","INSIG2","TAP1","YIPF2","RAB11FIP4","HPR","ZGPAT","CCDC18","DVL2","CETP","DNAJC13","SNX17","C10orf88","LST1","ASGR1","ABHD12","PCSK9","FADS1","HP","PKN3","HLA-DQA1","TNKS","SLC39A8","GAS6","TIMD4","TRIM39","C18orf32","RSPO3","GSK3B","PYGB","INHBB","SP4","CSNK1G3","ZNF227","PELO","ZDHHC18","MYPOP","PSMG1","ADH1B","PPARD","STAT5B","KDSR","HMGCR","CNIH4","CTSB","ABCA8","LRCH4","PNPO","TMEM57","N4BP2L1","FAM117B","PARP9","TCF12","CYP2A6","MYO9B","EVI5","THOP1","XPNPEP3","USP53","MITF","PGS1","FCGRT","FUT2","RAC1","PHC1","ERGIC3","PRKD2","LIPC","CYP4F12","SENP3","EFNA1","SERPINF2","HLA-DQB1","HLA-DQB2","SRRT","POP7","SPTY2D1","ACP6","ALLC","CCDC92","ADRB1","DDX56","CSK","SLC22A1","APOC1","CCDC57","BUD13","NPC1L1","SH3TC1"],["2_20850730_23118512.L1","1_109761309_111199115.L1","6_32714887_33268720.L3","7_104519078_106042459.L3","17_44979537_47798656.L1,17_47798656_49440038.L1","19_9127717_11173352.L2","1_107867043_109761309.L1","1_93070902_94040635.L3,1_93070902_94040635.L1","2_117609890_120546207.L1","6_32714887_33268720.L4","19_9127717_11173352.L5","17_31459473_33211407.L1","16_71020125_72901251.L2","20_63558827_64333810.L1","1_93070902_94040635.L2,1_93070902_94040635.L3","17_7414079_8403107.L2","16_55869862_57630418.L1","3_132117672_133533329.L2,3_132117672_133533329.L1","2_26672117_28375910.L2,2_26672117_28375910.L1","10_122141030_124109830.L1","6_30830391_31603441.L2","17_5838014_7414079.L1","20_24737088_25363595.L1","1_53760589_55947444.L2,1_53760589_55947444.L3","11_59013076_62456299.L1","16_71020125_72901251.L1","9_127293231_129403191.L1","6_31603441_32714887.L2","8_9297184_9783277.L1","4_99757203_102300199.L1","13_112918174_114344378.L1","5_155946495_157201689.L1","6_29770194_30830391.L1,6_29770194_30830391.L2","18_48413361_50204214.L2","6_125103237_127219316.L1","3_118811404_120804208.L1","20_25363595_33027017.L1","2_120546207_122545330.L1","7_20085285_22468010.L1","5_123221211_124462407.L1","19_43358303_44239955.L3","5_50867564_52838788.L1","1_25190354_27075376.L2","19_45599439_46646825.L2","21_39110976_40017600.L1","4_98502916_99757203.L1","6_33268720_35487979.L3","17_41743558_43694719.L1","18_62610482_64153018.L1","5_74463501_76503041.L1","1_222056878_224750818.L1","8_11421489_13634266.L2","17_66804312_69862629.L4","7_99117851_100599028.L2","17_47798656_49440038.L2","1_25190354_27075376.L1","13_31727678_33202766.L2,13_31727678_33202766.L3","2_201953914_204934518.L1","3_122255250_123798921.L1","15_56609575_58149167.L1","19_40478694_41625199.L1","19_16263605_18299052.L2","1_91420760_93070902.L1","19_2098397_3019662.L1","22_40149793_42294812.L1","4_119012357_119471529.L1","3_69227611_70399877.L1","17_78267332_79302554.L1","19_48778970_51029311.L3","19_46646825_48778970.L1","7_5814895_6534226.L1","12_8878799_10328935.L1","20_34225635_36332043.L1","19_46646825_48778970.L2","15_58149167_59401917.L1","19_15537799_16263605.L1","17_7414079_8403107.L3","1_154797927_156366342.L1","17_1269105_2025437.L1","6_31603441_32714887.L1,6_32714887_33268720.L1,6_32714887_33268720.L5","6_31603441_32714887.L1,6_32714887_33268720.L1,6_32714887_33268720.L5","7_100599028_101555972.L2","7_100599028_101555972.L3","11_17556855_19547988.L1","1_118296444_148907004.L1","2_1777250_3926189.L1","12_121569746_124493434.L1","10_113568673_114661647.L1","7_43119475_44724229.L2","15_73336373_76106283.L1","6_157797687_160159465.L4","19_44239955_45599439.L4","17_82076532_83247139.L1","11_116512631_117876395.L2","7_43119475_44724229.L1","4_8150508_9324753.L1"],[1,1,1,1,1,1,1,1,0.999999999999991,0.999999999998757,0.99999990654721,0.999999706248135,0.999947628221976,0.9999223455784,0.999902487128443,0.999900860835451,0.999711203345103,0.999517183533458,0.999395796036612,0.999386099741562,0.998727844980467,0.998698966021482,0.998622600458346,0.998547561582621,0.99796669114166,0.995423348454706,0.9952834941516,0.994164732661907,0.994047582089126,0.993245627847029,0.99322500683076,0.991529227040894,0.991445942333019,0.989125287247626,0.988775922497853,0.988353872561794,0.988262188536093,0.985424285418962,0.984328607238471,0.981960001365678,0.980895015057538,0.97926803928464,0.978666084311712,0.978020060496182,0.974734929669096,0.974285735319496,0.97231679714482,0.969015191713736,0.962689388772422,0.959767431897405,0.956500463975915,0.955135340067899,0.952244656487657,0.951758994216066,0.951053717708699,0.949040563720354,0.944992533724829,0.94467749826806,0.942980513786565,0.94083904193031,0.938181006921701,0.937023798012999,0.935775084762044,0.933389132812471,0.926673502636698,0.925607586106697,0.92544549042215,0.923425219840446,0.922262728730823,0.918253399427136,0.90083442559299,0.900271476131838,0.896168319623649,0.893443170241557,0.889727634083335,0.880741485912925,0.878720037603916,0.87641092368339,0.875762694986319,0.874995793156505,0.874995793156505,0.871747679424072,0.871095903421351,0.869817946170837,0.866456605569033,0.860190999060021,0.852696196505139,0.851347490144212,0.847777896679284,0.846364126632981,0.84445123473454,0.83678517621896,0.833331096177229,0.821963111091343,0.807189941977218,0.804505165002138],["2_20850730_23118512.L1",null,null,"7_104519078_106042459.L3",null,null,"1_107867043_109761309.L1","1_93070902_94040635.L3","2_117609890_120546207.L1",null,null,null,"16_71020125_72901251.L2","20_63558827_64333810.L1","1_93070902_94040635.L2",null,"16_55869862_57630418.L1","3_132117672_133533329.L2,3_132117672_133533329.L1","2_26672117_28375910.L2","10_122141030_124109830.L1",null,"17_5838014_7414079.L1",null,"1_53760589_55947444.L2,1_53760589_55947444.L3","11_59013076_62456299.L1",null,"9_127293231_129403191.L1",null,"8_9297184_9783277.L1",null,"13_112918174_114344378.L1","5_155946495_157201689.L1","6_29770194_30830391.L1",null,null,"3_118811404_120804208.L1",null,"2_120546207_122545330.L1","7_20085285_22468010.L1","5_123221211_124462407.L1",null,"5_50867564_52838788.L1",null,null,"21_39110976_40017600.L1",null,null,"17_41743558_43694719.L1","18_62610482_64153018.L1",null,"1_222056878_224750818.L1","8_11421489_13634266.L2","17_66804312_69862629.L4",null,null,"1_25190354_27075376.L1","13_31727678_33202766.L2,13_31727678_33202766.L3","2_201953914_204934518.L1","3_122255250_123798921.L1",null,"19_40478694_41625199.L1",null,"1_91420760_93070902.L1",null,"22_40149793_42294812.L1","4_119012357_119471529.L1","3_69227611_70399877.L1",null,"19_48778970_51029311.L3","19_46646825_48778970.L1","7_5814895_6534226.L1","12_8878799_10328935.L1",null,"19_46646825_48778970.L2",null,"19_15537799_16263605.L1","17_7414079_8403107.L3","1_154797927_156366342.L1",null,null,null,"7_100599028_101555972.L2","7_100599028_101555972.L3","11_17556855_19547988.L1","1_118296444_148907004.L1","2_1777250_3926189.L1","12_121569746_124493434.L1","10_113568673_114661647.L1","7_43119475_44724229.L2","15_73336373_76106283.L1","6_157797687_160159465.L4","19_44239955_45599439.L4","17_82076532_83247139.L1","11_116512631_117876395.L2","7_43119475_44724229.L1","4_8150508_9324753.L1"],[1,null,null,1,null,null,1,0.0515081952489046,0.999999999999991,null,null,null,0.999947628221976,0.9999223455784,0.999900263951707,null,0.999711203345103,0.989713332813058,0.015459650520339,0.999386099741562,null,0.312197915489572,null,0.998547561582621,0.99796669114166,null,0.877618668181973,null,0.994047582089126,null,0.99322500683076,0.991529227040894,0.990869853977967,null,null,0.988353872561794,null,0.985424285418962,0.984328607238471,0.981960001365678,null,0.97926803928464,null,null,0.903591988551422,null,null,0.969015191713736,0.962689388772422,null,0.501861811898692,0.0242313215098214,0.221507855791086,null,null,0.0510904416484048,0.944992533724829,0.94467749826806,0.505689307803237,null,0.938181006921701,null,0.0697173158039247,null,0.257593252742044,0.465480736742336,0.92544549042215,null,0.367242187885277,0.918253399427136,0.0533034159538536,0.0255567462112083,null,0.893443170241557,null,0.32195013240583,0.878720037603916,0.016339565124627,null,null,null,0.796415519998221,0.871095903421351,0.869817946170837,0.710492035284441,0.860190999060021,0.00406204954700262,0.851347490144212,0.847777896679284,0.0039278701573574,0.84445123473454,0.83678517621896,0.0124030904013198,0.807223145716016,0.807189941977218,0.804505165002138],[null,null,null,null,null,"19_9127717_11173352.L2",null,"1_93070902_94040635.L3",null,"6_32714887_33268720.L4",null,null,null,null,"1_93070902_94040635.L3",null,null,null,"2_26672117_28375910.L2,2_26672117_28375910.L1",null,null,"17_5838014_7414079.L1",null,null,null,"16_71020125_72901251.L1",null,null,null,null,null,null,"6_29770194_30830391.L2",null,null,null,null,null,null,null,"19_43358303_44239955.L3",null,"1_25190354_27075376.L2","19_45599439_46646825.L2","21_39110976_40017600.L1","4_98502916_99757203.L1",null,null,null,"5_74463501_76503041.L1","1_222056878_224750818.L1","8_11421489_13634266.L2","17_66804312_69862629.L4","7_99117851_100599028.L2","17_47798656_49440038.L2","1_25190354_27075376.L1",null,null,"3_122255250_123798921.L1",null,null,null,null,"19_2098397_3019662.L1","22_40149793_42294812.L1","4_119012357_119471529.L1",null,"17_78267332_79302554.L1","19_48778970_51029311.L3",null,"7_5814895_6534226.L1","12_8878799_10328935.L1","20_34225635_36332043.L1",null,"15_58149167_59401917.L1","19_15537799_16263605.L1",null,"1_154797927_156366342.L1","17_1269105_2025437.L1","6_31603441_32714887.L1,6_32714887_33268720.L1,6_32714887_33268720.L5","6_31603441_32714887.L1,6_32714887_33268720.L1,6_32714887_33268720.L5","7_100599028_101555972.L2",null,null,"1_118296444_148907004.L1",null,"12_121569746_124493434.L1",null,null,null,null,null,"17_82076532_83247139.L1","11_116512631_117876395.L2",null,null],[null,null,null,null,null,1,null,0.452701263965977,null,0.999999999998757,null,null,null,null,0.0148149210453449,null,null,null,0.999385352170335,null,null,0.686501050531911,null,null,null,0.995423348454706,null,null,null,null,null,null,0.063097386563452,null,null,null,null,null,null,null,0.980895015057538,null,0.978666084311712,0.978020060496182,0.0711429476667125,0.974285735319496,null,null,null,0.959767431897405,0.454638652077223,0.0179636775473021,0.730736847275857,0.951758994216066,0.951053717708699,0.89795012209595,null,null,0.437397324705313,null,null,null,null,0.187212418684709,0.0496527028269713,0.460126849364361,null,0.489583417349531,0.555021281202673,null,0.00796788753524025,0.874718282343812,0.131234879935997,null,0.889727634083335,0.558791353507095,null,0.0818192926441654,0.045915194669834,0.874995793156505,0.874995793156505,0.0753352730458914,null,null,0.152612423805307,null,0.00389035883702815,null,null,null,null,null,0.154426954321349,0.0147399690436728,null,null],[null,"1_109761309_111199115.L1","6_32714887_33268720.L3",null,"17_44979537_47798656.L1,17_47798656_49440038.L1",null,null,"1_93070902_94040635.L1,1_93070902_94040635.L3",null,null,"19_9127717_11173352.L5","17_31459473_33211407.L1",null,null,"1_93070902_94040635.L3","17_7414079_8403107.L2",null,"3_132117672_133533329.L2",null,null,"6_30830391_31603441.L2",null,"20_24737088_25363595.L1",null,null,null,"9_127293231_129403191.L1","6_31603441_32714887.L2",null,"4_99757203_102300199.L1",null,null,null,"18_48413361_50204214.L2","6_125103237_127219316.L1",null,"20_25363595_33027017.L1",null,null,null,null,null,null,null,null,null,"6_33268720_35487979.L3",null,null,null,null,"8_11421489_13634266.L2",null,null,null,null,null,null,null,"15_56609575_58149167.L1",null,"19_16263605_18299052.L2","1_91420760_93070902.L1","19_2098397_3019662.L1","22_40149793_42294812.L1",null,null,"17_78267332_79302554.L1",null,null,"7_5814895_6534226.L1",null,"20_34225635_36332043.L1",null,null,null,null,"1_154797927_156366342.L1","17_1269105_2025437.L1",null,null,null,null,null,"1_118296444_148907004.L1",null,"12_121569746_124493434.L1",null,null,"15_73336373_76106283.L1",null,null,"17_82076532_83247139.L1",null,null,null],[null,1,1,null,1,null,null,1,null,null,0.99999990654721,0.999999706248135,null,null,0.00747565300209774,0.999900860835451,null,0.949670563552391,null,null,0.998727844980467,null,0.998622600458346,null,null,null,0.117664825969627,0.994164732661907,null,0.993245627847029,null,null,null,0.989125287247626,0.988775922497853,null,0.988262188536093,null,null,null,null,null,null,null,null,null,0.97231679714482,null,null,null,null,0.912953678306284,null,null,null,null,null,null,null,0.94083904193031,null,0.937023798012999,0.86605776895812,0.746176714127762,0.619427547067683,null,null,0.433841802490916,null,null,0.839563122103896,null,0.764933439687653,null,null,null,null,0.778257809866283,0.829847500316485,null,null,null,null,null,0.00335214647928539,null,0.844743788121109,null,null,0.842436256475624,null,null,0.66650105145456,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_cs_id<\/th>\n      <th>eQTL_pip<\/th>\n      <th>sQTL_cs_id<\/th>\n      <th>sQTL_pip<\/th>\n      <th>stQTL_cs_id<\/th>\n      <th>stQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>DT::datatable(combined_pip_by_context_cs_multi[combined_pip_by_context_cs_multi$combined_pip&gt;0.8,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Combined PIP by tissue&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-37e46cf92521dcbed3f8" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-37e46cf92521dcbed3f8">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Combined PIP by tissue<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96"],["APOB","GSTM5","HLA-DRA","KMT2E","KPNB1","LDLR","PSRC1","TMED5","INSIG2","TAP1","YIPF2","RAB11FIP4","HPR","ZGPAT","CCDC18","DVL2","CETP","DNAJC13","SNX17","C10orf88","LST1","ASGR1","ABHD12","PCSK9","FADS1","HP","PKN3","HLA-DQA1","TNKS","SLC39A8","GAS6","TIMD4","TRIM39","C18orf32","RSPO3","GSK3B","PYGB","INHBB","SP4","CSNK1G3","ZNF227","PELO","ZDHHC18","MYPOP","PSMG1","ADH1B","PPARD","STAT5B","KDSR","HMGCR","CNIH4","CTSB","ABCA8","LRCH4","PNPO","TMEM57","N4BP2L1","FAM117B","PARP9","TCF12","CYP2A6","MYO9B","EVI5","THOP1","XPNPEP3","USP53","MITF","PGS1","FCGRT","FUT2","RAC1","PHC1","ERGIC3","PRKD2","LIPC","CYP4F12","SENP3","EFNA1","SERPINF2","HLA-DQB1","HLA-DQB2","SRRT","POP7","SPTY2D1","ACP6","ALLC","CCDC92","ADRB1","DDX56","CSK","SLC22A1","APOC1","CCDC57","BUD13","NPC1L1","SH3TC1"],["2_20850730_23118512.L1","1_109761309_111199115.L1","6_32714887_33268720.L3","7_104519078_106042459.L3","17_44979537_47798656.L1,17_47798656_49440038.L1","19_9127717_11173352.L2","1_107867043_109761309.L1","1_93070902_94040635.L3,1_93070902_94040635.L1","2_117609890_120546207.L1","6_32714887_33268720.L4","19_9127717_11173352.L5","17_31459473_33211407.L1","16_71020125_72901251.L2","20_63558827_64333810.L1","1_93070902_94040635.L2,1_93070902_94040635.L3","17_7414079_8403107.L2","16_55869862_57630418.L1","3_132117672_133533329.L2,3_132117672_133533329.L1","2_26672117_28375910.L2,2_26672117_28375910.L1","10_122141030_124109830.L1","6_30830391_31603441.L2","17_5838014_7414079.L1","20_24737088_25363595.L1","1_53760589_55947444.L2,1_53760589_55947444.L3","11_59013076_62456299.L1","16_71020125_72901251.L1","9_127293231_129403191.L1","6_31603441_32714887.L2","8_9297184_9783277.L1","4_99757203_102300199.L1","13_112918174_114344378.L1","5_155946495_157201689.L1","6_29770194_30830391.L1,6_29770194_30830391.L2","18_48413361_50204214.L2","6_125103237_127219316.L1","3_118811404_120804208.L1","20_25363595_33027017.L1","2_120546207_122545330.L1","7_20085285_22468010.L1","5_123221211_124462407.L1","19_43358303_44239955.L3","5_50867564_52838788.L1","1_25190354_27075376.L2","19_45599439_46646825.L2","21_39110976_40017600.L1","4_98502916_99757203.L1","6_33268720_35487979.L3","17_41743558_43694719.L1","18_62610482_64153018.L1","5_74463501_76503041.L1","1_222056878_224750818.L1","8_11421489_13634266.L2","17_66804312_69862629.L4","7_99117851_100599028.L2","17_47798656_49440038.L2","1_25190354_27075376.L1","13_31727678_33202766.L2,13_31727678_33202766.L3","2_201953914_204934518.L1","3_122255250_123798921.L1","15_56609575_58149167.L1","19_40478694_41625199.L1","19_16263605_18299052.L2","1_91420760_93070902.L1","19_2098397_3019662.L1","22_40149793_42294812.L1","4_119012357_119471529.L1","3_69227611_70399877.L1","17_78267332_79302554.L1","19_48778970_51029311.L3","19_46646825_48778970.L1","7_5814895_6534226.L1","12_8878799_10328935.L1","20_34225635_36332043.L1","19_46646825_48778970.L2","15_58149167_59401917.L1","19_15537799_16263605.L1","17_7414079_8403107.L3","1_154797927_156366342.L1","17_1269105_2025437.L1","6_31603441_32714887.L1,6_32714887_33268720.L1,6_32714887_33268720.L5","6_31603441_32714887.L1,6_32714887_33268720.L1,6_32714887_33268720.L5","7_100599028_101555972.L2","7_100599028_101555972.L3","11_17556855_19547988.L1","1_118296444_148907004.L1","2_1777250_3926189.L1","12_121569746_124493434.L1","10_113568673_114661647.L1","7_43119475_44724229.L2","15_73336373_76106283.L1","6_157797687_160159465.L4","19_44239955_45599439.L4","17_82076532_83247139.L1","11_116512631_117876395.L2","7_43119475_44724229.L1","4_8150508_9324753.L1"],[1,1,1,1,1,1,1,1,0.999999999999991,0.999999999998757,0.99999990654721,0.999999706248135,0.999947628221976,0.9999223455784,0.999902487128443,0.999900860835451,0.999711203345103,0.999517183533458,0.999395796036612,0.999386099741562,0.998727844980467,0.998698966021482,0.998622600458346,0.998547561582621,0.99796669114166,0.995423348454706,0.9952834941516,0.994164732661907,0.994047582089126,0.993245627847029,0.99322500683076,0.991529227040894,0.991445942333019,0.989125287247626,0.988775922497853,0.988353872561794,0.988262188536093,0.985424285418962,0.984328607238471,0.981960001365678,0.980895015057538,0.97926803928464,0.978666084311712,0.978020060496182,0.974734929669096,0.974285735319496,0.97231679714482,0.969015191713736,0.962689388772422,0.959767431897405,0.956500463975915,0.955135340067899,0.952244656487657,0.951758994216066,0.951053717708699,0.949040563720354,0.944992533724829,0.94467749826806,0.942980513786565,0.94083904193031,0.938181006921701,0.937023798012999,0.935775084762044,0.933389132812471,0.926673502636698,0.925607586106697,0.92544549042215,0.923425219840446,0.922262728730823,0.918253399427136,0.90083442559299,0.900271476131838,0.896168319623649,0.893443170241557,0.889727634083335,0.880741485912925,0.878720037603916,0.87641092368339,0.875762694986319,0.874995793156505,0.874995793156505,0.871747679424072,0.871095903421351,0.869817946170837,0.866456605569033,0.860190999060021,0.852696196505139,0.851347490144212,0.847777896679284,0.846364126632981,0.84445123473454,0.83678517621896,0.833331096177229,0.821963111091343,0.807189941977218,0.804505165002138],[null,null,null,null,null,"19_9127717_11173352.L2","1_107867043_109761309.L1","1_93070902_94040635.L3","2_117609890_120546207.L1",null,null,null,"16_71020125_72901251.L2","20_63558827_64333810.L1","1_93070902_94040635.L2,1_93070902_94040635.L3",null,null,"3_132117672_133533329.L2",null,null,"6_30830391_31603441.L2","17_5838014_7414079.L1",null,null,"11_59013076_62456299.L1","16_71020125_72901251.L1","9_127293231_129403191.L1",null,"8_9297184_9783277.L1","4_99757203_102300199.L1","13_112918174_114344378.L1",null,"6_29770194_30830391.L1","18_48413361_50204214.L2",null,"3_118811404_120804208.L1","20_25363595_33027017.L1","2_120546207_122545330.L1","7_20085285_22468010.L1","5_123221211_124462407.L1",null,null,null,null,"21_39110976_40017600.L1",null,null,"17_41743558_43694719.L1","18_62610482_64153018.L1",null,"1_222056878_224750818.L1","8_11421489_13634266.L2","17_66804312_69862629.L4","7_99117851_100599028.L2","17_47798656_49440038.L2","1_25190354_27075376.L1",null,null,"3_122255250_123798921.L1",null,"19_40478694_41625199.L1",null,"1_91420760_93070902.L1","19_2098397_3019662.L1","22_40149793_42294812.L1","4_119012357_119471529.L1",null,"17_78267332_79302554.L1",null,"19_46646825_48778970.L1","7_5814895_6534226.L1","12_8878799_10328935.L1","20_34225635_36332043.L1","19_46646825_48778970.L2","15_58149167_59401917.L1","19_15537799_16263605.L1",null,null,"17_1269105_2025437.L1",null,null,"7_100599028_101555972.L2","7_100599028_101555972.L3","11_17556855_19547988.L1","1_118296444_148907004.L1","2_1777250_3926189.L1","12_121569746_124493434.L1",null,"7_43119475_44724229.L2",null,null,null,"17_82076532_83247139.L1",null,"7_43119475_44724229.L1",null],[null,null,null,null,null,1,0.477014535255029,0.297664717925749,0.999999999999991,null,null,null,0.999947628221976,0.9999223455784,0.999901009544791,null,null,0.0035604052013628,null,null,0.998727844980467,0.686501050531911,null,null,0.99796669114166,0.995423348454706,0.117664825969627,null,0.994047582089126,0.993245627847029,0.99322500683076,null,0.990869853977967,0.989125287247626,null,0.676566424828108,0.0448858772258997,0.985424285418962,0.984328607238471,0.981960001365678,null,null,null,null,0.974734929669096,null,null,0.512210863634762,0.410918646311535,null,0.310349468401047,0.62792820034278,0.309810610773043,0.818181975336497,0.574939290472171,0.4845865698987,null,null,0.523912588161355,null,0.938181006921701,null,0.676506699220319,0.279158283085094,0.651043226461876,0.491236384049741,null,0.145551340089603,null,0.527822741922825,0.671352854159269,0.0590221982782637,0.162612690545273,0.74254350942628,0.889727634083335,0.478814804627538,null,null,0.867361185671718,null,null,0.798803370371945,0.747303543770673,0.671577928407979,0.26622731122589,0.860190999060021,0.00406204954700262,null,0.412048209665024,null,null,null,0.395790681764123,null,0.623223459253677,null],[null,"1_109761309_111199115.L1",null,"7_104519078_106042459.L3","17_47798656_49440038.L1",null,null,"1_93070902_94040635.L3,1_93070902_94040635.L1",null,null,null,null,null,null,null,null,"16_55869862_57630418.L1","3_132117672_133533329.L1","2_26672117_28375910.L2","10_122141030_124109830.L1",null,null,null,"1_53760589_55947444.L2",null,null,"9_127293231_129403191.L1",null,null,null,null,"5_155946495_157201689.L1","6_29770194_30830391.L2",null,null,null,null,null,null,null,"19_43358303_44239955.L3","5_50867564_52838788.L1","1_25190354_27075376.L2","19_45599439_46646825.L2",null,"4_98502916_99757203.L1",null,"17_41743558_43694719.L1","18_62610482_64153018.L1",null,"1_222056878_224750818.L1","8_11421489_13634266.L2","17_66804312_69862629.L4","7_99117851_100599028.L2","17_47798656_49440038.L2","1_25190354_27075376.L1",null,null,"3_122255250_123798921.L1",null,null,null,"1_91420760_93070902.L1","19_2098397_3019662.L1","22_40149793_42294812.L1","4_119012357_119471529.L1","3_69227611_70399877.L1","17_78267332_79302554.L1",null,"19_46646825_48778970.L1","7_5814895_6534226.L1","12_8878799_10328935.L1","20_34225635_36332043.L1","19_46646825_48778970.L2",null,null,"17_7414079_8403107.L3","1_154797927_156366342.L1","17_1269105_2025437.L1",null,null,"7_100599028_101555972.L2",null,null,"1_118296444_148907004.L1",null,"12_121569746_124493434.L1","10_113568673_114661647.L1",null,"15_73336373_76106283.L1","6_157797687_160159465.L4",null,"17_82076532_83247139.L1",null,null,"4_8150508_9324753.L1"],[null,1,null,1,1,null,null,1,null,null,null,null,null,null,null,null,0.999711203345103,0.90207862272792,0.0705112378274081,0.999386099741562,null,null,null,0.998485898701466,null,null,0.877618668181973,null,null,null,null,0.991529227040894,0.0493460925012285,null,null,null,null,null,null,null,0.980895015057538,0.864404509910409,0.978666084311712,0.863969473568187,null,0.849670794521458,null,0.405527844709422,0.3521959067325,null,0.191512343497645,0.0228407163905375,0.229604175100707,0.133793113236903,0.328007926869865,0.411178182438001,null,null,0.329831835891003,null,null,null,0.227323471588536,0.11599961745888,0.271079004907543,0.389021844636068,0.92544549042215,0.300029034429466,null,0.3904396072684,0.160462789285044,0.653737998035524,0.0872207149080602,0.150901305580742,null,null,0.878720037603916,0.101529513655741,0.00840150931460115,null,null,0.0471222588966116,null,null,0.338992543943661,null,0.00389035883702815,0.851347490144212,null,0.0039278701573574,0.84445123473454,null,0.217033191883705,null,null,0.804505165002138],["2_20850730_23118512.L1",null,"6_32714887_33268720.L3",null,"17_44979537_47798656.L1",null,"1_107867043_109761309.L1","1_93070902_94040635.L3",null,null,"19_9127717_11173352.L5","17_31459473_33211407.L1",null,null,"1_93070902_94040635.L3",null,null,"3_132117672_133533329.L2","2_26672117_28375910.L2",null,null,null,null,null,null,null,null,"6_31603441_32714887.L2",null,null,null,null,"6_29770194_30830391.L2",null,"6_125103237_127219316.L1","3_118811404_120804208.L1",null,null,null,null,null,"5_50867564_52838788.L1",null,"19_45599439_46646825.L2",null,null,null,"17_41743558_43694719.L1","18_62610482_64153018.L1","5_74463501_76503041.L1","1_222056878_224750818.L1","8_11421489_13634266.L2","17_66804312_69862629.L4",null,null,"1_25190354_27075376.L1","13_31727678_33202766.L2","2_201953914_204934518.L1","3_122255250_123798921.L1","15_56609575_58149167.L1",null,"19_16263605_18299052.L2","1_91420760_93070902.L1","19_2098397_3019662.L1",null,"4_119012357_119471529.L1",null,null,"19_48778970_51029311.L3",null,null,"12_8878799_10328935.L1","20_34225635_36332043.L1",null,null,"19_15537799_16263605.L1",null,"1_154797927_156366342.L1",null,"6_31603441_32714887.L1","6_31603441_32714887.L1","7_100599028_101555972.L2","7_100599028_101555972.L3",null,"1_118296444_148907004.L1",null,"12_121569746_124493434.L1",null,null,"15_73336373_76106283.L1",null,"19_44239955_45599439.L4","17_82076532_83247139.L1",null,null,null],[1,null,1,null,0.0138019662511801,null,0.522985464744971,0.0643114025794375,null,null,0.99999990654721,0.999999706248135,null,null,0.0148149210453449,null,null,0.949670563552391,0.00930803048813855,null,null,null,null,null,null,null,null,0.0854616009588729,null,null,null,null,0.00651406708525271,null,0.988775922497853,0.112074898523463,null,null,null,null,null,0.0767430758055928,null,0.114050740814607,null,null,null,0.051276483369552,0.0782776395310734,0.617012388785771,0.454638652077223,0.139866137314957,0.0402799061403166,null,null,0.0326838094344071,0.370005671322787,0.94467749826806,0.015990504216204,0.94083904193031,null,0.0438581446982694,0.0266012978845008,0.328751024417023,null,0.0291395924574124,null,null,0.624854033132372,null,null,0.0650161999333279,0.53024970504563,null,null,0.353078950414644,null,0.7686011070768,null,0.49998317263891,0.49998317263891,0.0220149356957771,0.123792903990534,null,0.237062274462047,null,0.844743788121109,null,null,0.779967992139307,null,0.682465562316101,0.136343111561385,null,null,null],[null,null,null,null,null,null,null,"1_93070902_94040635.L3",null,null,null,null,null,null,null,"17_7414079_8403107.L2",null,"3_132117672_133533329.L1","2_26672117_28375910.L2",null,null,"17_5838014_7414079.L1","20_24737088_25363595.L1",null,null,null,null,"6_31603441_32714887.L2",null,null,null,null,"6_29770194_30830391.L2",null,null,"3_118811404_120804208.L1",null,null,null,null,null,"5_50867564_52838788.L1",null,null,null,"4_98502916_99757203.L1",null,null,"18_62610482_64153018.L1","5_74463501_76503041.L1",null,"8_11421489_13634266.L2","17_66804312_69862629.L4",null,"17_47798656_49440038.L2","1_25190354_27075376.L1","13_31727678_33202766.L3",null,"3_122255250_123798921.L1",null,null,null,"1_91420760_93070902.L1","19_2098397_3019662.L1","22_40149793_42294812.L1","4_119012357_119471529.L1",null,"17_78267332_79302554.L1","19_48778970_51029311.L3",null,"7_5814895_6534226.L1","12_8878799_10328935.L1","20_34225635_36332043.L1",null,null,"19_15537799_16263605.L1",null,"1_154797927_156366342.L1",null,null,null,"7_100599028_101555972.L2",null,"11_17556855_19547988.L1","1_118296444_148907004.L1",null,null,null,"7_43119475_44724229.L2","15_73336373_76106283.L1",null,null,"17_82076532_83247139.L1","11_116512631_117876395.L2","7_43119475_44724229.L1",null],[null,null,null,null,null,null,null,0.0192383438215281,null,null,null,null,null,null,null,0.999900860835451,null,0.087597954992981,0.0258010130622958,null,null,0.312197915489572,0.998622600458346,null,null,null,null,0.913892803417189,null,null,null,null,0.00723722697697093,null,null,0.199712549210224,null,null,null,null,null,0.038120453568638,null,null,null,0.124614940798037,null,null,0.121297196197314,0.342755044687719,null,0.0503648668087298,0.372550073556783,null,0.0481065003666626,0.0205920019807768,0.912685523315174,null,0.073360255055037,null,null,null,0.00534361606868827,0.0535125342442936,0.00455127126727961,0.0162097649634749,null,0.477844845321377,0.286211018843211,null,0.0642464019285829,0.11324195353265,0.0484626721565405,null,null,0.0488477308707429,null,0.00629605228210239,null,null,null,0.00381064520148655,null,0.198240017762858,0.0117592210942122,null,null,null,0.435729687014268,0.0624682643363168,null,null,0.041280273677976,0.807223145716016,0.183966483341378,null],[null,null,null,null,null,null,null,null,null,"6_32714887_33268720.L4",null,null,null,null,null,null,null,null,"2_26672117_28375910.L1",null,null,null,null,"1_53760589_55947444.L3",null,null,null,null,null,null,null,null,null,null,null,null,"20_25363595_33027017.L1",null,null,null,null,null,null,null,null,null,"6_33268720_35487979.L3",null,null,null,null,"8_11421489_13634266.L2",null,null,null,null,null,null,null,null,null,"19_16263605_18299052.L2",null,"19_2098397_3019662.L1",null,null,null,null,"19_48778970_51029311.L3",null,"7_5814895_6534226.L1","12_8878799_10328935.L1","20_34225635_36332043.L1",null,null,null,null,null,null,"6_32714887_33268720.L1,6_32714887_33268720.L5","6_32714887_33268720.L1,6_32714887_33268720.L5",null,null,null,"1_118296444_148907004.L1",null,null,null,null,null,null,"19_44239955_45599439.L4","17_82076532_83247139.L1","11_116512631_117876395.L2",null,null],[null,null,null,null,null,null,null,null,null,0.999999999998757,null,null,null,null,null,null,null,null,0.999324443576648,null,null,null,null,0.0407257303158053,null,null,null,null,null,null,null,null,null,null,null,null,0.943376311310193,null,null,null,null,null,null,null,null,null,0.97231679714482,null,null,null,null,0.11424202595277,null,null,null,null,null,null,null,null,null,0.89316570341726,null,0.15596767360718,null,null,null,null,0.0111983899301602,null,0.00477238022009518,0.00926704526882194,0.067622536968146,null,null,null,null,null,null,0.749999999993556,0.749999999993556,null,null,null,0.0124152548432226,null,null,null,null,null,null,0.154319613902859,0.0428838372900395,0.0147399690436728,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>Liver_cs_id<\/th>\n      <th>Liver_pip<\/th>\n      <th>Spleen_cs_id<\/th>\n      <th>Spleen_pip<\/th>\n      <th>Esophagus_Mucosa_cs_id<\/th>\n      <th>Esophagus_Mucosa_pip<\/th>\n      <th>Esophagus_Gastroesophageal_Junction_cs_id<\/th>\n      <th>Esophagus_Gastroesophageal_Junction_pip<\/th>\n      <th>Skin_Not_Sun_Exposed_Suprapubic_cs_id<\/th>\n      <th>Skin_Not_Sun_Exposed_Suprapubic_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9,11,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>combined_pip_by_group_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;group&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = F)

combined_pip_by_group_sig_multi &lt;- combined_pip_by_group_multi[combined_pip_by_group_multi$combined_pip &gt; 0.8,]

plot_heatmap(heatmap_data = combined_pip_by_group_sig_multi, main = &quot;PIP partitions for genes with PIP&gt;0.8&quot;)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-10-3.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
<div id="comparing-with-single-tissue-eqtl-analysis-1"
class="section level2">
<h2>Comparing with single tissue + eQTL analysis</h2>
<pre class="r"><code>ctwas_res_single &lt;- readRDS(paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/10.single_tissue_1007/results/&quot;,trait,&quot;/&quot;,tissue[1],&quot;/&quot;,trait,&quot;_&quot;,tissue[1], &quot;.ctwas.res.RDS&quot;))

susie_alpha_res_single &lt;- ctwas_res_single$susie_alpha_res

susie_alpha_res_single &lt;- anno_susie_alpha_res(susie_alpha_res_single,
                                        mapping_table = mapping_predictdb,
                                        map_by = &quot;molecular_id&quot;,
                                        drop_unmapped = TRUE)</code></pre>
<pre><code>2024-10-16 11:05:19 INFO::Annotating susie alpha result ...
2024-10-16 11:05:19 INFO::Map molecular traits to genes</code></pre>
<pre class="r"><code>combined_pip_by_type_single &lt;- combine_gene_pips(susie_alpha_res_single, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;type&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = F)

combined_pip_by_type_sig_single &lt;- combined_pip_by_type_single[combined_pip_by_type_single$combined_pip &gt; 0.8,]
combined_pip_by_type_sig_multi &lt;- combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$combined_pip &gt; 0.8,]

sprintf(&quot;Number of genes with PIP &gt; 0.8  -- Multi-group = %s&quot;, nrow(combined_pip_by_type_sig_multi))</code></pre>
<pre><code>[1] &quot;Number of genes with PIP &gt; 0.8  -- Multi-group = 96&quot;</code></pre>
<pre class="r"><code>sprintf(&quot;Number of genes with PIP &gt; 0.8  -- single eQTL = %s&quot;, nrow(combined_pip_by_type_sig_single))</code></pre>
<pre><code>[1] &quot;Number of genes with PIP &gt; 0.8  -- single eQTL = 31&quot;</code></pre>
<pre class="r"><code>sprintf(&quot;Number of overlapped genes = %s&quot;, sum(combined_pip_by_type_sig_single$gene_name %in% combined_pip_by_type_sig_multi$gene_name))</code></pre>
<pre><code>[1] &quot;Number of overlapped genes = 28&quot;</code></pre>
<pre class="r"><code>genes_not_reported &lt;- combined_pip_by_type_sig_single$gene_name[!combined_pip_by_type_sig_single$gene_name %in%combined_pip_by_type_sig_multi$gene_name]

DT::datatable(combined_pip_by_type_sig_single[combined_pip_by_type_sig_single$gene_name %in% genes_not_reported,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Genes not reported by multi-group analysis&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-99e959167faff8d1fc37" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-99e959167faff8d1fc37">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Genes not reported by multi-group analysis<\/caption>","data":[["24","29","31"],["USP1","ASAP3","CWF19L1"],[0.875844150120593,0.823863737188438,0.806358285154835],[0.875844150120593,0.823863737188438,0.806358285154835]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>DT::datatable(combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$gene_name %in% genes_not_reported,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Genes not reported by multi-group analysis&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-4a6133f685aa29daac40" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-4a6133f685aa29daac40">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Genes not reported by multi-group analysis<\/caption>","data":[["103","107","110"],["ASAP3","CWF19L1","USP1"],["1_22760390_23594100.L1","10_98908643_101189482.L1","1_61456693_62989418.L1"],[0.751890818328297,0.703758966623811,0.690009856600093],["1_22760390_23594100.L1","10_98908643_101189482.L1","1_61456693_62989418.L1"],[0.751890818328297,0.596869020549695,0.658657766547728],[null,"10_98908643_101189482.L1","1_61456693_62989418.L1"],[null,0.1010116671728,0.0313520900523643],[null,"10_98908643_101189482.L1",null],[null,0.00587827890131565,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_cs_id<\/th>\n      <th>eQTL_pip<\/th>\n      <th>sQTL_cs_id<\/th>\n      <th>sQTL_pip<\/th>\n      <th>stQTL_cs_id<\/th>\n      <th>stQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>gene_multi_unique_type &lt;- combined_pip_by_group_sig_multi[!combined_pip_by_group_sig_multi$gene_name %in%  combined_pip_by_type_sig_single$gene_name,]

plot_heatmap(heatmap_data = gene_multi_unique_type, main = &quot;PIP partition for unique genes found by multi-group analysis&quot;)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-12-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-12-1">
Past versions of unnamed-chunk-12-1.png
</button>
</p>
<div id="fig-unnamed-chunk-12-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/4a84d72e7453cf3617b2b5a0fdd798d0595620e2/docs/figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-12-1.png" target="_blank">4a84d72</a>
</td>
<td>
XSun
</td>
<td>
2024-10-15
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>snp_map_single &lt;- readRDS(paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/10.single_tissue_1007/results/&quot;,trait,&quot;/&quot;,tissue[1],&quot;/&quot;,trait,&quot;_&quot;,tissue[1], &quot;.snp_map.RDS&quot;))
weights_single &lt;- readRDS(paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/10.single_tissue_1007/results/&quot;,trait,&quot;/&quot;,tissue[1],&quot;/&quot;,trait,&quot;_&quot;,tissue[1], &quot;.preprocessed.weights.RDS&quot;))

finemap_res_single &lt;- ctwas_res_single$finemap_res
finemap_res_single$molecular_id &lt;- get_molecular_ids(finemap_res_single)
finemap_res_single &lt;- anno_finemap_res(finemap_res_single,
                                snp_map = snp_map_single,
                                mapping_table = mapping_two,
                                add_gene_annot = TRUE,
                                map_by = &quot;molecular_id&quot;,
                                drop_unmapped = TRUE,
                                add_position = TRUE,
                                use_gene_pos = &quot;mid&quot;)</code></pre>
<pre><code>2024-10-16 11:05:32 INFO::Annotating fine-mapping result ...
2024-10-16 11:05:32 INFO::Map molecular traits to genes
2024-10-16 11:05:41 INFO::Add gene positions
2024-10-16 11:05:42 INFO::Add SNP positions</code></pre>
<pre class="r"><code>snp_map_multi &lt;- readRDS(paste0(results_dir_multi,trait,&quot;.snp_map.RDS&quot;))
weights_multi &lt;- readRDS(paste0(results_dir_multi,trait,&quot;.preprocessed.weights.RDS&quot;))

finemap_res_multi &lt;- ctwas_res_multi$finemap_res
finemap_res_multi$molecular_id &lt;- get_molecular_ids(finemap_res_multi)
finemap_res_multi &lt;- anno_finemap_res(finemap_res_multi,
                                snp_map = snp_map_multi,
                                mapping_table = mapping_two,
                                add_gene_annot = TRUE,
                                map_by = &quot;molecular_id&quot;,
                                drop_unmapped = TRUE,
                                add_position = TRUE,
                                use_gene_pos = &quot;mid&quot;)</code></pre>
<pre><code>2024-10-16 11:06:06 INFO::Annotating fine-mapping result ...
2024-10-16 11:06:06 INFO::Map molecular traits to genes
2024-10-16 11:06:07 INFO::Split PIPs for molecular traits mapped to multiple genes
2024-10-16 11:06:18 INFO::Add gene positions
2024-10-16 11:06:18 INFO::Add SNP positions</code></pre>
<pre class="r"><code>make_locusplot(finemap_res_single,
               region_id = &quot;1_22760390_23594100&quot;,
               ens_db = ens_db,
               weights = weights_single,
               highlight_pip = 0.8,
               filter_protein_coding_genes = TRUE,
               filter_cs = TRUE,
               color_pval_by = &quot;cs&quot;,
               color_pip_by = &quot;cs&quot;)</code></pre>
<pre><code>2024-10-16 11:06:27 INFO::Limit to protein coding genes
2024-10-16 11:06:27 INFO::focal id: ENSG00000088280.18|Liver_eQTL
2024-10-16 11:06:27 INFO::focal molecular trait: ASAP3 Liver eQTL
2024-10-16 11:06:27 INFO::Range of locus: chr1:22760290-23591317
2024-10-16 11:06:27 INFO::focal molecular trait QTL positions: 23484588,23484995
2024-10-16 11:06:27 INFO::Limit PIPs to credible sets</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-13-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-13-1">
Past versions of unnamed-chunk-13-1.png
</button>
</p>
<div id="fig-unnamed-chunk-13-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/4a84d72e7453cf3617b2b5a0fdd798d0595620e2/docs/figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-13-1.png" target="_blank">4a84d72</a>
</td>
<td>
XSun
</td>
<td>
2024-10-15
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>make_locusplot(finemap_res_multi,
               region_id = &quot;1_22760390_23594100&quot;,
               ens_db = ens_db,
               weights = weights_multi,
               highlight_pip = 0.8,
               filter_protein_coding_genes = TRUE,
               filter_cs = TRUE,
               color_pval_by = &quot;cs&quot;,
               color_pip_by = &quot;cs&quot;)</code></pre>
<pre><code>2024-10-16 11:06:28 INFO::Limit to protein coding genes
2024-10-16 11:06:28 INFO::focal id: ENSG00000088280.18|Liver_eQTL
2024-10-16 11:06:28 INFO::focal molecular trait: ASAP3 Liver eQTL
2024-10-16 11:06:28 INFO::Range of locus: chr1:22491404-23591317
2024-10-16 11:06:28 INFO::focal molecular trait QTL positions: 23484588,23484995
2024-10-16 11:06:28 INFO::Limit PIPs to credible sets</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-13-2.png" width="1152" style="display: block; margin: auto;" /></p>
<pre class="r"><code>make_locusplot(finemap_res_single,
               region_id = &quot;1_61456693_62989418&quot;,
               ens_db = ens_db,
               weights = weights_single,
               highlight_pip = 0.8,
               filter_protein_coding_genes = TRUE,
               filter_cs = TRUE,
               color_pval_by = &quot;cs&quot;,
               color_pip_by = &quot;cs&quot;)</code></pre>
<pre><code>2024-10-16 11:06:29 INFO::Limit to protein coding genes
2024-10-16 11:06:29 INFO::focal id: ENSG00000162607.12|Liver_eQTL
2024-10-16 11:06:29 INFO::focal molecular trait: USP1 Liver eQTL
2024-10-16 11:06:29 INFO::Range of locus: chr1:61459304-62989160
2024-10-16 11:06:29 INFO::focal molecular trait QTL positions: 62436136
2024-10-16 11:06:29 INFO::Limit PIPs to credible sets</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-13-3.png" width="1152" style="display: block; margin: auto;" /></p>
<pre class="r"><code>make_locusplot(finemap_res_multi,
               region_id = &quot;1_61456693_62989418&quot;,
               ens_db = ens_db,
               weights = weights_multi,
               highlight_pip = 0.8,
               filter_protein_coding_genes = TRUE,
               filter_cs = TRUE,
               color_pval_by = &quot;cs&quot;,
               color_pip_by = &quot;cs&quot;)</code></pre>
<pre><code>2024-10-16 11:06:31 INFO::Limit to protein coding genes
2024-10-16 11:06:31 INFO::focal id: ENSG00000162607.12|Liver_eQTL
2024-10-16 11:06:31 INFO::focal molecular trait: USP1 Liver eQTL
2024-10-16 11:06:31 INFO::Range of locus: chr1:61459304-62989160
2024-10-16 11:06:31 INFO::focal molecular trait QTL positions: 62436136
2024-10-16 11:06:31 INFO::Limit PIPs to credible sets</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-13-4.png" width="1152" style="display: block; margin: auto;" /></p>
<pre class="r"><code>make_locusplot(finemap_res_single,
               region_id = &quot;10_98908643_101189482&quot;,
               ens_db = ens_db,
               weights = weights_single,
               highlight_pip = 0.8,
               filter_protein_coding_genes = TRUE,
               filter_cs = TRUE,
               color_pval_by = &quot;cs&quot;,
               color_pip_by = &quot;cs&quot;)</code></pre>
<pre><code>2024-10-16 11:06:32 INFO::Limit to protein coding genes
2024-10-16 11:06:32 INFO::focal id: ENSG00000095485.16|Liver_eQTL
2024-10-16 11:06:32 INFO::focal molecular trait: CWF19L1 Liver eQTL
2024-10-16 11:06:32 INFO::Range of locus: chr10:98908543-101189277
2024-10-16 11:06:32 INFO::focal molecular trait QTL positions: 100267231,100267650
2024-10-16 11:06:32 INFO::Limit PIPs to credible sets</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-13-5.png" width="1152" style="display: block; margin: auto;" /></p>
<pre class="r"><code>make_locusplot(finemap_res_multi,
               region_id = &quot;10_98908643_101189482&quot;,
               ens_db = ens_db,
               weights = weights_multi,
               highlight_pip = 0.8,
               filter_protein_coding_genes = TRUE,
               filter_cs = TRUE,
               color_pval_by = &quot;cs&quot;,
               color_pip_by = &quot;cs&quot;)</code></pre>
<pre><code>2024-10-16 11:06:34 INFO::Limit to protein coding genes
2024-10-16 11:06:34 INFO::focal id: ENSG00000095485.16|Spleen_eQTL
2024-10-16 11:06:34 INFO::focal molecular trait: CWF19L1 Spleen eQTL
2024-10-16 11:06:34 INFO::Range of locus: chr10:98846370-101189277
2024-10-16 11:06:34 INFO::focal molecular trait QTL positions: 100267650,100268161
2024-10-16 11:06:34 INFO::Limit PIPs to credible sets</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-13-6.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="ibd-ebi-a-gcst004131" class="section level1">
<h1>IBD-ebi-a-GCST004131</h1>
<div id="parameter-1" class="section level2">
<h2>Parameter</h2>
<pre class="r"><code>trait &lt;- &quot;IBD-ebi-a-GCST004131&quot;
gwas_n &lt;- samplesize[trait]
tissue &lt;- c(&quot;Whole_Blood&quot;,&quot;Adipose_Subcutaneous&quot;,&quot;Cells_Cultured_fibroblasts&quot;,&quot;Spleen&quot;,&quot;Testis&quot;)


results_dir_multi &lt;- paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/results/&quot;,trait,&quot;/&quot;)
ctwas_res_multi &lt;- readRDS(paste0(results_dir_multi,trait,&quot;.ctwas.res.RDS&quot;))

param_multi &lt;- ctwas_res_multi$param
make_convergence_plots(param_multi, gwas_n, colors = colors)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-14-1.png" width="1152" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ctwas_parameters_multi &lt;- summarize_param(param_multi, gwas_n)
pve_pie_by_type_multi &lt;- plot_piechart(ctwas_parameters = ctwas_parameters_multi, colors = colors, by = &quot;type&quot;)
pve_pie_by_context_multi &lt;- plot_piechart(ctwas_parameters = ctwas_parameters_multi, colors = colors, by = &quot;context&quot;)

gridExtra::grid.arrange(pve_pie_by_type_multi,pve_pie_by_context_multi, ncol = 2)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-15-1.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
<div id="fine-mapping-2" class="section level2">
<h2>Fine-mapping</h2>
<pre class="r"><code>susie_alpha_res_multi &lt;- ctwas_res_multi$susie_alpha_res

susie_alpha_res_multi &lt;- anno_susie_alpha_res(susie_alpha_res_multi,
                                        mapping_table = mapping_two,
                                        map_by = &quot;molecular_id&quot;,
                                        drop_unmapped = TRUE)</code></pre>
<pre><code>2024-10-16 11:06:49 INFO::Annotating susie alpha result ...
2024-10-16 11:06:49 INFO::Map molecular traits to genes
2024-10-16 11:06:50 INFO::Split PIPs for molecular traits mapped to multiple genes</code></pre>
<pre class="r"><code>combined_pip_by_type_cs_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;type&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = T)

combined_pip_by_context_cs_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;context&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = T)

DT::datatable(combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$combined_pip&gt;0.8,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Combined PIP by omics&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-d72b6eff4afa454a8832" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d72b6eff4afa454a8832">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Combined PIP by omics<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47"],["GPX1","SMURF1","USP4","HLA-DQB2","SHROOM1","HLA-DQA1","NFKBIL1","WDR6","CCHCR1","TNFRSF6B","AMZ1","CARD9","OAZ3","TRRAP","CCDC36","PTPN2","STAT3","TNFSF15","TSPAN14","MAP3K8","FOSL2","FGFR1OP","HECTD4","ERI3","STARD10","RGS14","MLX","NOD2","NOL4L","ACBD3","CIITA","SBNO2","RORC","MAST2","ZNF300","PTGIR","SP140","IFNGR2","LSP1","FOXN2","ST7L","C10orf107","NR5A2","ITGAL","RAVER1","ITPKC","ZFP36L2"],["3_47685722_49279539.L3","7_97470258_99117851.L1,7_99117851_100599028.L1,7_99117851_100599028.L2","3_47685722_49279539.L1","6_32714887_33268720.L4","5_132803957_135441711.L3,5_132803957_135441711.L2","6_31603441_32714887.L2","6_30830391_31603441.L1","3_47685722_49279539.L2","6_30830391_31603441.L3","20_63558827_64333810.L1","7_2022763_2732593.L1","9_136047132_136605890.L1","1_151566405_153208353.L3,1_151566405_153208353.L2","7_97470258_99117851.L2","3_49279539_51797999.L1","18_11905441_14440800.L1","17_41743558_43694719.L1","9_114257521_115159681.L1","10_79116992_80654923.L1","10_30169909_31618591.L1","2_28375910_28994693.L1","6_166611245_167642155.L1","12_109898914_112825713.L1","1_43292786_44503511.L1","11_72574973_74701306.L1","5_176023592_177824506.L1","17_41743558_43694719.L2","16_48974015_52001911.L1","20_25363595_33027017.L1","1_224750818_226623159.L1","16_10332175_11426305.L2","19_610729_2098397.L1","1_151566405_153208353.L1","1_44503511_46433829.L1","5_149283061_151181737.L1","19_45599439_46646825.L1","2_228506071_230978674.L1","21_33004691_33853161.L1","11_1192365_3644251.L1","2_47985862_49795119.L1","1_111199115_112730684.L1","10_61581937_64034354.L2","1_199270756_200168521.L1","16_29025292_31371622.L1","19_9127717_11173352.L1","19_40478694_41625199.L1","2_43082452_44086664.L1"],[1,1,1,0.999999999998355,0.999999999926454,0.999986155415325,0.99995310092348,0.9991377438049,0.998861037004676,0.998003825013608,0.995333080806046,0.994377820129748,0.982129897105638,0.981324555639873,0.980132456417989,0.966940016000054,0.956054551645171,0.953107959647224,0.950950653626622,0.94029427204205,0.940068958091215,0.924809707420844,0.918677883910833,0.915875171639314,0.914257670397964,0.909148815705105,0.906534629707611,0.904996560256835,0.902474693574743,0.879112416397963,0.874824742281545,0.864880229845087,0.85445237433732,0.851878286985111,0.844166046119141,0.835361155191838,0.831944574524232,0.830030040959451,0.828397964047419,0.827134629486435,0.825634700265946,0.825536826363714,0.816474553994501,0.815830460057985,0.813097703192238,0.808914750873446,0.802829919107168],[null,null,null,null,"5_132803957_135441711.L3","6_31603441_32714887.L2",null,"3_47685722_49279539.L2",null,"20_63558827_64333810.L1",null,"9_136047132_136605890.L1","1_151566405_153208353.L3",null,null,"18_11905441_14440800.L1","17_41743558_43694719.L1","9_114257521_115159681.L1","10_79116992_80654923.L1",null,"2_28375910_28994693.L1","6_166611245_167642155.L1",null,null,"11_72574973_74701306.L1","5_176023592_177824506.L1","17_41743558_43694719.L2",null,null,"1_224750818_226623159.L1","16_10332175_11426305.L2",null,null,null,"5_149283061_151181737.L1","19_45599439_46646825.L1",null,null,"11_1192365_3644251.L1","2_47985862_49795119.L1","1_111199115_112730684.L1",null,"1_199270756_200168521.L1","16_29025292_31371622.L1","19_9127717_11173352.L1","19_40478694_41625199.L1","2_43082452_44086664.L1"],[null,null,null,null,0.0710076090541558,0.999986155415325,null,0.9991377438049,null,0.998003825013608,null,0.994377820129748,0.824746096597807,null,null,0.502448166679489,0.956054551645171,0.953107959647224,0.950950653626622,null,0.0576428777843899,0.773417060357096,null,null,0.303139223797789,0.520162216374777,0.00857069464898086,null,null,0.302686172971314,0.874824742281545,null,null,null,0.813668324675995,0.180916576754584,null,null,0.70994598183052,0.363308987816259,0.0744927515713741,null,0.816474553994501,0.0907838759207994,0.813097703192238,0.808914750873446,0.802829919107168],[null,null,null,null,"5_132803957_135441711.L3",null,null,null,null,null,null,null,"1_151566405_153208353.L2",null,null,"18_11905441_14440800.L1",null,null,null,"10_30169909_31618591.L1",null,"6_166611245_167642155.L1",null,"1_43292786_44503511.L1",null,"5_176023592_177824506.L1","17_41743558_43694719.L2",null,null,null,null,"19_610729_2098397.L1","1_151566405_153208353.L1","1_44503511_46433829.L1","5_149283061_151181737.L1",null,"2_228506071_230978674.L1",null,"11_1192365_3644251.L1","2_47985862_49795119.L1","1_111199115_112730684.L1","10_61581937_64034354.L2",null,null,null,null,null],[null,null,null,null,0.00503474127030556,null,null,null,null,null,null,null,0.628224169759548,null,null,0.464617635077724,null,null,null,0.0542719224141012,null,0.151392647063748,null,0.915875171639314,null,0.127261996093448,0.0495426920762503,null,null,null,null,0.864880229845087,0.85445237433732,0.851878286985111,0.0304999289678012,null,0.304390416242979,null,0.118451982216898,0.15023412006641,0.252642128592412,0.825536826363714,null,null,null,null,null],["3_47685722_49279539.L3","7_97470258_99117851.L1,7_99117851_100599028.L1,7_99117851_100599028.L2","3_47685722_49279539.L1","6_32714887_33268720.L4","5_132803957_135441711.L3,5_132803957_135441711.L2",null,"6_30830391_31603441.L1",null,"6_30830391_31603441.L3",null,"7_2022763_2732593.L1",null,"1_151566405_153208353.L2","7_97470258_99117851.L2","3_49279539_51797999.L1",null,null,null,null,"10_30169909_31618591.L1","2_28375910_28994693.L1",null,"12_109898914_112825713.L1",null,"11_72574973_74701306.L1","5_176023592_177824506.L1","17_41743558_43694719.L2","16_48974015_52001911.L1","20_25363595_33027017.L1","1_224750818_226623159.L1",null,null,null,null,null,"19_45599439_46646825.L1","2_228506071_230978674.L1","21_33004691_33853161.L1",null,"2_47985862_49795119.L1","1_111199115_112730684.L1",null,null,"16_29025292_31371622.L1",null,null,null],[1,1,1,0.999999999998355,0.999999999920234,null,0.99995310092348,null,0.998861037004676,null,0.995333080806046,null,0.269803101679106,0.981324555639873,0.980132456417989,null,null,null,null,0.886022349627949,0.882426080306825,null,0.918677883910833,null,0.611118446600174,0.26172460323688,0.848673494441572,0.904996560256835,0.902474693574743,0.576426243426649,null,null,null,null,null,0.654489802653494,0.527554158281254,0.830030040959451,null,0.313591521603766,0.498499820102159,null,null,0.725046584137185,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_cs_id<\/th>\n      <th>eQTL_pip<\/th>\n      <th>sQTL_cs_id<\/th>\n      <th>sQTL_pip<\/th>\n      <th>stQTL_cs_id<\/th>\n      <th>stQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>DT::datatable(combined_pip_by_context_cs_multi[combined_pip_by_context_cs_multi$combined_pip&gt;0.8,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Combined PIP by tissue&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-73d12cd98287c4e0164c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-73d12cd98287c4e0164c">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Combined PIP by tissue<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47"],["GPX1","SMURF1","USP4","HLA-DQB2","SHROOM1","HLA-DQA1","NFKBIL1","WDR6","CCHCR1","TNFRSF6B","AMZ1","CARD9","OAZ3","TRRAP","CCDC36","PTPN2","STAT3","TNFSF15","TSPAN14","MAP3K8","FOSL2","FGFR1OP","HECTD4","ERI3","STARD10","RGS14","MLX","NOD2","NOL4L","ACBD3","CIITA","SBNO2","RORC","MAST2","ZNF300","PTGIR","SP140","IFNGR2","LSP1","FOXN2","ST7L","C10orf107","NR5A2","ITGAL","RAVER1","ITPKC","ZFP36L2"],["3_47685722_49279539.L3","7_97470258_99117851.L1,7_99117851_100599028.L1,7_99117851_100599028.L2","3_47685722_49279539.L1","6_32714887_33268720.L4","5_132803957_135441711.L3,5_132803957_135441711.L2","6_31603441_32714887.L2","6_30830391_31603441.L1","3_47685722_49279539.L2","6_30830391_31603441.L3","20_63558827_64333810.L1","7_2022763_2732593.L1","9_136047132_136605890.L1","1_151566405_153208353.L3,1_151566405_153208353.L2","7_97470258_99117851.L2","3_49279539_51797999.L1","18_11905441_14440800.L1","17_41743558_43694719.L1","9_114257521_115159681.L1","10_79116992_80654923.L1","10_30169909_31618591.L1","2_28375910_28994693.L1","6_166611245_167642155.L1","12_109898914_112825713.L1","1_43292786_44503511.L1","11_72574973_74701306.L1","5_176023592_177824506.L1","17_41743558_43694719.L2","16_48974015_52001911.L1","20_25363595_33027017.L1","1_224750818_226623159.L1","16_10332175_11426305.L2","19_610729_2098397.L1","1_151566405_153208353.L1","1_44503511_46433829.L1","5_149283061_151181737.L1","19_45599439_46646825.L1","2_228506071_230978674.L1","21_33004691_33853161.L1","11_1192365_3644251.L1","2_47985862_49795119.L1","1_111199115_112730684.L1","10_61581937_64034354.L2","1_199270756_200168521.L1","16_29025292_31371622.L1","19_9127717_11173352.L1","19_40478694_41625199.L1","2_43082452_44086664.L1"],[1,1,1,0.999999999998355,0.999999999926454,0.999986155415325,0.99995310092348,0.9991377438049,0.998861037004676,0.998003825013608,0.995333080806046,0.994377820129748,0.982129897105638,0.981324555639873,0.980132456417989,0.966940016000054,0.956054551645171,0.953107959647224,0.950950653626622,0.94029427204205,0.940068958091215,0.924809707420844,0.918677883910833,0.915875171639314,0.914257670397964,0.909148815705105,0.906534629707611,0.904996560256835,0.902474693574743,0.879112416397963,0.874824742281545,0.864880229845087,0.85445237433732,0.851878286985111,0.844166046119141,0.835361155191838,0.831944574524232,0.830030040959451,0.828397964047419,0.827134629486435,0.825634700265946,0.825536826363714,0.816474553994501,0.815830460057985,0.813097703192238,0.808914750873446,0.802829919107168],[null,null,null,null,"5_132803957_135441711.L2",null,null,"3_47685722_49279539.L2","6_30830391_31603441.L3",null,null,"9_136047132_136605890.L1","1_151566405_153208353.L3",null,null,"18_11905441_14440800.L1","17_41743558_43694719.L1","9_114257521_115159681.L1",null,"10_30169909_31618591.L1","2_28375910_28994693.L1",null,null,null,"11_72574973_74701306.L1","5_176023592_177824506.L1","17_41743558_43694719.L2","16_48974015_52001911.L1",null,"1_224750818_226623159.L1",null,null,null,"1_44503511_46433829.L1","5_149283061_151181737.L1","19_45599439_46646825.L1","2_228506071_230978674.L1",null,null,"2_47985862_49795119.L1","1_111199115_112730684.L1",null,null,"16_29025292_31371622.L1","19_9127717_11173352.L1",null,"2_43082452_44086664.L1"],[null,null,null,null,0.999999999919422,null,null,0.488155645375222,0.998861037004676,null,null,0.47775252822455,0.439705256305676,null,null,0.0915338938487088,0.696118342833195,0.260509378738824,null,0.0585530198616138,0.0576428777843899,null,null,null,0.228385976432952,0.120010628211842,0.0155901952830267,0.904996560256835,null,0.324223571617969,null,null,null,0.12815354422544,0.608828065443755,0.0271183445817497,0.198497280311885,null,null,0.0465349052873391,0.0903437965229265,null,null,0.0414936195681687,0.813097703192238,null,0.436175829011862],[null,null,null,null,"5_132803957_135441711.L3","6_31603441_32714887.L2",null,"3_47685722_49279539.L2",null,null,null,"9_136047132_136605890.L1","1_151566405_153208353.L3","7_97470258_99117851.L2",null,"18_11905441_14440800.L1",null,null,null,"10_30169909_31618591.L1",null,"6_166611245_167642155.L1",null,"1_43292786_44503511.L1","11_72574973_74701306.L1","5_176023592_177824506.L1","17_41743558_43694719.L2",null,"20_25363595_33027017.L1",null,"16_10332175_11426305.L2","19_610729_2098397.L1",null,"1_44503511_46433829.L1",null,"19_45599439_46646825.L1",null,null,"11_1192365_3644251.L1","2_47985862_49795119.L1","1_111199115_112730684.L1","10_61581937_64034354.L2","1_199270756_200168521.L1","16_29025292_31371622.L1",null,"19_40478694_41625199.L1","2_43082452_44086664.L1"],[null,null,null,null,0.081297819439443,0.999986155415325,null,0.304346930021599,null,null,null,0.24563426169858,0.22083586771744,0.981324555639873,null,0.297922445130381,null,null,null,0.557695083425997,null,0.79629984406514,null,0.552235276665117,0.596982619333989,0.14107180744025,0.744250004912578,null,0.896887360878436,null,0.874824742281545,0.497731052558936,null,0.346987497280492,null,0.654489802653494,null,null,0.50693812481256,0.117643123312121,0.233116488755396,0.591510325287438,0.816474553994501,0.000579387258347275,null,0.0991246401489935,0.22428644833707],[null,"7_99117851_100599028.L1",null,null,null,null,"6_30830391_31603441.L1","3_47685722_49279539.L2",null,"20_63558827_64333810.L1",null,null,"1_151566405_153208353.L3",null,null,"18_11905441_14440800.L1","17_41743558_43694719.L1","9_114257521_115159681.L1","10_79116992_80654923.L1","10_30169909_31618591.L1","2_28375910_28994693.L1","6_166611245_167642155.L1",null,"1_43292786_44503511.L1","11_72574973_74701306.L1","5_176023592_177824506.L1","17_41743558_43694719.L2",null,null,"1_224750818_226623159.L1",null,null,null,"1_44503511_46433829.L1","5_149283061_151181737.L1",null,null,null,null,"2_47985862_49795119.L1","1_111199115_112730684.L1",null,null,"16_29025292_31371622.L1",null,"19_40478694_41625199.L1",null],[null,0.734826801808446,null,null,null,null,0.99995310092348,0.0705576675328171,null,0.998003825013608,null,null,0.164209838486659,null,null,0.577632533877826,0.259981888755821,0.369321210939558,0.950950653626622,0.162260190660317,0.882426080306825,0.0393210785552507,null,0.264077542751902,0.0824260332542419,0.502564843117655,0.124643218248593,null,null,0.0853941735750439,null,null,null,0.165928562551848,0.00287170186427255,null,null,null,null,0.0572068528250238,0.14748827585951,null,null,0.0907838759207994,null,0.501965371881774,null],["3_47685722_49279539.L3","7_99117851_100599028.L2","3_47685722_49279539.L1","6_32714887_33268720.L4",null,null,null,"3_47685722_49279539.L2",null,null,"7_2022763_2732593.L1","9_136047132_136605890.L1",null,null,null,null,null,"9_114257521_115159681.L1",null,"10_30169909_31618591.L1",null,"6_166611245_167642155.L1",null,"1_43292786_44503511.L1","11_72574973_74701306.L1","5_176023592_177824506.L1","17_41743558_43694719.L2",null,null,null,null,"19_610729_2098397.L1",null,"1_44503511_46433829.L1","5_149283061_151181737.L1","19_45599439_46646825.L1","2_228506071_230978674.L1",null,"11_1192365_3644251.L1","2_47985862_49795119.L1","1_111199115_112730684.L1","10_61581937_64034354.L2",null,"16_29025292_31371622.L1",null,"19_40478694_41625199.L1","2_43082452_44086664.L1"],[1,0.944692139397425,1,0.999999999998355,null,null,null,0.136077500875262,null,null,0.995333080806046,0.271011965224248,null,null,null,null,null,0.323288554188544,null,0.136895316946269,null,0.0148248087742788,null,0.099562352222295,0.00646304137678144,0.0124509509204637,0.00857069464898086,null,null,null,null,0.0565856048775408,null,0.0511287151016686,0.199029521062636,0.15380570742522,0.357787162494198,null,0.275948128999698,0.359721218513229,0.198051251398589,0.0524797672630637,null,0.677533723598648,null,0.207824738842679,0.142615184739172],[null,"7_97470258_99117851.L1",null,null,null,null,null,null,null,null,null,null,"1_151566405_153208353.L2",null,"3_49279539_51797999.L1",null,null,null,null,"10_30169909_31618591.L1",null,"6_166611245_167642155.L1","12_109898914_112825713.L1",null,null,"5_176023592_177824506.L1","17_41743558_43694719.L2",null,"20_25363595_33027017.L1","1_224750818_226623159.L1",null,"19_610729_2098397.L1","1_151566405_153208353.L1","1_44503511_46433829.L1","5_149283061_151181737.L1",null,"2_228506071_230978674.L1","21_33004691_33853161.L1","11_1192365_3644251.L1","2_47985862_49795119.L1","1_111199115_112730684.L1","10_61581937_64034354.L2",null,"16_29025292_31371622.L1",null,null,null],[null,1,null,null,null,null,null,null,null,null,null,null,0.898005982277331,null,0.980132456417989,null,null,null,null,0.0248906611478539,null,0.0743639760261743,0.918677883910833,null,null,0.133050586014894,0.0137530935560529,null,0.00558733269630751,0.469494671204951,null,0.31056357240861,0.85445237433732,0.159679967825662,0.033440231003297,null,0.275660131718149,0.830030040959451,0.0455117102351611,0.246028529548722,0.156634887729523,0.181619625784658,null,0.00543985371202127,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>Whole_Blood_cs_id<\/th>\n      <th>Whole_Blood_pip<\/th>\n      <th>Adipose_Subcutaneous_cs_id<\/th>\n      <th>Adipose_Subcutaneous_pip<\/th>\n      <th>Cells_Cultured_fibroblasts_cs_id<\/th>\n      <th>Cells_Cultured_fibroblasts_pip<\/th>\n      <th>Spleen_cs_id<\/th>\n      <th>Spleen_pip<\/th>\n      <th>Testis_cs_id<\/th>\n      <th>Testis_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9,11,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>combined_pip_by_group_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;group&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = F)

combined_pip_by_group_sig_multi &lt;- combined_pip_by_group_multi[combined_pip_by_group_multi$combined_pip &gt; 0.8,]

plot_heatmap(heatmap_data = combined_pip_by_group_sig_multi, main = &quot;PIP partitions for genes with PIP&gt;0.8&quot;)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-16-3.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
<div id="comparing-with-single-tissue-eqtl-analysis-2"
class="section level2">
<h2>Comparing with single tissue + eQTL analysis</h2>
<pre class="r"><code>ctwas_res_single &lt;- readRDS(paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/10.single_tissue_1007/results/&quot;,trait,&quot;/&quot;,tissue[1],&quot;/&quot;,trait,&quot;_&quot;,tissue[1], &quot;.ctwas.res.RDS&quot;))

susie_alpha_res_single &lt;- ctwas_res_single$susie_alpha_res

susie_alpha_res_single &lt;- anno_susie_alpha_res(susie_alpha_res_single,
                                        mapping_table = mapping_predictdb,
                                        map_by = &quot;molecular_id&quot;,
                                        drop_unmapped = TRUE)</code></pre>
<pre><code>2024-10-16 11:07:00 INFO::Annotating susie alpha result ...
2024-10-16 11:07:00 INFO::Map molecular traits to genes</code></pre>
<pre class="r"><code>combined_pip_by_type_single &lt;- combine_gene_pips(susie_alpha_res_single, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;type&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = F)

combined_pip_by_type_sig_single &lt;- combined_pip_by_type_single[combined_pip_by_type_single$combined_pip &gt; 0.8,]
combined_pip_by_type_sig_multi &lt;- combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$combined_pip &gt; 0.8,]

sprintf(&quot;Number of genes with PIP &gt; 0.8  -- Multi-group = %s&quot;, nrow(combined_pip_by_type_sig_multi))</code></pre>
<pre><code>[1] &quot;Number of genes with PIP &gt; 0.8  -- Multi-group = 47&quot;</code></pre>
<pre class="r"><code>sprintf(&quot;Number of genes with PIP &gt; 0.8  -- single eQTL = %s&quot;, nrow(combined_pip_by_type_sig_single))</code></pre>
<pre><code>[1] &quot;Number of genes with PIP &gt; 0.8  -- single eQTL = 11&quot;</code></pre>
<pre class="r"><code>sprintf(&quot;Number of overlapped genes = %s&quot;, sum(combined_pip_by_type_sig_single$gene_name %in% combined_pip_by_type_sig_multi$gene_name))</code></pre>
<pre><code>[1] &quot;Number of overlapped genes = 7&quot;</code></pre>
<pre class="r"><code>genes_not_reported &lt;- combined_pip_by_type_sig_single$gene_name[!combined_pip_by_type_sig_single$gene_name %in%combined_pip_by_type_sig_multi$gene_name]

DT::datatable(combined_pip_by_type_sig_single[combined_pip_by_type_sig_single$gene_name %in% genes_not_reported,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Genes not reported by multi-group analysis&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-0796cbf5802287e6981e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-0796cbf5802287e6981e">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Genes not reported by multi-group analysis<\/caption>","data":[["3","4","7","8"],["BRD7","SOCS1","MRPL20","CCR5"],[0.99133442723088,0.966479668757584,0.904535336435535,0.876648606888991],[0.99133442723088,0.966479668757584,0.904535336435535,0.876648606888991]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>DT::datatable(combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$gene_name %in% genes_not_reported,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Genes not reported by multi-group analysis&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-35c46d2ddbc1fab8b4dc" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-35c46d2ddbc1fab8b4dc">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Genes not reported by multi-group analysis<\/caption>","data":[["72","179"],["MRPL20","SOCS1"],["1_10583_1961168.L1","16_10332175_11426305.L1"],[0.555256642823688,0.0762864488673555],["1_10583_1961168.L1","16_10332175_11426305.L1"],[0.533580111692814,0.0762864488673555],["1_10583_1961168.L1",null],[0.0216796803713067,null],[null,null],[null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_cs_id<\/th>\n      <th>eQTL_pip<\/th>\n      <th>sQTL_cs_id<\/th>\n      <th>sQTL_pip<\/th>\n      <th>stQTL_cs_id<\/th>\n      <th>stQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>gene_multi_unique_type &lt;- combined_pip_by_group_sig_multi[!combined_pip_by_group_sig_multi$gene_name %in%  combined_pip_by_type_sig_single$gene_name,]

plot_heatmap(heatmap_data = gene_multi_unique_type, main = &quot;PIP partition for unique genes found by multi-group analysis&quot;)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-18-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-18-1">
Past versions of unnamed-chunk-18-1.png
</button>
</p>
<div id="fig-unnamed-chunk-18-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/4a84d72e7453cf3617b2b5a0fdd798d0595620e2/docs/figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-18-1.png" target="_blank">4a84d72</a>
</td>
<td>
XSun
</td>
<td>
2024-10-15
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="sbp-ukb-a-360" class="section level1">
<h1>SBP-ukb-a-360</h1>
<div id="parameter-2" class="section level2">
<h2>Parameter</h2>
<pre class="r"><code>trait &lt;- &quot;SBP-ukb-a-360&quot;
gwas_n &lt;- samplesize[trait]
tissue &lt;- c(&quot;Artery_Tibial&quot;,&quot;Heart_Atrial_Appendage&quot;,&quot;Adipose_Subcutaneous&quot;,&quot;Brain_Cortex&quot;,&quot;Skin_Sun_Exposed_Lower_leg&quot;)


results_dir_multi &lt;- paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/results/&quot;,trait,&quot;/&quot;)
ctwas_res_multi &lt;- readRDS(paste0(results_dir_multi,trait,&quot;.ctwas.res.RDS&quot;))

param_multi &lt;- ctwas_res_multi$param
make_convergence_plots(param_multi, gwas_n, colors = colors)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-19-1.png" width="1152" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ctwas_parameters_multi &lt;- summarize_param(param_multi, gwas_n)
pve_pie_by_type_multi &lt;- plot_piechart(ctwas_parameters = ctwas_parameters_multi, colors = colors, by = &quot;type&quot;)
pve_pie_by_context_multi &lt;- plot_piechart(ctwas_parameters = ctwas_parameters_multi, colors = colors, by = &quot;context&quot;)

gridExtra::grid.arrange(pve_pie_by_type_multi,pve_pie_by_context_multi, ncol = 2)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-20-1.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
<div id="fine-mapping-3" class="section level2">
<h2>Fine-mapping</h2>
<pre class="r"><code>susie_alpha_res_multi &lt;- ctwas_res_multi$susie_alpha_res

susie_alpha_res_multi &lt;- anno_susie_alpha_res(susie_alpha_res_multi,
                                        mapping_table = mapping_two,
                                        map_by = &quot;molecular_id&quot;,
                                        drop_unmapped = TRUE)</code></pre>
<pre><code>2024-10-16 11:07:16 INFO::Annotating susie alpha result ...
2024-10-16 11:07:16 INFO::Map molecular traits to genes
2024-10-16 11:07:17 INFO::Split PIPs for molecular traits mapped to multiple genes</code></pre>
<pre class="r"><code>combined_pip_by_type_cs_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;type&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = T)

combined_pip_by_context_cs_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;context&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = T)

DT::datatable(combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$combined_pip&gt;0.8,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Combined PIP by omics&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-2a1b6e0e6b8a75d77da4" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2a1b6e0e6b8a75d77da4">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Combined PIP by omics<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70"],["EFTUD2","RHOA","SLC16A7","USP38","AMT","MYOZ1","ULK4","NR1H3","BAG6","CNNM2","ASCC2","NUDT16L1","EML1","PRKAB1","FBXO38","TRPM7","USP4","CCNT2","TMBIM1","SWAP70","ADHFE1","RCC1L","PAQR5","THBS2","DENND2A","CLCN6","GDF7","PSMG1","PHACTR1","TNNT3","GOLGB1","SLC20A2","SLC9A3R2","OLA1","ENPEP","SIPA1","TBX2","LCORL","ZNF827","RAB34","MRPL10","MORC3","NPR1","KCNK3","IGHMBP2","SEPT9","HSCB","GNA11","MEX3A","GIT2","LRRC10B","MRC2","NAA60","FHOD3","RSRC1","P4HA3","ZNF467","SCMH1","EHD4","CAV2","CERS5","CRK","NGF","GNPDA1","TMEM133","PGPEP1","MAT1A","DYNC1I2","HFE","FERMT2"],["17_43694719_44979537.L1,17_43694719_44979537.L4,17_43694719_44979537.L3","3_47685722_49279539.L2,3_49279539_51797999.L3","12_58914885_60729948.L1","4_142522112_145257035.L1","3_49279539_51797999.L1","10_71748755_73662792.L1","3_41023037_42498510.L1","11_44672249_46984586.L1,11_46984586_49844498.L1","6_31603441_32714887.L1,6_31603441_32714887.L3","10_102620653_104935290.L1","22_29255810_31043932.L1","16_3951195_5068344.L2","14_98672195_101067970.L1","12_119316305_121569746.L1","5_147802435_149283061.L2","15_49715846_51385363.L4","3_47685722_49279539.L2,3_49279539_51797999.L2","2_134401007_136285224.L1","2_217530757_219589829.L1","11_9065770_10930480.L4","8_65576855_68950822.L2","7_73920272_76829247.L1","15_68725660_69841002.L1","6_168981955_170014949.L1","7_140535410_141526757.L1","1_11717784_12719464.L1,1_11717784_12719464.L2","2_19492643_20850730.L2","21_39110976_40017600.L1","6_11790583_13209156.L1","11_1192365_3644251.L1","3_120804208_122255250.L1","8_41863936_42918680.L1","16_1157206_2714828.L1","2_172274177_174724201.L1,2_172274177_174724201.L3","4_110335411_112948946.L2","11_64037097_66131160.L1","17_61235394_63468228.L1","4_17381699_18840251.L1","4_145257035_147600722.L1","17_21387045_29007226.L1","17_47798656_49440038.L2","21_35152076_36498481.L1","1_153208353_154797927.L1","2_26672117_28375910.L1","11_68238358_69701362.L1","17_76379479_78267332.L1","22_27438791_29255810.L3","19_3019662_4348970.L1","1_154797927_156366342.L1","12_108632125_109898914.L1,12_109898914_112825713.L4","11_59013076_62456299.L1","17_61235394_63468228.L2","16_2714828_3951195.L1","18_36282001_37495287.L1","3_157594239_159760101.L1","11_72574973_74701306.L1","7_148118226_150143569.L1","1_39734895_41509656.L1","15_40885316_42484201.L2","7_114072332_117140124.L1","12_48608083_51382710.L1","17_1269105_2025437.L1","1_114331223_115337972.L2","5_141266403_143601683.L1","11_100546438_101460390.L1","19_18299052_19766662.L1","10_79116992_80654923.L1","2_170369735_172274177.L1","6_25684359_26791023.L1","14_51026854_53007665.L1"],[1,1,0.999999999999822,0.999999992562229,0.999999958235712,0.999999888841081,0.999999667430132,0.999997263196943,0.999980250147821,0.999966938080254,0.999253322194235,0.998660298466206,0.997957108531544,0.997692659186045,0.997555873944459,0.99586535206097,0.994404129970148,0.994335484087373,0.993410252183045,0.99301885038444,0.991951617136844,0.991282047005517,0.987906115502409,0.986185578225383,0.984577422783082,0.984493081875278,0.981833879492298,0.981704210988021,0.979337497529834,0.978580213475925,0.971570112096555,0.970713581798853,0.969915180915625,0.964805227059594,0.960426710570996,0.958747444057798,0.957783554977889,0.957300546017453,0.95688958678158,0.952473646751356,0.952426018165499,0.946111937964116,0.94171439751819,0.940554396334433,0.930558071463087,0.923495790965174,0.923431824954831,0.922973097319096,0.92092985964253,0.913523049714622,0.89879156440623,0.883774583350375,0.880173579293423,0.869036336449628,0.867746612720329,0.866944073491087,0.864459304748226,0.860499863581522,0.859910652855592,0.855059387927126,0.847626732078948,0.840378940224767,0.834698276000398,0.832400187401178,0.8300599029111,0.82950796094199,0.824928604544971,0.819556553124349,0.816170332303603,0.801227808564293],[null,null,null,null,null,null,"3_41023037_42498510.L1","11_46984586_49844498.L1","6_31603441_32714887.L1",null,"22_29255810_31043932.L1","16_3951195_5068344.L2","14_98672195_101067970.L1",null,null,null,null,null,null,null,"8_65576855_68950822.L2",null,"15_68725660_69841002.L1","6_168981955_170014949.L1",null,"1_11717784_12719464.L1","2_19492643_20850730.L2",null,"6_11790583_13209156.L1",null,null,"8_41863936_42918680.L1",null,"2_172274177_174724201.L1","4_110335411_112948946.L2","11_64037097_66131160.L1","17_61235394_63468228.L1","4_17381699_18840251.L1","4_145257035_147600722.L1",null,null,"21_35152076_36498481.L1",null,"2_26672117_28375910.L1",null,null,"22_27438791_29255810.L3",null,"1_154797927_156366342.L1","12_109898914_112825713.L4","11_59013076_62456299.L1",null,null,"18_36282001_37495287.L1","3_157594239_159760101.L1","11_72574973_74701306.L1","7_148118226_150143569.L1","1_39734895_41509656.L1","15_40885316_42484201.L2","7_114072332_117140124.L1",null,"17_1269105_2025437.L1","1_114331223_115337972.L2","5_141266403_143601683.L1","11_100546438_101460390.L1","19_18299052_19766662.L1","10_79116992_80654923.L1","2_170369735_172274177.L1","6_25684359_26791023.L1",null],[null,null,null,null,null,null,0.999999667430132,0.0525079606974973,0.833831140660597,null,0.999253322194235,0.998660298466206,0.997957108531544,null,null,null,null,null,null,null,0.0570562197873343,null,0.987906115502409,0.986185578225383,null,0.946047428001998,0.981833879492298,null,0.979337497529834,null,null,0.970713581798853,null,0.0253273635136718,0.960426710570996,0.92231500608805,0.0660920740423034,0.957300546017453,0.95688958678158,null,null,0.946111937964116,null,0.940554396334433,null,null,0.508662238297236,null,0.92092985964253,0.0361567701253822,0.89879156440623,null,null,0.000410648949839443,0.752007922933669,0.866944073491087,0.499579106852209,0.72353758558299,0.859910652855592,0.555959141539889,null,0.840378940224767,0.834698276000398,0.831930763871364,0.8300599029111,0.82950796094199,0.577136810818659,0.358882540796064,0.579467756986576,null],["17_43694719_44979537.L1",null,"12_58914885_60729948.L1","4_142522112_145257035.L1",null,null,null,"11_46984586_49844498.L1","6_31603441_32714887.L3","10_102620653_104935290.L1",null,null,null,"12_119316305_121569746.L1","5_147802435_149283061.L2","15_49715846_51385363.L4","3_49279539_51797999.L2","2_134401007_136285224.L1","2_217530757_219589829.L1",null,"8_65576855_68950822.L2",null,null,null,null,"1_11717784_12719464.L2",null,"21_39110976_40017600.L1",null,"11_1192365_3644251.L1","3_120804208_122255250.L1",null,null,"2_172274177_174724201.L3",null,"11_64037097_66131160.L1",null,null,null,"17_21387045_29007226.L1",null,null,"1_153208353_154797927.L1",null,"11_68238358_69701362.L1","17_76379479_78267332.L1","22_27438791_29255810.L3",null,null,"12_109898914_112825713.L4",null,"17_61235394_63468228.L2",null,"18_36282001_37495287.L1",null,null,"7_148118226_150143569.L1","1_39734895_41509656.L1",null,"7_114072332_117140124.L1","12_48608083_51382710.L1",null,null,null,null,null,null,"2_170369735_172274177.L1","6_25684359_26791023.L1","14_51026854_53007665.L1"],[0.676279408562686,null,0.999999999999822,0.999999992562229,null,null,null,0.0848705260845406,0.99988114586652,0.999966938080254,null,null,null,0.997692659186045,0.997555873944459,0.99586535206097,0.994380716922226,0.994335484087373,0.993410252183045,null,0.934895397349509,null,null,null,null,0.712582411728289,null,0.981704210988021,null,0.978580213475925,0.971570112096555,null,null,0.273982557447139,null,0.0364324379697479,null,null,null,0.952473646751356,null,null,0.94171439751819,null,0.930558071463087,0.923495790965174,0.416936861411805,null,null,0.456281249121858,null,0.883774583350375,null,0.868276549390219,null,null,0.0423953003579634,0.0602996707851416,null,0.299127706306148,0.111277701473431,null,null,null,null,null,null,0.165862982246093,0.236702575317027,0.224024704446799],["17_43694719_44979537.L4,17_43694719_44979537.L3","3_47685722_49279539.L2,3_49279539_51797999.L3",null,null,"3_49279539_51797999.L1","10_71748755_73662792.L1",null,"11_44672249_46984586.L1,11_46984586_49844498.L1",null,null,null,null,null,null,null,null,"3_47685722_49279539.L2",null,null,"11_9065770_10930480.L4",null,"7_73920272_76829247.L1",null,null,"7_140535410_141526757.L1",null,null,null,null,null,null,null,"16_1157206_2714828.L1","2_172274177_174724201.L1",null,null,"17_61235394_63468228.L1",null,null,null,"17_47798656_49440038.L2",null,null,null,null,null,null,"19_3019662_4348970.L1",null,"12_108632125_109898914.L1,12_109898914_112825713.L4",null,null,"16_2714828_3951195.L1","18_36282001_37495287.L1","3_157594239_159760101.L1",null,"7_148118226_150143569.L1","1_39734895_41509656.L1",null,null,"12_48608083_51382710.L1",null,null,"5_141266403_143601683.L1",null,null,"10_79116992_80654923.L1","2_170369735_172274177.L1",null,"14_51026854_53007665.L1"],[1,1,null,null,0.999999958235712,0.999999888841081,null,0.999996824102221,null,null,null,null,null,null,null,null,0.00416655427357793,null,null,0.99301885038444,null,0.991282047005517,null,null,0.984577422783082,null,null,null,null,null,null,null,0.969915180915625,0.925230764668865,null,null,0.891691771923453,null,null,null,0.952426018165499,null,null,null,null,null,null,0.922973097319096,null,0.817337050842775,null,null,0.880173579293423,0.000349138109569158,0.115738689786661,null,0.322484897538053,0.0766626072133901,null,null,0.736349507856463,null,null,0.000469423529814605,null,null,0.247791793726313,0.294860972589845,null,0.577203104117494]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_cs_id<\/th>\n      <th>eQTL_pip<\/th>\n      <th>sQTL_cs_id<\/th>\n      <th>sQTL_pip<\/th>\n      <th>stQTL_cs_id<\/th>\n      <th>stQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>DT::datatable(combined_pip_by_context_cs_multi[combined_pip_by_context_cs_multi$combined_pip&gt;0.8,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Combined PIP by tissue&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-f41426fe0b90d0c09df4" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f41426fe0b90d0c09df4">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Combined PIP by tissue<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70"],["EFTUD2","RHOA","SLC16A7","USP38","AMT","MYOZ1","ULK4","NR1H3","BAG6","CNNM2","ASCC2","NUDT16L1","EML1","PRKAB1","FBXO38","TRPM7","USP4","CCNT2","TMBIM1","SWAP70","ADHFE1","RCC1L","PAQR5","THBS2","DENND2A","CLCN6","GDF7","PSMG1","PHACTR1","TNNT3","GOLGB1","SLC20A2","SLC9A3R2","OLA1","ENPEP","SIPA1","TBX2","LCORL","ZNF827","RAB34","MRPL10","MORC3","NPR1","KCNK3","IGHMBP2","SEPT9","HSCB","GNA11","MEX3A","GIT2","LRRC10B","MRC2","NAA60","FHOD3","RSRC1","P4HA3","ZNF467","SCMH1","EHD4","CAV2","CERS5","CRK","NGF","GNPDA1","TMEM133","PGPEP1","MAT1A","DYNC1I2","HFE","FERMT2"],["17_43694719_44979537.L1,17_43694719_44979537.L4,17_43694719_44979537.L3","3_47685722_49279539.L2,3_49279539_51797999.L3","12_58914885_60729948.L1","4_142522112_145257035.L1","3_49279539_51797999.L1","10_71748755_73662792.L1","3_41023037_42498510.L1","11_44672249_46984586.L1,11_46984586_49844498.L1","6_31603441_32714887.L1,6_31603441_32714887.L3","10_102620653_104935290.L1","22_29255810_31043932.L1","16_3951195_5068344.L2","14_98672195_101067970.L1","12_119316305_121569746.L1","5_147802435_149283061.L2","15_49715846_51385363.L4","3_47685722_49279539.L2,3_49279539_51797999.L2","2_134401007_136285224.L1","2_217530757_219589829.L1","11_9065770_10930480.L4","8_65576855_68950822.L2","7_73920272_76829247.L1","15_68725660_69841002.L1","6_168981955_170014949.L1","7_140535410_141526757.L1","1_11717784_12719464.L1,1_11717784_12719464.L2","2_19492643_20850730.L2","21_39110976_40017600.L1","6_11790583_13209156.L1","11_1192365_3644251.L1","3_120804208_122255250.L1","8_41863936_42918680.L1","16_1157206_2714828.L1","2_172274177_174724201.L1,2_172274177_174724201.L3","4_110335411_112948946.L2","11_64037097_66131160.L1","17_61235394_63468228.L1","4_17381699_18840251.L1","4_145257035_147600722.L1","17_21387045_29007226.L1","17_47798656_49440038.L2","21_35152076_36498481.L1","1_153208353_154797927.L1","2_26672117_28375910.L1","11_68238358_69701362.L1","17_76379479_78267332.L1","22_27438791_29255810.L3","19_3019662_4348970.L1","1_154797927_156366342.L1","12_108632125_109898914.L1,12_109898914_112825713.L4","11_59013076_62456299.L1","17_61235394_63468228.L2","16_2714828_3951195.L1","18_36282001_37495287.L1","3_157594239_159760101.L1","11_72574973_74701306.L1","7_148118226_150143569.L1","1_39734895_41509656.L1","15_40885316_42484201.L2","7_114072332_117140124.L1","12_48608083_51382710.L1","17_1269105_2025437.L1","1_114331223_115337972.L2","5_141266403_143601683.L1","11_100546438_101460390.L1","19_18299052_19766662.L1","10_79116992_80654923.L1","2_170369735_172274177.L1","6_25684359_26791023.L1","14_51026854_53007665.L1"],[1,1,0.999999999999822,0.999999992562229,0.999999958235712,0.999999888841081,0.999999667430132,0.999997263196943,0.999980250147821,0.999966938080254,0.999253322194235,0.998660298466206,0.997957108531544,0.997692659186045,0.997555873944459,0.99586535206097,0.994404129970148,0.994335484087373,0.993410252183045,0.99301885038444,0.991951617136844,0.991282047005517,0.987906115502409,0.986185578225383,0.984577422783082,0.984493081875278,0.981833879492298,0.981704210988021,0.979337497529834,0.978580213475925,0.971570112096555,0.970713581798853,0.969915180915625,0.964805227059594,0.960426710570996,0.958747444057798,0.957783554977889,0.957300546017453,0.95688958678158,0.952473646751356,0.952426018165499,0.946111937964116,0.94171439751819,0.940554396334433,0.930558071463087,0.923495790965174,0.923431824954831,0.922973097319096,0.92092985964253,0.913523049714622,0.89879156440623,0.883774583350375,0.880173579293423,0.869036336449628,0.867746612720329,0.866944073491087,0.864459304748226,0.860499863581522,0.859910652855592,0.855059387927126,0.847626732078948,0.840378940224767,0.834698276000398,0.832400187401178,0.8300599029111,0.82950796094199,0.824928604544971,0.819556553124349,0.816170332303603,0.801227808564293],["17_43694719_44979537.L1","3_47685722_49279539.L2",null,null,null,null,"3_41023037_42498510.L1","11_46984586_49844498.L1","6_31603441_32714887.L1,6_31603441_32714887.L3","10_102620653_104935290.L1",null,null,"14_98672195_101067970.L1",null,"5_147802435_149283061.L2","15_49715846_51385363.L4","3_49279539_51797999.L2","2_134401007_136285224.L1","2_217530757_219589829.L1",null,"8_65576855_68950822.L2","7_73920272_76829247.L1","15_68725660_69841002.L1","6_168981955_170014949.L1",null,null,"2_19492643_20850730.L2",null,"6_11790583_13209156.L1","11_1192365_3644251.L1","3_120804208_122255250.L1","8_41863936_42918680.L1",null,"2_172274177_174724201.L1",null,"11_64037097_66131160.L1","17_61235394_63468228.L1",null,"4_145257035_147600722.L1","17_21387045_29007226.L1",null,"21_35152076_36498481.L1","1_153208353_154797927.L1","2_26672117_28375910.L1","11_68238358_69701362.L1","17_76379479_78267332.L1","22_27438791_29255810.L3",null,null,"12_109898914_112825713.L4","11_59013076_62456299.L1","17_61235394_63468228.L2",null,"18_36282001_37495287.L1","3_157594239_159760101.L1",null,null,"1_39734895_41509656.L1",null,"7_114072332_117140124.L1","12_48608083_51382710.L1",null,"1_114331223_115337972.L2","5_141266403_143601683.L1","11_100546438_101460390.L1",null,"10_79116992_80654923.L1","2_170369735_172274177.L1","6_25684359_26791023.L1",null],[0.676279408562686,0.00161046610284055,null,null,null,null,0.302947211405366,0.0639748078754807,0.999980250147821,0.821996612272591,null,null,0.352315866548397,null,0.580017667430559,0.587244329108032,0.44547995737646,0.57814520789034,0.522974687691087,null,0.744511775348476,0.853241447079127,0.644635430801645,0.986185578225383,null,null,0.981833879492298,null,0.979337497529834,0.978580213475925,0.469586885129671,0.970713581798853,null,0.00686298614408187,null,0.0364324379697479,0.0267359862287275,null,0.95688958678158,0.0486919594744913,null,0.112794899524047,0.94171439751819,0.333707643228261,0.541062829950674,0.923495790965174,0.110669670934171,null,null,0.251617271902343,0.892114671019743,0.82247631677225,null,0.528382638397617,0.283632046111342,null,null,0.066798068801735,null,0.178132834408169,0.243602796821802,null,0.834698276000398,0.0021455019278771,0.8300599029111,null,0.570866153202811,0.0880652486820998,0.236702575317027,null],["17_43694719_44979537.L4","3_49279539_51797999.L3","12_58914885_60729948.L1",null,"3_49279539_51797999.L1","10_71748755_73662792.L1","3_41023037_42498510.L1","11_46984586_49844498.L1",null,null,null,null,null,null,null,null,null,null,null,"11_9065770_10930480.L4",null,"7_73920272_76829247.L1","15_68725660_69841002.L1",null,null,null,null,null,null,null,null,null,"16_1157206_2714828.L1","2_172274177_174724201.L1","4_110335411_112948946.L2","11_64037097_66131160.L1","17_61235394_63468228.L1",null,null,null,null,"21_35152076_36498481.L1",null,"2_26672117_28375910.L1",null,null,null,"19_3019662_4348970.L1",null,null,null,null,"16_2714828_3951195.L1","18_36282001_37495287.L1","3_157594239_159760101.L1",null,null,"1_39734895_41509656.L1",null,"7_114072332_117140124.L1",null,null,null,"5_141266403_143601683.L1",null,null,"10_79116992_80654923.L1","2_170369735_172274177.L1",null,null],[0.998939360185578,1,0.815813708458381,null,0.999999958235712,0.999999888841081,0.161320479325788,0.0140007288582681,null,null,null,null,null,null,null,null,null,null,null,0.854634605392483,null,0.0427138062406081,0.343270684700764,null,null,null,null,null,null,null,null,null,0.0773469734391031,0.629718350008054,0.429045822462658,0.053474016462125,0.831050625033969,null,null,null,null,0.317934239568582,null,0.137617483983691,null,null,null,0.474574508755547,null,null,null,null,0.880173579293423,0.00180373492563934,0.0606554540026591,null,null,0.0222998085291815,null,0.555959141539889,null,null,null,0.710041823597465,null,null,0.00239243489419294,0.201265893214738,null,null],[null,"3_47685722_49279539.L2","12_58914885_60729948.L1",null,null,null,"3_41023037_42498510.L1","11_44672249_46984586.L1",null,null,"22_29255810_31043932.L1","16_3951195_5068344.L2","14_98672195_101067970.L1",null,null,null,"3_47685722_49279539.L2",null,null,null,null,"7_73920272_76829247.L1",null,null,null,null,null,"21_39110976_40017600.L1",null,null,null,null,"16_1157206_2714828.L1",null,"4_110335411_112948946.L2","11_64037097_66131160.L1","17_61235394_63468228.L1","4_17381699_18840251.L1",null,null,null,null,null,"2_26672117_28375910.L1",null,null,null,null,null,"12_109898914_112825713.L4","11_59013076_62456299.L1",null,null,"18_36282001_37495287.L1","3_157594239_159760101.L1",null,"7_148118226_150143569.L1","1_39734895_41509656.L1","15_40885316_42484201.L2",null,"12_48608083_51382710.L1",null,null,"5_141266403_143601683.L1",null,null,null,"2_170369735_172274177.L1","6_25684359_26791023.L1","14_51026854_53007665.L1"],[null,0.00222509749325006,0.674151828879293,null,null,null,0.0897854353363725,0.99999680375922,null,null,0.999253322194235,0.998660298466206,0.645641241983147,null,null,null,0.00416655427357793,null,null,null,null,0.0953267936857825,null,null,null,null,null,0.981704210988021,null,null,null,null,0.0314063960370145,null,0.0408529351381307,0.673471149800575,0.0213743869816201,0.957300546017453,null,null,null,null,null,0.266061447307996,null,null,null,null,null,0.017701833769788,0.00667689338648714,null,null,0.00118264505903154,0.0900513466033463,null,0.236097081549281,0.0649792174449598,0.859910652855592,null,0.188444695166177,null,null,0.119743438346022,null,null,null,0.132665327199718,0.189726073729351,0.577203104117494],["17_43694719_44979537.L3",null,null,null,null,null,"3_41023037_42498510.L1","11_46984586_49844498.L1",null,null,null,null,null,"12_119316305_121569746.L1",null,null,"3_49279539_51797999.L2",null,"2_217530757_219589829.L1",null,null,null,null,null,"7_140535410_141526757.L1","1_11717784_12719464.L2",null,null,null,null,"3_120804208_122255250.L1",null,"16_1157206_2714828.L1","2_172274177_174724201.L1,2_172274177_174724201.L3",null,"11_64037097_66131160.L1","17_61235394_63468228.L1",null,null,"17_21387045_29007226.L1","17_47798656_49440038.L2","21_35152076_36498481.L1",null,null,null,null,"22_27438791_29255810.L3","19_3019662_4348970.L1",null,"12_109898914_112825713.L4",null,"17_61235394_63468228.L2",null,"18_36282001_37495287.L1","3_157594239_159760101.L1",null,"7_148118226_150143569.L1","1_39734895_41509656.L1",null,null,"12_48608083_51382710.L1",null,null,null,null,"19_18299052_19766662.L1","10_79116992_80654923.L1","2_170369735_172274177.L1",null,null],[1,null,null,null,null,null,0.261506279609764,0.0594029500482891,null,null,null,null,null,0.997692659186045,null,null,0.228212420404619,null,0.470435564491958,null,null,null,null,null,0.984577422783082,0.712582411728289,null,null,null,null,0.0957539051780277,null,0.861177185435592,0.169690886149656,null,0.195369839825351,0.0623456768562051,null,null,0.851167151315854,0.952426018165499,0.515382798871488,null,null,null,null,0.564982512597713,0.448398588563549,null,0.104587682737932,null,0.0612982665944954,null,0.136472093012994,0.410666716051216,null,0.400808704179055,0.666398162817973,null,null,0.00956347370762201,null,null,null,null,0.82950796094199,0.00387822272165494,0.144094210989081,null,null],[null,null,null,"4_142522112_145257035.L1",null,null,"3_41023037_42498510.L1","11_46984586_49844498.L1",null,"10_102620653_104935290.L1",null,null,null,null,"5_147802435_149283061.L2","15_49715846_51385363.L4","3_49279539_51797999.L2","2_134401007_136285224.L1",null,"11_9065770_10930480.L4","8_65576855_68950822.L2",null,null,null,null,"1_11717784_12719464.L1",null,null,null,null,"3_120804208_122255250.L1",null,null,"2_172274177_174724201.L3,2_172274177_174724201.L1","4_110335411_112948946.L2",null,"17_61235394_63468228.L1",null,null,"17_21387045_29007226.L1",null,null,null,"2_26672117_28375910.L1","11_68238358_69701362.L1",null,"22_27438791_29255810.L3",null,"1_154797927_156366342.L1","12_108632125_109898914.L1,12_109898914_112825713.L4",null,null,null,"18_36282001_37495287.L1","3_157594239_159760101.L1","11_72574973_74701306.L1","7_148118226_150143569.L1","1_39734895_41509656.L1",null,"7_114072332_117140124.L1","12_48608083_51382710.L1","17_1269105_2025437.L1",null,"5_141266403_143601683.L1",null,null,"10_79116992_80654923.L1","2_170369735_172274177.L1","6_25684359_26791023.L1","14_51026854_53007665.L1"],[null,null,null,0.999999992562229,null,null,0.184440261752842,0.00636466500155997,null,0.659124443123841,null,null,null,null,0.4175382065139,0.425040216260925,0.320688339141147,0.416190276197034,null,0.138652097959095,0.247439841788367,null,null,null,null,0.946047428001998,null,null,null,null,0.406313369128965,null,null,0.371158352970373,0.490534597563188,null,0.0162773986485903,null,null,0.0526590019640334,null,null,null,0.203167821814485,0.389495807238231,null,0.250086893167154,null,0.92092985964253,0.8404892941505,null,null,null,0.201195225054346,0.0227410499517658,0.866944073491087,0.227553519019889,0.0400246059876721,null,0.120999388343958,0.406016575954384,0.840378940224767,null,0.000469423529814605,null,null,0.247791793726313,0.253526857927513,0.389741683257225,0.224024704446799]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>Artery_Tibial_cs_id<\/th>\n      <th>Artery_Tibial_pip<\/th>\n      <th>Heart_Atrial_Appendage_cs_id<\/th>\n      <th>Heart_Atrial_Appendage_pip<\/th>\n      <th>Adipose_Subcutaneous_cs_id<\/th>\n      <th>Adipose_Subcutaneous_pip<\/th>\n      <th>Brain_Cortex_cs_id<\/th>\n      <th>Brain_Cortex_pip<\/th>\n      <th>Skin_Sun_Exposed_Lower_leg_cs_id<\/th>\n      <th>Skin_Sun_Exposed_Lower_leg_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9,11,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>combined_pip_by_group_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;group&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = F)

combined_pip_by_group_sig_multi &lt;- combined_pip_by_group_multi[combined_pip_by_group_multi$combined_pip &gt; 0.8,]

plot_heatmap(heatmap_data = combined_pip_by_group_sig_multi, main = &quot;PIP partitions for genes with PIP&gt;0.8&quot;)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-21-3.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
<div id="comparing-with-single-tissue-eqtl-analysis-3"
class="section level2">
<h2>Comparing with single tissue + eQTL analysis</h2>
<pre class="r"><code>ctwas_res_single &lt;- readRDS(paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/10.single_tissue_1007/results/&quot;,trait,&quot;/&quot;,tissue[1],&quot;/&quot;,trait,&quot;_&quot;,tissue[1], &quot;.ctwas.res.RDS&quot;))

susie_alpha_res_single &lt;- ctwas_res_single$susie_alpha_res

susie_alpha_res_single &lt;- anno_susie_alpha_res(susie_alpha_res_single,
                                        mapping_table = mapping_predictdb,
                                        map_by = &quot;molecular_id&quot;,
                                        drop_unmapped = TRUE)</code></pre>
<pre><code>2024-10-16 11:07:38 INFO::Annotating susie alpha result ...
2024-10-16 11:07:38 INFO::Map molecular traits to genes</code></pre>
<pre class="r"><code>combined_pip_by_type_single &lt;- combine_gene_pips(susie_alpha_res_single, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;type&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = F)

combined_pip_by_type_sig_single &lt;- combined_pip_by_type_single[combined_pip_by_type_single$combined_pip &gt; 0.8,]
combined_pip_by_type_sig_multi &lt;- combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$combined_pip &gt; 0.8,]

sprintf(&quot;Number of genes with PIP &gt; 0.8  -- Multi-group = %s&quot;, nrow(combined_pip_by_type_sig_multi))</code></pre>
<pre><code>[1] &quot;Number of genes with PIP &gt; 0.8  -- Multi-group = 70&quot;</code></pre>
<pre class="r"><code>sprintf(&quot;Number of genes with PIP &gt; 0.8  -- single eQTL = %s&quot;, nrow(combined_pip_by_type_sig_single))</code></pre>
<pre><code>[1] &quot;Number of genes with PIP &gt; 0.8  -- single eQTL = 29&quot;</code></pre>
<pre class="r"><code>sprintf(&quot;Number of overlapped genes = %s&quot;, sum(combined_pip_by_type_sig_single$gene_name %in% combined_pip_by_type_sig_multi$gene_name))</code></pre>
<pre><code>[1] &quot;Number of overlapped genes = 19&quot;</code></pre>
<pre class="r"><code>genes_not_reported &lt;- combined_pip_by_type_sig_single$gene_name[!combined_pip_by_type_sig_single$gene_name %in%combined_pip_by_type_sig_multi$gene_name]

DT::datatable(combined_pip_by_type_sig_single[combined_pip_by_type_sig_single$gene_name %in% genes_not_reported,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Genes not reported by multi-group analysis&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-35e1d0e81f5ada6ecac0" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-35e1d0e81f5ada6ecac0">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Genes not reported by multi-group analysis<\/caption>","data":[["6","12","14","17","18","24","25","26","28","29"],["PRRC2A","ARID1A","ZNF692","ARHGEF25","GMEB2","AAK1","SNX11","TCHP","TOM1L2","GOPC"],[0.999999818585045,0.983662057319139,0.977509804757182,0.957601183203461,0.928062421248899,0.852868249075944,0.851575230961463,0.844179327991468,0.815096940129266,0.810582375236749],[0.999999818585045,0.983662057319139,0.977509804757182,0.957601183203461,0.928062421248899,0.852868249075944,0.851575230961463,0.844179327991468,0.815096940129266,0.810582375236749]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>DT::datatable(combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$gene_name %in% genes_not_reported,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Genes not reported by multi-group analysis&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-a41f9b9304ecbba20fc2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a41f9b9304ecbba20fc2">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Genes not reported by multi-group analysis<\/caption>","data":[["74","77","88","91","120","179","217"],["GOPC","AAK1","ZNF692","ARID1A","TOM1L2","SNX11","TCHP"],["6_117351809_118641952.L1","2_68912432_70528066.L1","1_247181216_248945267.L1","1_25190354_27075376.L1","17_16509028_18953007.L1","17_47798656_49440038.L1","12_109898914_112825713.L4"],[0.784156742862357,0.771138471042855,0.688577516547201,0.673011245256195,0.479438887311845,0.288573984105029,0.203452484710675],["6_117351809_118641952.L1","2_68912432_70528066.L1","1_247181216_248945267.L1","1_25190354_27075376.L1","17_16509028_18953007.L1","17_47798656_49440038.L1","12_109898914_112825713.L4"],[0.571776090252904,0.771138471042855,0.688577516547201,0.673011245256195,0.472781691568315,0.214143566244502,0.203452484710675],["6_117351809_118641952.L1",null,null,null,"17_16509028_18953007.L1","17_47798656_49440038.L1",null],[0.185219400762372,null,null,null,0.00465444482832211,0.00582734383591987,null],["6_117351809_118641952.L1",null,null,null,"17_16509028_18953007.L1","17_47798656_49440038.L1",null],[0.0271612518470812,null,null,null,0.00200275091520841,0.0686039112190043,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_cs_id<\/th>\n      <th>eQTL_pip<\/th>\n      <th>sQTL_cs_id<\/th>\n      <th>sQTL_pip<\/th>\n      <th>stQTL_cs_id<\/th>\n      <th>stQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>gene_multi_unique_type &lt;- combined_pip_by_group_sig_multi[!combined_pip_by_group_sig_multi$gene_name %in%  combined_pip_by_type_sig_single$gene_name,]

plot_heatmap(heatmap_data = gene_multi_unique_type, main = &quot;PIP partition for unique genes found by multi-group analysis&quot;)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-23-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-23-1">
Past versions of unnamed-chunk-23-1.png
</button>
</p>
<div id="fig-unnamed-chunk-23-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/4a84d72e7453cf3617b2b5a0fdd798d0595620e2/docs/figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-23-1.png" target="_blank">4a84d72</a>
</td>
<td>
XSun
</td>
<td>
2024-10-15
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="scz-ieu-b-5102" class="section level1">
<h1>SCZ-ieu-b-5102</h1>
<div id="parameter-3" class="section level2">
<h2>Parameter</h2>
<pre class="r"><code>trait &lt;- &quot;SCZ-ieu-b-5102&quot;
gwas_n &lt;- samplesize[trait]
tissue &lt;- c(&quot;Brain_Hippocampus&quot;,&quot;Adrenal_Gland&quot;,&quot;Brain_Spinal_cord_cervical_c-1&quot;,&quot;Spleen&quot;,&quot;Heart_Left_Ventricle&quot;)


results_dir_multi &lt;- paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/results/&quot;,trait,&quot;/&quot;)
ctwas_res_multi &lt;- readRDS(paste0(results_dir_multi,trait,&quot;.ctwas.res.RDS&quot;))

param_multi &lt;- ctwas_res_multi$param
make_convergence_plots(param_multi, gwas_n, colors = colors)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-24-1.png" width="1152" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ctwas_parameters_multi &lt;- summarize_param(param_multi, gwas_n)
pve_pie_by_type_multi &lt;- plot_piechart(ctwas_parameters = ctwas_parameters_multi, colors = colors, by = &quot;type&quot;)
pve_pie_by_context_multi &lt;- plot_piechart(ctwas_parameters = ctwas_parameters_multi, colors = colors, by = &quot;context&quot;)

gridExtra::grid.arrange(pve_pie_by_type_multi,pve_pie_by_context_multi, ncol = 2)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-25-1.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
<div id="fine-mapping-4" class="section level2">
<h2>Fine-mapping</h2>
<pre class="r"><code>susie_alpha_res_multi &lt;- ctwas_res_multi$susie_alpha_res

susie_alpha_res_multi &lt;- anno_susie_alpha_res(susie_alpha_res_multi,
                                        mapping_table = mapping_two,
                                        map_by = &quot;molecular_id&quot;,
                                        drop_unmapped = TRUE)</code></pre>
<pre><code>2024-10-16 11:07:52 INFO::Annotating susie alpha result ...
2024-10-16 11:07:52 INFO::Map molecular traits to genes
2024-10-16 11:07:53 INFO::Split PIPs for molecular traits mapped to multiple genes</code></pre>
<pre class="r"><code>combined_pip_by_type_cs_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;type&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = T)

combined_pip_by_context_cs_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;context&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = T)

DT::datatable(combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$combined_pip&gt;0.8,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Combined PIP by omics&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-80db18273cfc4a9b8682" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-80db18273cfc4a9b8682">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Combined PIP by omics<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42"],["HLA-A","HLA-G","LRP4","NT5C2","GATS","C11orf49","DENND2A","NUDT1","ZNF823","OLA1","LRRC37B","CHMP1A","SDCCAG8","MST1","ACTR1B","STAT6","SNX19","IRF3","TMEM222","R3HDM2","LY6H","KLHL20","RERE","MRPS33","PVRIG","STRC","PAK6","FOXN2","TBC1D15","GRAPL","MYO1E","TRPV4","SF3B1","ACE","GATAD2A","NAA40","LGSN","CCDC122","KCTD21","PIGO","NUP50","POLG"],["6_28949831_29770194.L2","6_28949831_29770194.L3","11_46984586_49844498.L1","10_102620653_104935290.L1","7_99117851_100599028.L3,7_99117851_100599028.L2,7_99117851_100599028.L1","11_44672249_46984586.L1,11_46984586_49844498.L2,11_46984586_49844498.L3","7_140233377_140535410.L1","7_2022763_2732593.L2","19_11173352_13360313.L1","2_172274177_174724201.L1","17_31459473_33211407.L1","16_88974757_90226404.L1","1_241908300_243946197.L1","3_49279539_51797999.L1","2_94660727_98378738.L1","12_55272053_57155077.L1","11_130472680_131204717.L1","19_48778970_51029311.L1","1_27075376_29689034.L2","12_57155077_58914885.L1","8_143155464_145078481.L2","1_173128768_175120632.L1","1_7187275_9305140.L1","7_140535410_141526757.L1","7_99117851_100599028.L3,7_99117851_100599028.L2","15_42484201_43905851.L1,15_43905851_46326589.L1","15_40091931_40885316.L1","2_47985862_49795119.L1","12_70564207_72251295.L1","17_18953007_21387045.L1","15_58149167_59401917.L1","12_108632125_109898914.L3","2_197213386_198446401.L1","17_63468228_65152010.L1","19_18299052_19766662.L1","11_62456299_64037097.L1","6_62842983_65055849.L1","13_42526891_44327273.L1","11_77086163_78644013.L1","9_34642246_36743286.L2","22_44599428_46074615.L1","15_87826712_89932319.L1"],[1,1,1,0.999988251166268,0.999960252864222,0.998816314070191,0.995021290659694,0.994934560996929,0.993341564582028,0.989355611121955,0.986185706410118,0.979488408143359,0.974615555298992,0.96774769949583,0.963062967040232,0.956380549481658,0.953907997844387,0.9505753979754,0.94875264931691,0.940757279524084,0.93839556730208,0.937244521455832,0.935047389641407,0.92161344954462,0.920673982490661,0.917634130880256,0.91547961834403,0.912320953865385,0.887220908014938,0.880144889156626,0.868580103692764,0.864930923126092,0.86120675879617,0.860412511229402,0.859633529518978,0.855988201372721,0.849185892249425,0.833310732782652,0.83234421228795,0.825684806576236,0.825186989103893,0.822877667933816],[null,null,null,"10_102620653_104935290.L1",null,null,null,null,"19_11173352_13360313.L1",null,null,null,null,null,"2_94660727_98378738.L1",null,"11_130472680_131204717.L1","19_48778970_51029311.L1","1_27075376_29689034.L2",null,"8_143155464_145078481.L2","1_173128768_175120632.L1","1_7187275_9305140.L1",null,"7_99117851_100599028.L3,7_99117851_100599028.L2",null,"15_40091931_40885316.L1","2_47985862_49795119.L1","12_70564207_72251295.L1",null,null,"12_108632125_109898914.L3","2_197213386_198446401.L1","17_63468228_65152010.L1","19_18299052_19766662.L1",null,null,"13_42526891_44327273.L1","11_77086163_78644013.L1","9_34642246_36743286.L2","22_44599428_46074615.L1","15_87826712_89932319.L1"],[null,null,null,0.640609704645637,null,null,null,null,0.993341564582028,null,null,null,null,null,0.228312717742867,null,0.953907997844387,0.226478040522229,0.94875264931691,null,0.72863296758147,0.937244521455832,0.89219424681927,null,0.920673982490661,null,0.839834961206548,0.912320953865385,0.0244214518170432,null,null,0.864930923126092,0.623115140127012,0.743036907563121,0.781363689621582,null,null,0.0530713335957816,0.232916253271998,0.825684806576236,0.126908739882442,0.398076959851353],[null,null,null,"10_102620653_104935290.L1","7_99117851_100599028.L3,7_99117851_100599028.L2","11_46984586_49844498.L2",null,null,null,null,null,null,null,null,"2_94660727_98378738.L1",null,null,"19_48778970_51029311.L1",null,"12_57155077_58914885.L1","8_143155464_145078481.L2",null,"1_7187275_9305140.L1","7_140535410_141526757.L1",null,null,"15_40091931_40885316.L1",null,"12_70564207_72251295.L1",null,null,null,"2_197213386_198446401.L1","17_63468228_65152010.L1","19_18299052_19766662.L1",null,null,null,null,null,"22_44599428_46074615.L1","15_87826712_89932319.L1"],[null,null,null,0.836836253990639,0.0709779711670521,0.941293265671089,null,null,null,null,null,null,null,null,0.734750249297365,null,null,0.724097357453171,null,0.940757279524084,0.209762652671305,null,0.0428531428221365,0.92161344954462,null,null,0.0756446571374814,null,0.269720803553708,null,null,null,0.238091618669158,0.117375603666282,0.078269839897396,null,null,null,null,null,0.576958474222335,0.424800708082463],["6_28949831_29770194.L2","6_28949831_29770194.L3","11_46984586_49844498.L1",null,"7_99117851_100599028.L3,7_99117851_100599028.L1","11_44672249_46984586.L1,11_46984586_49844498.L3","7_140233377_140535410.L1","7_2022763_2732593.L2",null,"2_172274177_174724201.L1","17_31459473_33211407.L1","16_88974757_90226404.L1","1_241908300_243946197.L1","3_49279539_51797999.L1",null,"12_55272053_57155077.L1",null,null,null,null,null,null,null,null,null,"15_42484201_43905851.L1,15_43905851_46326589.L1",null,null,"12_70564207_72251295.L1","17_18953007_21387045.L1","15_58149167_59401917.L1",null,null,null,null,"11_62456299_64037097.L1","6_62842983_65055849.L1","13_42526891_44327273.L1","11_77086163_78644013.L1",null,"22_44599428_46074615.L1",null],[1,1,1,null,0.999952606268265,0.979837295294249,0.995021290659694,0.994934560996929,null,0.989355611121955,0.986185706410118,0.979488408143359,0.974615555298992,0.96774769949583,null,0.956380549481658,null,null,null,null,null,null,null,null,null,0.917634130880256,null,null,0.593078652644186,0.880144889156626,0.868580103692764,null,null,null,null,0.855988201372721,0.849185892249425,0.78023939918687,0.599427959015952,null,0.121319774999116,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_cs_id<\/th>\n      <th>eQTL_pip<\/th>\n      <th>sQTL_cs_id<\/th>\n      <th>sQTL_pip<\/th>\n      <th>stQTL_cs_id<\/th>\n      <th>stQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>DT::datatable(combined_pip_by_context_cs_multi[combined_pip_by_context_cs_multi$combined_pip&gt;0.8,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Combined PIP by tissue&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-6f19a3278480c8d45e45" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6f19a3278480c8d45e45">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Combined PIP by tissue<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42"],["HLA-A","HLA-G","LRP4","NT5C2","GATS","C11orf49","DENND2A","NUDT1","ZNF823","OLA1","LRRC37B","CHMP1A","SDCCAG8","MST1","ACTR1B","STAT6","SNX19","IRF3","TMEM222","R3HDM2","LY6H","KLHL20","RERE","MRPS33","PVRIG","STRC","PAK6","FOXN2","TBC1D15","GRAPL","MYO1E","TRPV4","SF3B1","ACE","GATAD2A","NAA40","LGSN","CCDC122","KCTD21","PIGO","NUP50","POLG"],["6_28949831_29770194.L2","6_28949831_29770194.L3","11_46984586_49844498.L1","10_102620653_104935290.L1","7_99117851_100599028.L3,7_99117851_100599028.L2,7_99117851_100599028.L1","11_44672249_46984586.L1,11_46984586_49844498.L2,11_46984586_49844498.L3","7_140233377_140535410.L1","7_2022763_2732593.L2","19_11173352_13360313.L1","2_172274177_174724201.L1","17_31459473_33211407.L1","16_88974757_90226404.L1","1_241908300_243946197.L1","3_49279539_51797999.L1","2_94660727_98378738.L1","12_55272053_57155077.L1","11_130472680_131204717.L1","19_48778970_51029311.L1","1_27075376_29689034.L2","12_57155077_58914885.L1","8_143155464_145078481.L2","1_173128768_175120632.L1","1_7187275_9305140.L1","7_140535410_141526757.L1","7_99117851_100599028.L3,7_99117851_100599028.L2","15_42484201_43905851.L1,15_43905851_46326589.L1","15_40091931_40885316.L1","2_47985862_49795119.L1","12_70564207_72251295.L1","17_18953007_21387045.L1","15_58149167_59401917.L1","12_108632125_109898914.L3","2_197213386_198446401.L1","17_63468228_65152010.L1","19_18299052_19766662.L1","11_62456299_64037097.L1","6_62842983_65055849.L1","13_42526891_44327273.L1","11_77086163_78644013.L1","9_34642246_36743286.L2","22_44599428_46074615.L1","15_87826712_89932319.L1"],[1,1,1,0.999988251166268,0.999960252864222,0.998816314070191,0.995021290659694,0.994934560996929,0.993341564582028,0.989355611121955,0.986185706410118,0.979488408143359,0.974615555298992,0.96774769949583,0.963062967040232,0.956380549481658,0.953907997844387,0.9505753979754,0.94875264931691,0.940757279524084,0.93839556730208,0.937244521455832,0.935047389641407,0.92161344954462,0.920673982490661,0.917634130880256,0.91547961834403,0.912320953865385,0.887220908014938,0.880144889156626,0.868580103692764,0.864930923126092,0.86120675879617,0.860412511229402,0.859633529518978,0.855988201372721,0.849185892249425,0.833310732782652,0.83234421228795,0.825684806576236,0.825186989103893,0.822877667933816],[null,null,"11_46984586_49844498.L1","10_102620653_104935290.L1","7_99117851_100599028.L3,7_99117851_100599028.L1","11_46984586_49844498.L2",null,null,"19_11173352_13360313.L1",null,null,null,"1_241908300_243946197.L1",null,"2_94660727_98378738.L1","12_55272053_57155077.L1",null,"19_48778970_51029311.L1","1_27075376_29689034.L2",null,"8_143155464_145078481.L2","1_173128768_175120632.L1","1_7187275_9305140.L1",null,"7_99117851_100599028.L3",null,"15_40091931_40885316.L1",null,"12_70564207_72251295.L1",null,null,"12_108632125_109898914.L3","2_197213386_198446401.L1",null,"19_18299052_19766662.L1",null,null,null,"11_77086163_78644013.L1","9_34642246_36743286.L2","22_44599428_46074615.L1","15_87826712_89932319.L1"],[null,null,1,0.490082701571293,0.999931502333055,0.801936289344282,null,null,0.180989755359901,null,null,null,0.974615555298992,null,0.434589236588659,0.956380549481658,null,0.174164622449411,0.13396265386893,null,0.338323945508425,0.166711628591423,0.396067129443126,null,0.00474037986499243,null,0.0499430756331187,null,0.11426098607111,null,null,0.32186951369124,0.0959558598588026,null,0.230875650058521,null,null,null,0.206757213279716,0.50636783878557,0.24348752901186,0.257671169241775],[null,"6_28949831_29770194.L3",null,"10_102620653_104935290.L1","7_99117851_100599028.L3","11_46984586_49844498.L3",null,null,"19_11173352_13360313.L1",null,null,"16_88974757_90226404.L1",null,null,"2_94660727_98378738.L1",null,null,"19_48778970_51029311.L1",null,null,"8_143155464_145078481.L2","1_173128768_175120632.L1","1_7187275_9305140.L1","7_140535410_141526757.L1",null,"15_42484201_43905851.L1","15_40091931_40885316.L1","2_47985862_49795119.L1","12_70564207_72251295.L1",null,null,null,"2_197213386_198446401.L1","17_63468228_65152010.L1","19_18299052_19766662.L1",null,null,"13_42526891_44327273.L1","11_77086163_78644013.L1",null,"22_44599428_46074615.L1","15_87826712_89932319.L1"],[null,1,null,0.272624503327352,0.0386621031873539,0.979156127243807,null,null,0.0951312955787459,null,null,0.0661568005150824,null,null,0.211071877394714,null,null,0.480895558385182,null,null,0.0707757924372182,0.0917794216077035,0.0191068160926631,0.593037410619026,null,0.0779532462439252,0.0257015815043626,0.108651306562287,0.43844939451328,null,null,null,0.0493805662089979,0.236076634478247,0.126523114403971,null,null,0.283400808629564,0.473880003152464,null,0.243617550549081,0.0347806971619771],[null,null,null,"10_102620653_104935290.L1","7_99117851_100599028.L2,7_99117851_100599028.L3","11_44672249_46984586.L1,11_46984586_49844498.L2",null,null,"19_11173352_13360313.L1",null,null,null,null,"3_49279539_51797999.L1","2_94660727_98378738.L1",null,"11_130472680_131204717.L1",null,"1_27075376_29689034.L2","12_57155077_58914885.L1","8_143155464_145078481.L2","1_173128768_175120632.L1",null,"7_140535410_141526757.L1",null,"15_42484201_43905851.L1",null,"2_47985862_49795119.L1","12_70564207_72251295.L1",null,"15_58149167_59401917.L1",null,"2_197213386_198446401.L1","17_63468228_65152010.L1","19_18299052_19766662.L1",null,"6_62842983_65055849.L1",null,"11_77086163_78644013.L1",null,"22_44599428_46074615.L1","15_87826712_89932319.L1"],[null,null,null,0.0969309269179113,0.166668369247382,0.167598761236349,null,null,0.20490200615584,null,null,null,null,0.96774769949583,0.0534830185884371,null,0.289039170204187,null,0.125224050348125,0.286825703512978,0.151330134452167,0.18873721685901,null,0.100178925609823,null,0.395566337175803,null,0.223436224384942,0.0196237441905677,null,0.027117262186004,null,0.189921700548253,0.244103002479972,0.0114399402892448,null,0.837417386132739,null,0.0884722141235978,null,0.144579161079873,0.0447996546902941],["6_28949831_29770194.L2",null,null,"10_102620653_104935290.L1",null,null,"7_140233377_140535410.L1","7_2022763_2732593.L2","19_11173352_13360313.L1",null,"17_31459473_33211407.L1","16_88974757_90226404.L1",null,null,"2_94660727_98378738.L1",null,null,null,"1_27075376_29689034.L2",null,"8_143155464_145078481.L2","1_173128768_175120632.L1","1_7187275_9305140.L1",null,"7_99117851_100599028.L2","15_43905851_46326589.L1",null,"2_47985862_49795119.L1","12_70564207_72251295.L1","17_18953007_21387045.L1","15_58149167_59401917.L1",null,"2_197213386_198446401.L1","17_63468228_65152010.L1","19_18299052_19766662.L1","11_62456299_64037097.L1","6_62842983_65055849.L1","13_42526891_44327273.L1","11_77086163_78644013.L1","9_34642246_36743286.L2",null,"15_87826712_89932319.L1"],[1,null,null,0.640609704645637,null,null,0.995021290659694,0.994934560996929,0.212932154945043,null,0.986185706410118,0.913331607628276,null,null,0.101338172149757,null,null,null,0.167806102331111,null,0.161040245252129,0.208827302419651,0.496127117376145,null,0.392892790086962,0.84355378371954,null,0.247220592056926,0.238404857411971,0.880144889156626,0.841547673099749,null,0.191679372710882,0.0164179552653282,0.209113405682849,0.855988201372721,0.0117747117627598,0.464891542548373,0.0431968883133947,0.224308304074616,null,0.398076959851353],[null,null,null,"10_102620653_104935290.L1","7_99117851_100599028.L3",null,null,null,"19_11173352_13360313.L1","2_172274177_174724201.L1",null,null,null,null,"2_94660727_98378738.L1",null,"11_130472680_131204717.L1","19_48778970_51029311.L1","1_27075376_29689034.L2","12_57155077_58914885.L1","8_143155464_145078481.L2","1_173128768_175120632.L1","1_7187275_9305140.L1","7_140535410_141526757.L1","7_99117851_100599028.L2",null,"15_40091931_40885316.L1","2_47985862_49795119.L1","12_70564207_72251295.L1",null,null,"12_108632125_109898914.L3","2_197213386_198446401.L1","17_63468228_65152010.L1","19_18299052_19766662.L1",null,null,"13_42526891_44327273.L1","11_77086163_78644013.L1","9_34642246_36743286.L2","22_44599428_46074615.L1","15_87826712_89932319.L1"],[null,null,null,0.213784120345404,0.0207784047641056,null,null,null,0.299453661940212,0.989355611121955,null,null,null,null,0.162580662318664,null,0.6648688276402,0.295515217140807,0.521764816140875,0.653931576011107,0.216925568481365,0.281292931571759,0.0237463267294734,0.228397113315772,0.52895183984498,null,0.839834961206548,0.333012830861229,0.0764819258280094,null,null,0.543090623516283,0.334269259469234,0.363814919005855,0.281681419084393,null,null,0.0850183816047141,0.0200378934187774,0.0950177957639974,0.19350274846308,0.0875491869884159]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>Brain_Hippocampus_cs_id<\/th>\n      <th>Brain_Hippocampus_pip<\/th>\n      <th>Adrenal_Gland_cs_id<\/th>\n      <th>Adrenal_Gland_pip<\/th>\n      <th>Brain_Spinal_cord_cervical_c-1_cs_id<\/th>\n      <th>Brain_Spinal_cord_cervical_c-1_pip<\/th>\n      <th>Spleen_cs_id<\/th>\n      <th>Spleen_pip<\/th>\n      <th>Heart_Left_Ventricle_cs_id<\/th>\n      <th>Heart_Left_Ventricle_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9,11,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>combined_pip_by_group_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;group&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = F)

combined_pip_by_group_sig_multi &lt;- combined_pip_by_group_multi[combined_pip_by_group_multi$combined_pip &gt; 0.8,]

plot_heatmap(heatmap_data = combined_pip_by_group_sig_multi, main = &quot;PIP partitions for genes with PIP&gt;0.8&quot;)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-26-3.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
<div id="comparing-with-single-tissue-eqtl-analysis-4"
class="section level2">
<h2>Comparing with single tissue + eQTL analysis</h2>
<pre class="r"><code>ctwas_res_single &lt;- readRDS(paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/10.single_tissue_1007/results/&quot;,trait,&quot;/&quot;,tissue[1],&quot;/&quot;,trait,&quot;_&quot;,tissue[1], &quot;.ctwas.res.RDS&quot;))

susie_alpha_res_single &lt;- ctwas_res_single$susie_alpha_res

susie_alpha_res_single &lt;- anno_susie_alpha_res(susie_alpha_res_single,
                                        mapping_table = mapping_predictdb,
                                        map_by = &quot;molecular_id&quot;,
                                        drop_unmapped = TRUE)</code></pre>
<pre><code>2024-10-16 11:08:05 INFO::Annotating susie alpha result ...
2024-10-16 11:08:05 INFO::Map molecular traits to genes</code></pre>
<pre class="r"><code>combined_pip_by_type_single &lt;- combine_gene_pips(susie_alpha_res_single, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;type&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = F)

combined_pip_by_type_sig_single &lt;- combined_pip_by_type_single[combined_pip_by_type_single$combined_pip &gt; 0.8,]
combined_pip_by_type_sig_multi &lt;- combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$combined_pip &gt; 0.8,]

sprintf(&quot;Number of genes with PIP &gt; 0.8  -- Multi-group = %s&quot;, nrow(combined_pip_by_type_sig_multi))</code></pre>
<pre><code>[1] &quot;Number of genes with PIP &gt; 0.8  -- Multi-group = 42&quot;</code></pre>
<pre class="r"><code>sprintf(&quot;Number of genes with PIP &gt; 0.8  -- single eQTL = %s&quot;, nrow(combined_pip_by_type_sig_single))</code></pre>
<pre><code>[1] &quot;Number of genes with PIP &gt; 0.8  -- single eQTL = 14&quot;</code></pre>
<pre class="r"><code>sprintf(&quot;Number of overlapped genes = %s&quot;, sum(combined_pip_by_type_sig_single$gene_name %in% combined_pip_by_type_sig_multi$gene_name))</code></pre>
<pre><code>[1] &quot;Number of overlapped genes = 7&quot;</code></pre>
<pre class="r"><code>genes_not_reported &lt;- combined_pip_by_type_sig_single$gene_name[!combined_pip_by_type_sig_single$gene_name %in%combined_pip_by_type_sig_multi$gene_name]

DT::datatable(combined_pip_by_type_sig_single[combined_pip_by_type_sig_single$gene_name %in% genes_not_reported,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Genes not reported by multi-group analysis&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-81a148ea6c961cf45e2c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-81a148ea6c961cf45e2c">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Genes not reported by multi-group analysis<\/caption>","data":[["3","6","7","9","11","12","14"],["HIST1H2BN","MAP3K11","NUP88","HLA-DMB","ARFGAP2","FAM120A","PPP1R16B"],[0.931577647052288,0.894306941661214,0.889015820676572,0.859652825861095,0.829589962457719,0.825408055111657,0.803866608745113],[0.931577647052288,0.894306941661214,0.889015820676572,0.859652825861095,0.829589962457719,0.825408055111657,0.803866608745113]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>DT::datatable(combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$gene_name %in% genes_not_reported,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Genes not reported by multi-group analysis&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-425deb884d24b4ea5f7c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-425deb884d24b4ea5f7c">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Genes not reported by multi-group analysis<\/caption>","data":[["75","76","86","98","113","157"],["PPP1R16B","HIST1H2BN","FAM120A","HLA-DMB","MAP3K11","NUP88"],["20_38281128_39808119.L1","6_26791023_28050041.L1","9_91404921_93909416.L1","6_32714887_33268720.L1","11_64037097_66131160.L1","17_4792966_5838014.L1"],[0.605831259349608,0.603228136805986,0.545792121556383,0.465976324783125,0.384166074342388,0.239365034075751],["20_38281128_39808119.L1","6_26791023_28050041.L1","9_91404921_93909416.L1","6_32714887_33268720.L1","11_64037097_66131160.L1","17_4792966_5838014.L1"],[0.605831259349608,0.603228136805986,0.545792121556383,0.311992467624908,0.384166074342388,0.0769484911497469],[null,null,null,"6_32714887_33268720.L1",null,null],[null,null,null,0.154245361510118,null,null],[null,null,null,null,null,"17_4792966_5838014.L1"],[null,null,null,null,null,0.162416542926004]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_cs_id<\/th>\n      <th>eQTL_pip<\/th>\n      <th>sQTL_cs_id<\/th>\n      <th>sQTL_pip<\/th>\n      <th>stQTL_cs_id<\/th>\n      <th>stQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>gene_multi_unique_type &lt;- combined_pip_by_group_sig_multi[!combined_pip_by_group_sig_multi$gene_name %in%  combined_pip_by_type_sig_single$gene_name,]

plot_heatmap(heatmap_data = gene_multi_unique_type, main = &quot;PIP partition for unique genes found by multi-group analysis&quot;)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-28-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-28-1">
Past versions of unnamed-chunk-28-1.png
</button>
</p>
<div id="fig-unnamed-chunk-28-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sq-96/multigroup_ctwas_analysis/blob/4a84d72e7453cf3617b2b5a0fdd798d0595620e2/docs/figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-28-1.png" target="_blank">4a84d72</a>
</td>
<td>
XSun
</td>
<td>
2024-10-15
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="wbc-ieu-b-30" class="section level1">
<h1>WBC-ieu-b-30</h1>
<div id="parameter-4" class="section level2">
<h2>Parameter</h2>
<pre class="r"><code>trait &lt;- &quot;WBC-ieu-b-30&quot;
gwas_n &lt;- samplesize[trait]
tissue &lt;- c(&quot;Whole_Blood&quot;,&quot;Adipose_Subcutaneous&quot;,&quot;Esophagus_Muscularis&quot;,&quot;Cells_Cultured_fibroblasts&quot;,&quot;Thyroid&quot;)


results_dir_multi &lt;- paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/11.multi_group_1008/results/&quot;,trait,&quot;/&quot;)
ctwas_res_multi &lt;- readRDS(paste0(results_dir_multi,trait,&quot;.ctwas.res.RDS&quot;))

param_multi &lt;- ctwas_res_multi$param
make_convergence_plots(param_multi, gwas_n, colors = colors)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-29-1.png" width="1152" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ctwas_parameters_multi &lt;- summarize_param(param_multi, gwas_n)
pve_pie_by_type_multi &lt;- plot_piechart(ctwas_parameters = ctwas_parameters_multi, colors = colors, by = &quot;type&quot;)
pve_pie_by_context_multi &lt;- plot_piechart(ctwas_parameters = ctwas_parameters_multi, colors = colors, by = &quot;context&quot;)

gridExtra::grid.arrange(pve_pie_by_type_multi,pve_pie_by_context_multi, ncol = 2)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-30-1.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
<div id="fine-mapping-5" class="section level2">
<h2>Fine-mapping</h2>
<pre class="r"><code>susie_alpha_res_multi &lt;- ctwas_res_multi$susie_alpha_res

susie_alpha_res_multi &lt;- anno_susie_alpha_res(susie_alpha_res_multi,
                                        mapping_table = mapping_two,
                                        map_by = &quot;molecular_id&quot;,
                                        drop_unmapped = TRUE)</code></pre>
<pre><code>2024-10-16 11:08:24 INFO::Annotating susie alpha result ...
2024-10-16 11:08:24 INFO::Map molecular traits to genes
2024-10-16 11:08:26 INFO::Split PIPs for molecular traits mapped to multiple genes</code></pre>
<pre class="r"><code>combined_pip_by_type_cs_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;type&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = T)

combined_pip_by_context_cs_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;context&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = T)

DT::datatable(combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$combined_pip&gt;0.8,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Combined PIP by omics&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-5674f84365e74fcb3e3c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-5674f84365e74fcb3e3c">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Combined PIP by omics<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272"],["B3GALNT2","C4orf3","C6orf48","DNAH17","FAM220A","GLDN","HLA-A","HLA-DMB","HLA-DRA","HLA-F","KCTD7","MED24","MTMR9","PDE5A","PRDM8","RGL2","RSPO3","SHROOM1","SLC43A2","ZNF506","ZSCAN26","LYZ","MSH5","TAGAP","CSF3R","FOSL2","ARHGAP15","PGS1","ACOXL","CLEC4M","SUFU","TRIM8","CYP17A1","ZNF253","ANKRD44","RPS6KB1","MED12L","REST","NLRC5","SELL","HLA-DMA","MARCH7","AP1M2","PTK2B","DRG1","PTPRA","RAB2A","LPAR1","MAP4K4","BZW1","ALDH2","PTPRJ","LSP1","SEC31A","KIF9","LRRC37A","SUSD1","ZKSCAN8","ZNF516","MIB1","NOSTRIN","SFXN2","BPI","CPEB4","FRS2","KIAA0391","ACAD9","FGD3","VLDLR","CCDC125","ZNF76","ACAP1","CSF1","RUNX3","CDC14A","SPAAR","PAQR9","LAMP1","CXCL6","EPS15L1","BAX","TAF8","SENP3","CXCR2","TBC1D14","ARHGAP35","CD101","TTC39C","ID3","GLG1","HELZ2","ACSF3","ZNF30","PPP5C","SLC45A4","LYN","TLN1","ELMO1","RBPMS","ARAP2","CADM4","LSM4","NINJ2","RIN3","NDEL1","CREB5","FES","WWOX","NPM1","SPECC1L","MUS81","MYH10","P2RY2","GSDMB","SMOX","EIF3B","SMIM22","CFLAR","SLC22A5","ATP13A1","SLC51A","RAB34","C2CD2","MICAL3","INPP5E","PSEN2","ECHDC1","HSF2","RHBDD3","HDHD5","TADA2B","LAPTM5","FBXO18","YAP1","LIPA","FAM65C","RILPL1","EMILIN3","USF2","CEP83","LY9","IFT172","CERS4","UBE2F","RERE","IL1RN","MFN1","BEND7","KIAA1614","MIGA2","ZBTB2","VAT1","PFKFB2","BCL2A1","CXCL12","SLC2A4","NUCB2","S1PR1","MICALL2","PDLIM4","SCD","UBAP1L","CREB3L3","RHOF","TRAF4","CARS2","PKN3","SLC39A11","VCP","HPN","BRAT1","ACKR2","VSIR","CERKL","NAP1L4","CD200R1","POMT1","ZC3H12D","NEK6","ATL2","CDC6","POLR2E","IL1B","CEPT1","DLG5","PSD4","PXYLP1","IL12RB2","GGT5","LIMS2","PRTFDC1","FEM1C","CTSC","TIE1","UPP1","RBP4","COQ8A","ADAM32","SMAP1","RNF146","ZNF320","SNX13","TNFAIP3","UBASH3B","S100A8","DNAJC13","SLC45A3","L3MBTL3","ITPK1","SENP2","SLC23A3","LRBA","CACNA1H","SLC41A1","TNKS2","SCAMP5","CD33","RPS6KA1","AMPD3","NICN1","ZFP1","CREB3L2","TRAF1","CD300A","NUDT14","GBAS","R3HDM2","SIRT3","PARP12","TSPAN32","FIP1L1","NUFIP2","SLC39A9","ARHGAP31","CD36","GOLGA5","SLC26A10","FARP2","CITED4","TBX2","FGD6","MCCC1","ZRANB2","GSDMD","CD46","ITGAX","TRAF3IP3","CNDP2","FAM160A1","NFE2L1","AXL","CD320","RNF139","PTCH1","SLX4IP","ERAP2","GCNT2","CCDC82","MAP3K4","GPX4","CALCRL","HNRNPK","CNN2","ARRB2","TBL2","SPHK2","IP6K2","FBXO38","NOC3L","KAT6B","OXR1","NPAS2"],["1_234463688_235656136.L2,1_234463688_235656136.L3","4_119471529_121736832.L1","6_31603441_32714887.L1","17_78267332_79302554.L3","7_5814895_6534226.L2,7_5814895_6534226.L1","15_51385363_52776899.L3","6_28949831_29770194.L2","6_32714887_33268720.L1","6_32714887_33268720.L2","6_28949831_29770194.L3,6_28949831_29770194.L1","7_66224822_68769087.L1,7_66224822_68769087.L2,7_66224822_68769087.L3","17_38653091_40721152.L1","8_11421489_13634266.L2","4_119012357_119471529.L1","4_80069143_81204161.L2,4_80069143_81204161.L1","6_33268720_35487979.L3","6_127219316_129539886.L2","5_132803957_135441711.L1","17_1269105_2025437.L4","19_19766662_20722951.L4,19_19766662_20722951.L3,19_19766662_20722951.L2","6_26791023_28050041.L4","12_67515949_69432762.L1,12_67515949_69432762.L2,12_69432762_70564207.L2","6_31603441_32714887.L3","6_157797687_160159465.L1","1_34334157_37083582.L1","2_28375910_28994693.L1","2_141761033_143761915.L1,2_141761033_143761915.L2,2_141761033_143761915.L3","17_78267332_79302554.L1","2_109814855_113164279.L2","19_6684874_8282629.L1","10_102620653_104935290.L3","10_101189482_102620653.L1","10_102620653_104935290.L2","19_19766662_20722951.L1","2_197213386_198446401.L3","17_59410151_61235394.L1","3_150534217_151630942.L2","4_55681477_58068842.L1","16_55869862_57630418.L1,16_55869862_57630418.L2","1_169117086_170588635.L1","6_32714887_33268720.L5","2_158720570_160913222.L1","19_9127717_11173352.L5","8_26825008_28304875.L1","22_31043932_32268999.L1","20_2488855_3847766.L1","8_58815541_61416540.L2","9_110015744_112068802.L1","2_101205867_102072305.L2","2_198446401_200711561.L1","12_109898914_112825713.L2","11_46984586_49844498.L1","11_1192365_3644251.L2","4_82451440_83878503.L2","3_46616010_47685722.L1","17_44979537_47798656.L2,17_44979537_47798656.L4","9_112068802_112930865.L1","6_28050041_28949831.L5","18_75815032_77101859.L2","18_14440800_21905883.L1","2_166499460_169111726.L4,2_166499460_169111726.L1,2_166499460_169111726.L2","10_102620653_104935290.L1","20_38281128_39808119.L1","5_173251324_174215868.L1,5_173251324_174215868.L3","12_69432762_70564207.L1","14_34377045_35390387.L1","3_126496100_128476018.L2","9_91404921_93909416.L2","9_1916877_3190064.L2,9_1916877_3190064.L1","5_68555033_71944629.L1","6_33268720_35487979.L1","17_5838014_7414079.L1","1_109761309_111199115.L1","1_23594100_25190354.L1","1_99335048_100360849.L1","9_34642246_36743286.L3","3_141620255_143445786.L2","13_112918174_114344378.L2","4_73726673_76209554.L2","19_16263605_18299052.L1","19_48778970_51029311.L1","6_40377376_42070983.L3","17_7414079_8403107.L2","2_217530757_219589829.L1","4_6771316_7537965.L1,4_6771316_7537965.L3","19_46646825_48778970.L3","1_115337972_118296444.L1","18_23069508_25416687.L2","1_22760390_23594100.L2","16_72901251_74937605.L1","20_63558827_64333810.L1","16_88974757_90226404.L1","19_33772047_35978393.L3","19_45599439_46646825.L1","8_139713400_141963553.L1,8_139713400_141963553.L2","8_55033021_56043824.L1","9_34642246_36743286.L1","7_36173929_37515581.L1,7_36173929_37515581.L4","8_29470379_31276213.L3","4_36018814_37253425.L1","19_43358303_44239955.L1","19_18299052_19766662.L3","12_44631_971165.L1","14_90830516_92665954.L2","17_8403107_10062604.L1","7_28320690_31097675.L1","15_89932319_91621162.L1","16_77489781_78422395.L1","5_170078660_171647288.L1","22_23370460_24588236.L3","11_64037097_66131160.L1","17_8403107_10062604.L2","11_72574973_74701306.L1","17_38653091_40721152.L2","20_3847766_5497204.L1","7_2022763_2732593.L2","16_3951195_5068344.L3","2_200711561_201953914.L1","5_130183332_132803957.L1","19_18299052_19766662.L2","3_195065945_196244537.L1","17_21387045_29007226.L2","21_41901419_43086158.L2","22_17193405_17813322.L2","9_136047132_136605890.L1","1_226623159_229020501.L2","6_127219316_129539886.L3,6_127219316_129539886.L1","6_121584530_123535036.L1","22_29255810_31043932.L2","22_15927607_17193405.L4","4_6771316_7537965.L4","1_29689034_31973084.L1","10_4530082_5941799.L1","11_101460390_104088908.L1","10_87367307_89253624.L2","20_48583442_50623121.L2","12_121569746_124493434.L3","20_40982216_41957049.L1","19_33772047_35978393.L4,19_33772047_35978393.L2","12_94120791_95627009.L1","1_159943258_162376931.L5","2_26672117_28375910.L1","19_6684874_8282629.L3","2_237852338_239030947.L1","1_7187275_9305140.L2","2_109814855_113164279.L1","3_178389377_179656798.L1","10_13279600_14984069.L1","1_178985335_181174985.L1","9_127293231_129403191.L4","6_149932268_151591568.L1","17_41743558_43694719.L1","1_206268085_208237019.L2","15_78223711_80568637.L2","10_44234627_46978910.L2","17_5838014_7414079.L2","11_15721006_17556855.L1","1_100360849_101575460.L4","7_1313431_2022763.L1","5_130183332_132803957.L3","10_98908643_101189482.L2","15_64812469_66802429.L2","19_3019662_4348970.L2","12_121569746_124493434.L2","17_21387045_29007226.L1","13_110579726_111595245.L1","9_127293231_129403191.L1","17_71391676_74676064.L2","9_34642246_36743286.L2","19_33772047_35978393.L1","7_2022763_2732593.L3","3_42498510_45123661.L1","10_71748755_73662792.L1","2_180448012_181401304.L4,2_181401304_183492880.L1","11_1192365_3644251.L3","3_110794923_113096852.L1","9_131252501_132423455.L1","6_148599216_149932268.L1","9_124209608_126297386.L2","2_37905569_38804195.L1","17_38653091_40721152.L5","19_610729_2098397.L4","2_109814855_113164279.L5","1_109761309_111199115.L2","10_76947056_79116992.L1","2_113164279_116014894.L1","3_140235755_141620255.L2","1_66473721_68012212.L4","22_23370460_24588236.L4","2_127276771_128716867.L1","10_22886203_25289667.L3","5_115494673_116495351.L1","11_87719343_89475768.L1","1_43292786_44503511.L1","7_46947122_49172682.L3","10_91575290_93636611.L2","1_226623159_229020501.L1","8_39081287_40845818.L1","6_68813556_70899807.L1","6_127219316_129539886.L3","19_52482037_54099074.L1","7_16862445_19441924.L4","6_137293081_138501492.L1","11_121305234_122721202.L1","1_153208353_154797927.L1","3_132117672_133533329.L1,3_132117672_133533329.L2","1_204711940_206268085.L2","6_129539886_130614309.L1","14_92665954_93858939.L1","3_185350467_187172556.L3","2_217530757_219589829.L3","4_149762428_151861032.L2","16_1157206_2714828.L3","1_204711940_206268085.L3","10_91575290_93636611.L1,10_91575290_93636611.L3","15_73336373_76106283.L1","19_51029311_52482037.L1","1_25190354_27075376.L2","11_9065770_10930480.L1","3_49279539_51797999.L1","16_74937605_75944056.L1","7_137191815_139059933.L2","9_119498019_122109043.L1","17_71391676_74676064.L1","14_104535386_105874495.L1","7_55623891_57314931.L1","12_57155077_58914885.L1","11_70855_1192365.L4","7_139059933_140233377.L1","11_1192365_3644251.L1","4_53011266_54563389.L2","17_29007226_31459473.L2","14_67525600_70665240.L2","3_118811404_120804208.L2","7_80258753_82393370.L2","14_92665954_93858939.L2","12_57155077_58914885.L2","2_241210506_242147200.L1","1_39734895_41509656.L1","17_61235394_63468228.L1","12_94120791_95627009.L2","3_181793378_184051895.L2","1_70906787_71218722.L1","8_143155464_145078481.L1","1_206268085_208237019.L1","16_31371622_34586599.L2","1_208237019_210614406.L1","18_74304227_75815032.L1","4_149762428_151861032.L1","17_47798656_49440038.L1","19_40478694_41625199.L1","19_8282629_9127717.L1","8_123849219_124671478.L1","9_93909416_96159758.L1","20_9750273_11268888.L3","5_96627815_97979897.L1","6_9019793_10540084.L1","11_95992877_97186058.L1","6_160159465_161748532.L1","19_610729_2098397.L3","2_184415446_189017339.L1","9_82825886_84323281.L1","19_610729_2098397.L1","17_3799018_4792966.L1","7_72409900_73920272.L1","19_46646825_48778970.L2","3_47685722_49279539.L2","5_147802435_149283061.L4","10_93636611_94461486.L3","10_73662792_76947056.L1","8_106398526_107635949.L1","2_98378738_101205867.L2"],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.999999999999847,0.999999999999442,0.99999999999857,0.999999999969237,0.999999976264612,0.999999961562326,0.999999949225681,0.999999860255303,0.99999965022637,0.999999289936676,0.999999215478263,0.999998774308259,0.999993045058709,0.999991595254688,0.999991228650717,0.999986206114315,0.999983026743812,0.999974546202364,0.99997439698381,0.999974088063678,0.999962952421204,0.999959081119329,0.99993581701702,0.999899048254865,0.999843689603177,0.999793053755757,0.999778085916218,0.999743526301369,0.999730372367175,0.999678116807816,0.999629394114317,0.999520570819759,0.999497222460355,0.999104321157698,0.999067190583934,0.99900503581682,0.998976016653751,0.998649933661648,0.998552449969474,0.998335782368086,0.998179242646721,0.997914267752709,0.99715928619052,0.996130536021728,0.995979520256361,0.995846207751496,0.995650262050134,0.994096532819217,0.994046640607306,0.993928713473568,0.993452723995979,0.992939975312964,0.99263507639558,0.992577187472159,0.992432214439505,0.99129109663309,0.991281516118452,0.990997787515927,0.9902543239117,0.990087002533731,0.990027759143583,0.989668574297465,0.989582779268143,0.988948024625609,0.98875260581141,0.988214370575516,0.988197382794641,0.987112998016406,0.98678298710467,0.985953878451934,0.984690805351519,0.982625012819416,0.981979335266367,0.981785685519407,0.979847409735086,0.979799161238675,0.979110046642032,0.978682684954474,0.977773912171123,0.977545551495764,0.976383665596982,0.976319136431963,0.975914083203188,0.974783702084865,0.972499282133224,0.972369642010468,0.97235665036247,0.971978793869547,0.971885103110708,0.971655577744944,0.971640710345223,0.971080871242805,0.970753750167914,0.970480293258608,0.970048313887691,0.968900448502668,0.967002630192417,0.966909219949643,0.966475466126686,0.965666266453409,0.964578430338004,0.962642174320693,0.961854616676318,0.961809425189533,0.961442641944996,0.960647525197034,0.960481788783784,0.960460249298642,0.960015282798285,0.959979177491618,0.959633350831537,0.959504315474945,0.959294660229672,0.95902922033865,0.95897909047438,0.958305404376444,0.958259162834219,0.956609970683278,0.956591917400382,0.956564479423856,0.956545224800035,0.955902673080301,0.954706458901657,0.954467755445039,0.954429054306073,0.953180455825055,0.952491287748118,0.952261385224445,0.951460244378698,0.950716643186998,0.950712129681372,0.94927600542452,0.948120675521074,0.947818011031091,0.94693194843285,0.946385398215282,0.945065221643776,0.943818872648419,0.943744413372506,0.940363134454373,0.93997971904296,0.939325654134415,0.939231031956144,0.939127797166464,0.936713871990745,0.936113236272052,0.935536439239361,0.933990803055843,0.933979376207724,0.933802975377103,0.932553302783409,0.932424336331205,0.932255421236698,0.931906713825214,0.931687599966557,0.931051373277422,0.930424989007394,0.93018743063491,0.929822192339502,0.929768164934264,0.929396602673453,0.929170478436774,0.928991381725977,0.928628857182736,0.92833883096833,0.926635885923778,0.925309677951876,0.924972193117382,0.923928259107197,0.922667979976598,0.922359932647442,0.92193499792456,0.920223321145965,0.919502392970519,0.919487753405857,0.919187915836867,0.916912115650067,0.916820106590739,0.915280954334412,0.910135867710619,0.908880342045359,0.908544548064042,0.908359909487079,0.906173242601669,0.905355861885281,0.905102046047541,0.904400719534849,0.902322543168491,0.899496320504449,0.898462554236429,0.896467443674625,0.896307269217059,0.894668483292533,0.892571326048385,0.889853112920132,0.889330515882859,0.886233366456003,0.885125903959824,0.88486781956021,0.884831346168139,0.88312252702684,0.882436422272788,0.87995638026805,0.87958410511918,0.877134194412505,0.876852168278282,0.874412007526003,0.873849186257847,0.87094485239194,0.867225111580562,0.864448442990047,0.864160308366443,0.863483288957751,0.862972787583156,0.862361446514391,0.862237564526159,0.858396812083871,0.856871373323113,0.856328234500309,0.855122732556164,0.854300346532891,0.851034522337792,0.848748596166265,0.848177425567856,0.846805027250142,0.846620896277117,0.844981741991259,0.842261598042786,0.842074102145222,0.840376654476131,0.838423251413366,0.837063745550649,0.836492079078417,0.835619172511482,0.835596392071356,0.832106956353759,0.831030940604615,0.827727007686532,0.826747000663655,0.825852220999295,0.823356072208437,0.821360621532286,0.820965844184392,0.817473877440039,0.816239631418647,0.814687413085936,0.81161007036436,0.806739794934697,0.805325634529968,0.802442667983512,0.800502115491422],[null,null,null,null,null,null,null,null,null,null,"7_66224822_68769087.L1",null,null,null,"4_80069143_81204161.L2,4_80069143_81204161.L1",null,null,null,null,null,null,"12_67515949_69432762.L1","6_31603441_32714887.L3","6_157797687_160159465.L1",null,null,"2_141761033_143761915.L1",null,null,"19_6684874_8282629.L1",null,null,null,null,"2_197213386_198446401.L3",null,"3_150534217_151630942.L2","4_55681477_58068842.L1","16_55869862_57630418.L1,16_55869862_57630418.L2","1_169117086_170588635.L1",null,"2_158720570_160913222.L1","19_9127717_11173352.L5","8_26825008_28304875.L1",null,"20_2488855_3847766.L1","8_58815541_61416540.L2","9_110015744_112068802.L1",null,null,"12_109898914_112825713.L2","11_46984586_49844498.L1","11_1192365_3644251.L2","4_82451440_83878503.L2",null,"17_44979537_47798656.L2",null,null,"18_75815032_77101859.L2",null,"2_166499460_169111726.L4,2_166499460_169111726.L1",null,"20_38281128_39808119.L1","5_173251324_174215868.L1,5_173251324_174215868.L3",null,"14_34377045_35390387.L1",null,null,"9_1916877_3190064.L2",null,null,"17_5838014_7414079.L1","1_109761309_111199115.L1","1_23594100_25190354.L1","1_99335048_100360849.L1","9_34642246_36743286.L3","3_141620255_143445786.L2","13_112918174_114344378.L2",null,null,null,null,null,"2_217530757_219589829.L1","4_6771316_7537965.L1",null,"1_115337972_118296444.L1","18_23069508_25416687.L2","1_22760390_23594100.L2","16_72901251_74937605.L1",null,null,"19_33772047_35978393.L3","19_45599439_46646825.L1","8_139713400_141963553.L1","8_55033021_56043824.L1",null,"7_36173929_37515581.L1","8_29470379_31276213.L3","4_36018814_37253425.L1","19_43358303_44239955.L1","19_18299052_19766662.L3",null,null,null,"7_28320690_31097675.L1","15_89932319_91621162.L1","16_77489781_78422395.L1","5_170078660_171647288.L1","22_23370460_24588236.L3",null,"17_8403107_10062604.L2",null,null,null,"7_2022763_2732593.L2",null,null,null,"19_18299052_19766662.L2","3_195065945_196244537.L1",null,"21_41901419_43086158.L2",null,null,null,null,"6_121584530_123535036.L1","22_29255810_31043932.L2",null,"4_6771316_7537965.L4","1_29689034_31973084.L1","10_4530082_5941799.L1",null,"10_87367307_89253624.L2",null,null,"20_40982216_41957049.L1","19_33772047_35978393.L4","12_94120791_95627009.L1",null,null,"19_6684874_8282629.L3","2_237852338_239030947.L1","1_7187275_9305140.L2","2_109814855_113164279.L1","3_178389377_179656798.L1",null,"1_178985335_181174985.L1","9_127293231_129403191.L4",null,null,"1_206268085_208237019.L2","15_78223711_80568637.L2",null,"17_5838014_7414079.L2","11_15721006_17556855.L1",null,"7_1313431_2022763.L1",null,"10_98908643_101189482.L2","15_64812469_66802429.L2","19_3019662_4348970.L2","12_121569746_124493434.L2",null,null,"9_127293231_129403191.L1","17_71391676_74676064.L2","9_34642246_36743286.L2","19_33772047_35978393.L1","7_2022763_2732593.L3",null,null,"2_180448012_181401304.L4,2_181401304_183492880.L1","11_1192365_3644251.L3","3_110794923_113096852.L1","9_131252501_132423455.L1","6_148599216_149932268.L1","9_124209608_126297386.L2","2_37905569_38804195.L1","17_38653091_40721152.L5",null,"2_109814855_113164279.L5","1_109761309_111199115.L2","10_76947056_79116992.L1",null,"3_140235755_141620255.L2","1_66473721_68012212.L4","22_23370460_24588236.L4",null,null,"5_115494673_116495351.L1",null,"1_43292786_44503511.L1","7_46947122_49172682.L3","10_91575290_93636611.L2","1_226623159_229020501.L1","8_39081287_40845818.L1",null,"6_127219316_129539886.L3","19_52482037_54099074.L1","7_16862445_19441924.L4",null,"11_121305234_122721202.L1","1_153208353_154797927.L1",null,null,null,"14_92665954_93858939.L1","3_185350467_187172556.L3","2_217530757_219589829.L3",null,null,"1_204711940_206268085.L3","10_91575290_93636611.L1","15_73336373_76106283.L1",null,"1_25190354_27075376.L2","11_9065770_10930480.L1",null,"16_74937605_75944056.L1",null,null,"17_71391676_74676064.L1","14_104535386_105874495.L1",null,"12_57155077_58914885.L1","11_70855_1192365.L4",null,null,null,null,"14_67525600_70665240.L2","3_118811404_120804208.L2","7_80258753_82393370.L2","14_92665954_93858939.L2","12_57155077_58914885.L2","2_241210506_242147200.L1","1_39734895_41509656.L1","17_61235394_63468228.L1","12_94120791_95627009.L2","3_181793378_184051895.L2","1_70906787_71218722.L1",null,null,null,"1_208237019_210614406.L1","18_74304227_75815032.L1",null,"17_47798656_49440038.L1","19_40478694_41625199.L1","19_8282629_9127717.L1","8_123849219_124671478.L1","9_93909416_96159758.L1","20_9750273_11268888.L3","5_96627815_97979897.L1","6_9019793_10540084.L1","11_95992877_97186058.L1",null,null,"2_184415446_189017339.L1",null,"19_610729_2098397.L1","17_3799018_4792966.L1",null,"19_46646825_48778970.L2",null,"5_147802435_149283061.L4","10_93636611_94461486.L3","10_73662792_76947056.L1",null,null],[null,null,null,null,null,null,null,null,null,null,1,null,null,null,1,null,null,null,null,null,null,0.623148338467485,0.999999999999442,0.99999999999857,null,null,0.999999663445192,null,null,0.99999965022637,null,null,null,null,0.999991595254688,null,0.999986206114315,0.999983026743812,0.999974546202364,0.99997439698381,null,0.999962952421204,0.999959081119329,0.99993581701702,null,0.999843689603177,0.999793053755757,0.999778085916218,null,null,0.999678116807816,0.999629394114317,0.999520570819759,0.999497222460355,null,0.0163275989403284,null,null,0.998649933661648,null,0.872263056402856,null,0.997914267752709,0.99715928619052,null,0.995979520256361,null,null,0.888092425061494,null,null,0.993452723995979,0.992939975312964,0.99263507639558,0.992577187472159,0.992432214439505,0.99129109663309,0.991281516118452,null,null,null,null,null,0.989582779268143,0.988542265358772,null,0.988214370575516,0.988197382794641,0.987112998016406,0.98678298710467,null,null,0.982625012819416,0.981979335266367,0.851049087142395,0.979847409735086,null,0.529468624228052,0.978682684954474,0.977773912171123,0.977545551495764,0.976383665596982,null,null,null,0.972499282133224,0.972369642010468,0.879720727904614,0.971978793869547,0.971885103110708,null,0.971640710345223,null,null,null,0.0207557093059665,null,null,null,0.966475466126686,0.018004408660147,null,0.962642174320693,null,null,null,null,0.960481788783784,0.0994990054850675,null,0.194904467823361,0.959633350831537,0.721625263831109,null,0.95902922033865,null,null,0.958259162834219,0.039091989235296,0.895446425982288,null,null,0.955902673080301,0.954706458901657,0.885128061151388,0.954429054306073,0.646208807199849,null,0.359943704849065,0.242962932862461,null,null,0.00591773809513529,0.926853715020213,null,0.94693194843285,0.813507920330152,null,0.943818872648419,null,0.940363134454373,0.93997971904296,0.939325654134415,0.0251100887806606,null,null,0.426845395145688,0.935536439239361,0.020453972599432,0.933979376207724,0.85966780227196,null,null,0.932255421236698,0.845713731365,0.931687599966557,0.844150911662677,0.930424989007394,0.93018743063491,0.929822192339502,0.929768164934264,null,0.929170478436774,0.880315997373079,0.42758410455239,null,0.926635885923778,0.925309677951876,0.924972193117382,null,null,0.922359932647442,null,0.920223321145965,0.919502392970519,0.919487753405857,0.919187915836867,0.882443594665747,null,0.0224471773475062,0.910135867710619,0.508071221427576,null,0.908359909487079,0.906173242601669,null,null,null,0.902322543168491,0.588675223160329,0.881670144334533,null,null,0.894668483292533,0.785569021755624,0.0721589958733235,null,0.886233366456003,0.75849311722897,null,0.884831346168139,null,null,0.198281163843033,0.347359736504953,null,0.327729428435997,0.874412007526003,null,null,null,null,0.864160308366443,0.280270837743998,0.107114088291678,0.645729389068168,0.862237564526159,0.858396812083871,0.856871373323113,0.707403758408563,0.732881884460265,0.00735103578313001,0.574365970457984,null,null,null,0.806658437406554,0.0865324790041394,null,0.542391962375538,0.840376654476131,0.838423251413366,0.837063745550649,0.836492079078417,0.835619172511482,0.385324015486809,0.832106956353759,0.0430037600855633,null,null,0.737120857539066,null,0.821360621532286,0.438275225422164,null,0.460549668692905,null,0.296946395821606,0.221987634725401,0.805325634529968,null,null],[null,null,null,null,"7_5814895_6534226.L2",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"12_67515949_69432762.L2",null,null,"1_34334157_37083582.L1",null,"2_141761033_143761915.L2,2_141761033_143761915.L3",null,null,null,null,null,null,null,null,"17_59410151_61235394.L1",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2_166499460_169111726.L2",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"19_48778970_51029311.L1",null,null,null,"4_6771316_7537965.L3",null,null,null,null,null,null,null,null,null,null,null,null,"7_36173929_37515581.L4",null,null,null,null,null,null,null,null,null,"16_77489781_78422395.L1",null,null,null,null,null,"17_38653091_40721152.L2","20_3847766_5497204.L1",null,null,null,null,null,null,"17_21387045_29007226.L2",null,"22_17193405_17813322.L2",null,null,"6_127219316_129539886.L3",null,"22_29255810_31043932.L2","22_15927607_17193405.L4","4_6771316_7537965.L4",null,"10_4530082_5941799.L1","11_101460390_104088908.L1",null,null,null,null,null,"12_94120791_95627009.L1",null,null,null,null,null,null,null,"10_13279600_14984069.L1","1_178985335_181174985.L1","9_127293231_129403191.L4",null,"17_41743558_43694719.L1",null,"15_78223711_80568637.L2","10_44234627_46978910.L2",null,"11_15721006_17556855.L1","1_100360849_101575460.L4",null,"5_130183332_132803957.L3",null,null,null,"12_121569746_124493434.L2",null,"13_110579726_111595245.L1",null,null,"9_34642246_36743286.L2",null,"7_2022763_2732593.L3",null,"10_71748755_73662792.L1",null,"11_1192365_3644251.L3",null,"9_131252501_132423455.L1",null,null,null,null,"19_610729_2098397.L4",null,"1_109761309_111199115.L2","10_76947056_79116992.L1","2_113164279_116014894.L1",null,null,null,"2_127276771_128716867.L1","10_22886203_25289667.L3",null,"11_87719343_89475768.L1",null,null,null,null,"8_39081287_40845818.L1",null,"6_127219316_129539886.L3",null,"7_16862445_19441924.L4","6_137293081_138501492.L1",null,null,"3_132117672_133533329.L1,3_132117672_133533329.L2","1_204711940_206268085.L2",null,null,"3_185350467_187172556.L3","2_217530757_219589829.L3","4_149762428_151861032.L2","16_1157206_2714828.L3",null,"10_91575290_93636611.L3","15_73336373_76106283.L1","19_51029311_52482037.L1",null,"11_9065770_10930480.L1","3_49279539_51797999.L1",null,"7_137191815_139059933.L2",null,"17_71391676_74676064.L1","14_104535386_105874495.L1","7_55623891_57314931.L1","12_57155077_58914885.L1",null,"7_139059933_140233377.L1","11_1192365_3644251.L1","4_53011266_54563389.L2",null,null,"3_118811404_120804208.L2","7_80258753_82393370.L2","14_92665954_93858939.L2",null,null,null,null,null,"3_181793378_184051895.L2","1_70906787_71218722.L1",null,"1_206268085_208237019.L1","16_31371622_34586599.L2","1_208237019_210614406.L1","18_74304227_75815032.L1",null,"17_47798656_49440038.L1",null,null,null,null,null,"5_96627815_97979897.L1",null,"11_95992877_97186058.L1","6_160159465_161748532.L1","19_610729_2098397.L3","2_184415446_189017339.L1","9_82825886_84323281.L1",null,"17_3799018_4792966.L1","7_72409900_73920272.L1","19_46646825_48778970.L2","3_47685722_49279539.L2","5_147802435_149283061.L4","10_93636611_94461486.L3",null,"8_106398526_107635949.L1","2_98378738_101205867.L2"],[null,null,null,null,0.0698865909065846,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.959782213893373,null,null,0.999999999969237,null,0.885789686130047,null,null,null,null,null,null,null,null,0.999991228650717,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.821324867359057,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.498634411635645,null,null,null,0.0354127719687076,null,null,null,null,null,null,null,null,null,null,null,null,0.955593056230851,null,null,null,null,null,null,null,null,null,0.0927458856424676,null,null,null,null,null,0.970753750167914,0.0417408245595529,null,null,null,null,null,null,0.964578430338004,null,0.961854616676318,null,null,0.00603223598277036,null,0.86096240608463,0.960015282798285,0.765155406271829,null,0.23795817582329,0.959294660229672,null,null,null,null,null,0.0611589919193648,null,null,null,null,null,null,null,0.09149042565445,0.59231768037538,0.709613499141516,null,0.950712129681372,null,0.0212746466234172,0.947818011031091,null,0.13287747788513,0.945065221643776,null,0.943744413372506,null,null,null,0.0116480308644165,null,0.936713871990745,null,null,0.0206711627996573,null,0.0741351731601597,null,0.932424336331205,null,0.0270377475598295,null,0.00376060286021895,null,null,null,null,0.929396602673453,null,0.048676870884939,0.389166133198774,0.111466723554521,null,null,null,0.923928259107197,0.922667979976598,null,0.92193499792456,null,null,null,null,0.03446852098432,null,0.0827892348775993,null,0.400838640790739,0.908544548064042,null,null,0.529337563561216,0.905102046047541,null,null,0.17137933465801,0.016792409901913,0.896467443674625,0.896307269217059,null,0.00653383418877163,0.00838560668976462,0.889330515882859,null,0.126633551597535,0.88486781956021,null,0.88312252702684,null,0.681681829182818,0.0668443118746537,0.877134194412505,0.549123208509549,null,0.649572880374775,0.87094485239194,0.867225111580562,null,null,0.583212469286574,0.594341918639937,0.150665867831976,null,null,null,null,null,0.777526406847746,0.276668551879808,null,0.848177425567856,0.846805027250142,0.0399624588705627,0.738743258437396,null,0.299683959853085,null,null,null,null,null,0.107054587647559,null,0.737202185143114,0.827727007686532,0.826747000663655,0.0819963986988114,0.509062870493644,null,0.382897009332035,0.0175735329896368,0.355767214313713,0.814687413085936,0.514663953254264,0.283976553792158,null,0.802442667983512,0.789921735168344],["1_234463688_235656136.L2,1_234463688_235656136.L3","4_119471529_121736832.L1","6_31603441_32714887.L1","17_78267332_79302554.L3","7_5814895_6534226.L1","15_51385363_52776899.L3","6_28949831_29770194.L2","6_32714887_33268720.L1","6_32714887_33268720.L2","6_28949831_29770194.L3,6_28949831_29770194.L1","7_66224822_68769087.L2,7_66224822_68769087.L3","17_38653091_40721152.L1","8_11421489_13634266.L2","4_119012357_119471529.L1",null,"6_33268720_35487979.L3","6_127219316_129539886.L2","5_132803957_135441711.L1","17_1269105_2025437.L4","19_19766662_20722951.L4,19_19766662_20722951.L3,19_19766662_20722951.L2","6_26791023_28050041.L4","12_69432762_70564207.L2",null,null,null,"2_28375910_28994693.L1",null,"17_78267332_79302554.L1","2_109814855_113164279.L2",null,"10_102620653_104935290.L3","10_101189482_102620653.L1","10_102620653_104935290.L2","19_19766662_20722951.L1",null,null,null,null,null,null,"6_32714887_33268720.L5",null,null,null,"22_31043932_32268999.L1",null,null,null,"2_101205867_102072305.L2","2_198446401_200711561.L1",null,null,null,null,"3_46616010_47685722.L1","17_44979537_47798656.L4","9_112068802_112930865.L1","6_28050041_28949831.L5",null,"18_14440800_21905883.L1","2_166499460_169111726.L1","10_102620653_104935290.L1",null,null,"12_69432762_70564207.L1",null,"3_126496100_128476018.L2","9_91404921_93909416.L2","9_1916877_3190064.L1","5_68555033_71944629.L1","6_33268720_35487979.L1",null,null,null,null,null,null,null,"4_73726673_76209554.L2","19_16263605_18299052.L1","19_48778970_51029311.L1","6_40377376_42070983.L3","17_7414079_8403107.L2",null,null,"19_46646825_48778970.L3",null,null,null,null,"20_63558827_64333810.L1","16_88974757_90226404.L1",null,null,"8_139713400_141963553.L2",null,"9_34642246_36743286.L1",null,null,null,null,null,"12_44631_971165.L1","14_90830516_92665954.L2","17_8403107_10062604.L1",null,null,null,null,null,"11_64037097_66131160.L1",null,"11_72574973_74701306.L1",null,"20_3847766_5497204.L1","7_2022763_2732593.L2","16_3951195_5068344.L3","2_200711561_201953914.L1","5_130183332_132803957.L1",null,"3_195065945_196244537.L1",null,null,null,"9_136047132_136605890.L1","1_226623159_229020501.L2","6_127219316_129539886.L1",null,null,null,null,null,null,null,null,"20_48583442_50623121.L2","12_121569746_124493434.L3",null,"19_33772047_35978393.L2",null,"1_159943258_162376931.L5","2_26672117_28375910.L1",null,null,"1_7187275_9305140.L2",null,"3_178389377_179656798.L1","10_13279600_14984069.L1",null,null,"6_149932268_151591568.L1",null,"1_206268085_208237019.L2",null,null,null,null,null,null,null,null,null,null,"12_121569746_124493434.L2","17_21387045_29007226.L1",null,"9_127293231_129403191.L1",null,"9_34642246_36743286.L2",null,null,"3_42498510_45123661.L1",null,null,"11_1192365_3644251.L3",null,"9_131252501_132423455.L1",null,null,null,null,null,null,null,"10_76947056_79116992.L1","2_113164279_116014894.L1",null,null,null,null,null,null,null,null,null,null,null,null,"6_68813556_70899807.L1","6_127219316_129539886.L3",null,null,null,null,null,"3_132117672_133533329.L2",null,"6_129539886_130614309.L1",null,"3_185350467_187172556.L3",null,null,null,null,"10_91575290_93636611.L1","15_73336373_76106283.L1",null,null,null,null,null,null,"9_119498019_122109043.L1",null,"14_104535386_105874495.L1",null,null,null,"7_139059933_140233377.L1",null,null,"17_29007226_31459473.L2",null,null,"7_80258753_82393370.L2","14_92665954_93858939.L2",null,null,null,"17_61235394_63468228.L1","12_94120791_95627009.L2","3_181793378_184051895.L2",null,"8_143155464_145078481.L1",null,null,null,"18_74304227_75815032.L1","4_149762428_151861032.L1",null,null,null,null,null,null,"5_96627815_97979897.L1",null,"11_95992877_97186058.L1",null,null,"2_184415446_189017339.L1","9_82825886_84323281.L1",null,null,"7_72409900_73920272.L1",null,null,null,"10_93636611_94461486.L3",null,null,"2_98378738_101205867.L2"],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,null,1,1,1,1,1,1,0.999999999989894,null,null,null,0.999999976264612,null,0.999999949225681,0.999999860255303,null,0.999999289936676,0.999999215478263,0.999998774308259,0.999993045058709,null,null,null,null,null,null,0.999974088063678,null,null,null,0.999899048254865,null,null,null,0.999743526301369,0.999730372367175,null,null,null,null,0.999104321157698,0.999051707238897,0.99900503581682,0.998976016653751,null,0.998552449969474,0.895075234045239,0.998179242646721,null,null,0.996130536021728,null,0.995846207751496,0.995650262050134,0.947244168245137,0.994046640607306,0.993928713473568,null,null,null,null,null,null,null,0.990997787515927,0.9902543239117,0.491465922491746,0.990027759143583,0.989668574297465,null,null,0.98875260581141,null,null,null,null,0.985953878451934,0.984690805351519,null,null,0.877715992932479,null,0.979799161238675,null,null,null,null,null,0.976319136431963,0.975914083203188,0.974783702084865,null,null,null,null,null,0.971655577744944,null,0.971080871242805,null,0.928752026147585,0.949341920288621,0.968900448502668,0.967002630192417,0.966909219949643,null,0.947661857793262,null,null,null,0.961809425189533,0.961442641944996,0.960405128863493,null,null,null,null,null,null,null,null,0.95897909047438,0.958305404376444,null,0.954841550483916,null,0.956564479423856,0.956545224800035,null,null,0.0693443733341491,null,0.306971648625206,0.861000862093668,null,null,0.950716643186998,null,0.943359159594366,null,null,null,null,null,null,null,null,null,null,0.902473321180493,0.939127797166464,null,0.509658092864965,null,0.892866070110972,null,null,0.932553302783409,null,null,0.059155415339077,null,0.0831398587545253,null,null,null,null,null,null,null,0.112537829124062,0.816872107413809,null,null,null,null,null,null,null,null,null,null,null,null,0.916820106590739,0.810079368883392,null,null,null,null,null,0.481738319267968,null,0.904400719534849,null,0.13944374083973,null,null,null,null,0.105361496451385,0.809308718714438,null,null,null,null,null,null,0.882436422272788,null,0.465380936256376,null,null,null,0.224276305883072,null,null,0.864448442990047,null,null,0.161526694281994,0.0663364982531491,null,null,null,0.148924476091746,0.122241308446889,0.0694229039020158,null,0.848748596166265,null,null,null,0.019706004549723,0.842261598042786,null,null,null,null,null,null,0.343217788936989,null,0.0521874474572268,null,null,0.00673496476141722,0.314293201714793,null,null,0.799900344450402,null,null,null,0.303370605950435,null,null,0.0105803803530781]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_cs_id<\/th>\n      <th>eQTL_pip<\/th>\n      <th>sQTL_cs_id<\/th>\n      <th>sQTL_pip<\/th>\n      <th>stQTL_cs_id<\/th>\n      <th>stQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>DT::datatable(combined_pip_by_context_cs_multi[combined_pip_by_context_cs_multi$combined_pip&gt;0.8,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Combined PIP by tissue&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-caaf43859fd0889ca800" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-caaf43859fd0889ca800">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Combined PIP by tissue<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272"],["B3GALNT2","C4orf3","C6orf48","DNAH17","FAM220A","GLDN","HLA-A","HLA-DMB","HLA-DRA","HLA-F","KCTD7","MED24","MTMR9","PDE5A","PRDM8","RGL2","RSPO3","SHROOM1","SLC43A2","ZNF506","ZSCAN26","LYZ","MSH5","TAGAP","CSF3R","FOSL2","ARHGAP15","PGS1","ACOXL","CLEC4M","SUFU","TRIM8","CYP17A1","ZNF253","ANKRD44","RPS6KB1","MED12L","REST","NLRC5","SELL","HLA-DMA","MARCH7","AP1M2","PTK2B","DRG1","PTPRA","RAB2A","LPAR1","MAP4K4","BZW1","ALDH2","PTPRJ","LSP1","SEC31A","KIF9","LRRC37A","SUSD1","ZKSCAN8","ZNF516","MIB1","NOSTRIN","SFXN2","BPI","CPEB4","FRS2","KIAA0391","ACAD9","FGD3","VLDLR","CCDC125","ZNF76","ACAP1","CSF1","RUNX3","CDC14A","SPAAR","PAQR9","LAMP1","CXCL6","EPS15L1","BAX","TAF8","SENP3","CXCR2","TBC1D14","ARHGAP35","CD101","TTC39C","ID3","GLG1","HELZ2","ACSF3","ZNF30","PPP5C","SLC45A4","LYN","TLN1","ELMO1","RBPMS","ARAP2","CADM4","LSM4","NINJ2","RIN3","NDEL1","CREB5","FES","WWOX","NPM1","SPECC1L","MUS81","MYH10","P2RY2","GSDMB","SMOX","EIF3B","SMIM22","CFLAR","SLC22A5","ATP13A1","SLC51A","RAB34","C2CD2","MICAL3","INPP5E","PSEN2","ECHDC1","HSF2","RHBDD3","HDHD5","TADA2B","LAPTM5","FBXO18","YAP1","LIPA","FAM65C","RILPL1","EMILIN3","USF2","CEP83","LY9","IFT172","CERS4","UBE2F","RERE","IL1RN","MFN1","BEND7","KIAA1614","MIGA2","ZBTB2","VAT1","PFKFB2","BCL2A1","CXCL12","SLC2A4","NUCB2","S1PR1","MICALL2","PDLIM4","SCD","UBAP1L","CREB3L3","RHOF","TRAF4","CARS2","PKN3","SLC39A11","VCP","HPN","BRAT1","ACKR2","VSIR","CERKL","NAP1L4","CD200R1","POMT1","ZC3H12D","NEK6","ATL2","CDC6","POLR2E","IL1B","CEPT1","DLG5","PSD4","PXYLP1","IL12RB2","GGT5","LIMS2","PRTFDC1","FEM1C","CTSC","TIE1","UPP1","RBP4","COQ8A","ADAM32","SMAP1","RNF146","ZNF320","SNX13","TNFAIP3","UBASH3B","S100A8","DNAJC13","SLC45A3","L3MBTL3","ITPK1","SENP2","SLC23A3","LRBA","CACNA1H","SLC41A1","TNKS2","SCAMP5","CD33","RPS6KA1","AMPD3","NICN1","ZFP1","CREB3L2","TRAF1","CD300A","NUDT14","GBAS","R3HDM2","SIRT3","PARP12","TSPAN32","FIP1L1","NUFIP2","SLC39A9","ARHGAP31","CD36","GOLGA5","SLC26A10","FARP2","CITED4","TBX2","FGD6","MCCC1","ZRANB2","GSDMD","CD46","ITGAX","TRAF3IP3","CNDP2","FAM160A1","NFE2L1","AXL","CD320","RNF139","PTCH1","SLX4IP","ERAP2","GCNT2","CCDC82","MAP3K4","GPX4","CALCRL","HNRNPK","CNN2","ARRB2","TBL2","SPHK2","IP6K2","FBXO38","NOC3L","KAT6B","OXR1","NPAS2"],["1_234463688_235656136.L2,1_234463688_235656136.L3","4_119471529_121736832.L1","6_31603441_32714887.L1","17_78267332_79302554.L3","7_5814895_6534226.L2,7_5814895_6534226.L1","15_51385363_52776899.L3","6_28949831_29770194.L2","6_32714887_33268720.L1","6_32714887_33268720.L2","6_28949831_29770194.L3,6_28949831_29770194.L1","7_66224822_68769087.L1,7_66224822_68769087.L2,7_66224822_68769087.L3","17_38653091_40721152.L1","8_11421489_13634266.L2","4_119012357_119471529.L1","4_80069143_81204161.L2,4_80069143_81204161.L1","6_33268720_35487979.L3","6_127219316_129539886.L2","5_132803957_135441711.L1","17_1269105_2025437.L4","19_19766662_20722951.L4,19_19766662_20722951.L3,19_19766662_20722951.L2","6_26791023_28050041.L4","12_67515949_69432762.L1,12_67515949_69432762.L2,12_69432762_70564207.L2","6_31603441_32714887.L3","6_157797687_160159465.L1","1_34334157_37083582.L1","2_28375910_28994693.L1","2_141761033_143761915.L1,2_141761033_143761915.L2,2_141761033_143761915.L3","17_78267332_79302554.L1","2_109814855_113164279.L2","19_6684874_8282629.L1","10_102620653_104935290.L3","10_101189482_102620653.L1","10_102620653_104935290.L2","19_19766662_20722951.L1","2_197213386_198446401.L3","17_59410151_61235394.L1","3_150534217_151630942.L2","4_55681477_58068842.L1","16_55869862_57630418.L1,16_55869862_57630418.L2","1_169117086_170588635.L1","6_32714887_33268720.L5","2_158720570_160913222.L1","19_9127717_11173352.L5","8_26825008_28304875.L1","22_31043932_32268999.L1","20_2488855_3847766.L1","8_58815541_61416540.L2","9_110015744_112068802.L1","2_101205867_102072305.L2","2_198446401_200711561.L1","12_109898914_112825713.L2","11_46984586_49844498.L1","11_1192365_3644251.L2","4_82451440_83878503.L2","3_46616010_47685722.L1","17_44979537_47798656.L2,17_44979537_47798656.L4","9_112068802_112930865.L1","6_28050041_28949831.L5","18_75815032_77101859.L2","18_14440800_21905883.L1","2_166499460_169111726.L4,2_166499460_169111726.L1,2_166499460_169111726.L2","10_102620653_104935290.L1","20_38281128_39808119.L1","5_173251324_174215868.L1,5_173251324_174215868.L3","12_69432762_70564207.L1","14_34377045_35390387.L1","3_126496100_128476018.L2","9_91404921_93909416.L2","9_1916877_3190064.L2,9_1916877_3190064.L1","5_68555033_71944629.L1","6_33268720_35487979.L1","17_5838014_7414079.L1","1_109761309_111199115.L1","1_23594100_25190354.L1","1_99335048_100360849.L1","9_34642246_36743286.L3","3_141620255_143445786.L2","13_112918174_114344378.L2","4_73726673_76209554.L2","19_16263605_18299052.L1","19_48778970_51029311.L1","6_40377376_42070983.L3","17_7414079_8403107.L2","2_217530757_219589829.L1","4_6771316_7537965.L1,4_6771316_7537965.L3","19_46646825_48778970.L3","1_115337972_118296444.L1","18_23069508_25416687.L2","1_22760390_23594100.L2","16_72901251_74937605.L1","20_63558827_64333810.L1","16_88974757_90226404.L1","19_33772047_35978393.L3","19_45599439_46646825.L1","8_139713400_141963553.L1,8_139713400_141963553.L2","8_55033021_56043824.L1","9_34642246_36743286.L1","7_36173929_37515581.L1,7_36173929_37515581.L4","8_29470379_31276213.L3","4_36018814_37253425.L1","19_43358303_44239955.L1","19_18299052_19766662.L3","12_44631_971165.L1","14_90830516_92665954.L2","17_8403107_10062604.L1","7_28320690_31097675.L1","15_89932319_91621162.L1","16_77489781_78422395.L1","5_170078660_171647288.L1","22_23370460_24588236.L3","11_64037097_66131160.L1","17_8403107_10062604.L2","11_72574973_74701306.L1","17_38653091_40721152.L2","20_3847766_5497204.L1","7_2022763_2732593.L2","16_3951195_5068344.L3","2_200711561_201953914.L1","5_130183332_132803957.L1","19_18299052_19766662.L2","3_195065945_196244537.L1","17_21387045_29007226.L2","21_41901419_43086158.L2","22_17193405_17813322.L2","9_136047132_136605890.L1","1_226623159_229020501.L2","6_127219316_129539886.L3,6_127219316_129539886.L1","6_121584530_123535036.L1","22_29255810_31043932.L2","22_15927607_17193405.L4","4_6771316_7537965.L4","1_29689034_31973084.L1","10_4530082_5941799.L1","11_101460390_104088908.L1","10_87367307_89253624.L2","20_48583442_50623121.L2","12_121569746_124493434.L3","20_40982216_41957049.L1","19_33772047_35978393.L4,19_33772047_35978393.L2","12_94120791_95627009.L1","1_159943258_162376931.L5","2_26672117_28375910.L1","19_6684874_8282629.L3","2_237852338_239030947.L1","1_7187275_9305140.L2","2_109814855_113164279.L1","3_178389377_179656798.L1","10_13279600_14984069.L1","1_178985335_181174985.L1","9_127293231_129403191.L4","6_149932268_151591568.L1","17_41743558_43694719.L1","1_206268085_208237019.L2","15_78223711_80568637.L2","10_44234627_46978910.L2","17_5838014_7414079.L2","11_15721006_17556855.L1","1_100360849_101575460.L4","7_1313431_2022763.L1","5_130183332_132803957.L3","10_98908643_101189482.L2","15_64812469_66802429.L2","19_3019662_4348970.L2","12_121569746_124493434.L2","17_21387045_29007226.L1","13_110579726_111595245.L1","9_127293231_129403191.L1","17_71391676_74676064.L2","9_34642246_36743286.L2","19_33772047_35978393.L1","7_2022763_2732593.L3","3_42498510_45123661.L1","10_71748755_73662792.L1","2_180448012_181401304.L4,2_181401304_183492880.L1","11_1192365_3644251.L3","3_110794923_113096852.L1","9_131252501_132423455.L1","6_148599216_149932268.L1","9_124209608_126297386.L2","2_37905569_38804195.L1","17_38653091_40721152.L5","19_610729_2098397.L4","2_109814855_113164279.L5","1_109761309_111199115.L2","10_76947056_79116992.L1","2_113164279_116014894.L1","3_140235755_141620255.L2","1_66473721_68012212.L4","22_23370460_24588236.L4","2_127276771_128716867.L1","10_22886203_25289667.L3","5_115494673_116495351.L1","11_87719343_89475768.L1","1_43292786_44503511.L1","7_46947122_49172682.L3","10_91575290_93636611.L2","1_226623159_229020501.L1","8_39081287_40845818.L1","6_68813556_70899807.L1","6_127219316_129539886.L3","19_52482037_54099074.L1","7_16862445_19441924.L4","6_137293081_138501492.L1","11_121305234_122721202.L1","1_153208353_154797927.L1","3_132117672_133533329.L1,3_132117672_133533329.L2","1_204711940_206268085.L2","6_129539886_130614309.L1","14_92665954_93858939.L1","3_185350467_187172556.L3","2_217530757_219589829.L3","4_149762428_151861032.L2","16_1157206_2714828.L3","1_204711940_206268085.L3","10_91575290_93636611.L1,10_91575290_93636611.L3","15_73336373_76106283.L1","19_51029311_52482037.L1","1_25190354_27075376.L2","11_9065770_10930480.L1","3_49279539_51797999.L1","16_74937605_75944056.L1","7_137191815_139059933.L2","9_119498019_122109043.L1","17_71391676_74676064.L1","14_104535386_105874495.L1","7_55623891_57314931.L1","12_57155077_58914885.L1","11_70855_1192365.L4","7_139059933_140233377.L1","11_1192365_3644251.L1","4_53011266_54563389.L2","17_29007226_31459473.L2","14_67525600_70665240.L2","3_118811404_120804208.L2","7_80258753_82393370.L2","14_92665954_93858939.L2","12_57155077_58914885.L2","2_241210506_242147200.L1","1_39734895_41509656.L1","17_61235394_63468228.L1","12_94120791_95627009.L2","3_181793378_184051895.L2","1_70906787_71218722.L1","8_143155464_145078481.L1","1_206268085_208237019.L1","16_31371622_34586599.L2","1_208237019_210614406.L1","18_74304227_75815032.L1","4_149762428_151861032.L1","17_47798656_49440038.L1","19_40478694_41625199.L1","19_8282629_9127717.L1","8_123849219_124671478.L1","9_93909416_96159758.L1","20_9750273_11268888.L3","5_96627815_97979897.L1","6_9019793_10540084.L1","11_95992877_97186058.L1","6_160159465_161748532.L1","19_610729_2098397.L3","2_184415446_189017339.L1","9_82825886_84323281.L1","19_610729_2098397.L1","17_3799018_4792966.L1","7_72409900_73920272.L1","19_46646825_48778970.L2","3_47685722_49279539.L2","5_147802435_149283061.L4","10_93636611_94461486.L3","10_73662792_76947056.L1","8_106398526_107635949.L1","2_98378738_101205867.L2"],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.999999999999847,0.999999999999442,0.99999999999857,0.999999999969237,0.999999976264612,0.999999961562326,0.999999949225681,0.999999860255303,0.99999965022637,0.999999289936676,0.999999215478263,0.999998774308259,0.999993045058709,0.999991595254688,0.999991228650717,0.999986206114315,0.999983026743812,0.999974546202364,0.99997439698381,0.999974088063678,0.999962952421204,0.999959081119329,0.99993581701702,0.999899048254865,0.999843689603177,0.999793053755757,0.999778085916218,0.999743526301369,0.999730372367175,0.999678116807816,0.999629394114317,0.999520570819759,0.999497222460355,0.999104321157698,0.999067190583934,0.99900503581682,0.998976016653751,0.998649933661648,0.998552449969474,0.998335782368086,0.998179242646721,0.997914267752709,0.99715928619052,0.996130536021728,0.995979520256361,0.995846207751496,0.995650262050134,0.994096532819217,0.994046640607306,0.993928713473568,0.993452723995979,0.992939975312964,0.99263507639558,0.992577187472159,0.992432214439505,0.99129109663309,0.991281516118452,0.990997787515927,0.9902543239117,0.990087002533731,0.990027759143583,0.989668574297465,0.989582779268143,0.988948024625609,0.98875260581141,0.988214370575516,0.988197382794641,0.987112998016406,0.98678298710467,0.985953878451934,0.984690805351519,0.982625012819416,0.981979335266367,0.981785685519407,0.979847409735086,0.979799161238675,0.979110046642032,0.978682684954474,0.977773912171123,0.977545551495764,0.976383665596982,0.976319136431963,0.975914083203188,0.974783702084865,0.972499282133224,0.972369642010468,0.97235665036247,0.971978793869547,0.971885103110708,0.971655577744944,0.971640710345223,0.971080871242805,0.970753750167914,0.970480293258608,0.970048313887691,0.968900448502668,0.967002630192417,0.966909219949643,0.966475466126686,0.965666266453409,0.964578430338004,0.962642174320693,0.961854616676318,0.961809425189533,0.961442641944996,0.960647525197034,0.960481788783784,0.960460249298642,0.960015282798285,0.959979177491618,0.959633350831537,0.959504315474945,0.959294660229672,0.95902922033865,0.95897909047438,0.958305404376444,0.958259162834219,0.956609970683278,0.956591917400382,0.956564479423856,0.956545224800035,0.955902673080301,0.954706458901657,0.954467755445039,0.954429054306073,0.953180455825055,0.952491287748118,0.952261385224445,0.951460244378698,0.950716643186998,0.950712129681372,0.94927600542452,0.948120675521074,0.947818011031091,0.94693194843285,0.946385398215282,0.945065221643776,0.943818872648419,0.943744413372506,0.940363134454373,0.93997971904296,0.939325654134415,0.939231031956144,0.939127797166464,0.936713871990745,0.936113236272052,0.935536439239361,0.933990803055843,0.933979376207724,0.933802975377103,0.932553302783409,0.932424336331205,0.932255421236698,0.931906713825214,0.931687599966557,0.931051373277422,0.930424989007394,0.93018743063491,0.929822192339502,0.929768164934264,0.929396602673453,0.929170478436774,0.928991381725977,0.928628857182736,0.92833883096833,0.926635885923778,0.925309677951876,0.924972193117382,0.923928259107197,0.922667979976598,0.922359932647442,0.92193499792456,0.920223321145965,0.919502392970519,0.919487753405857,0.919187915836867,0.916912115650067,0.916820106590739,0.915280954334412,0.910135867710619,0.908880342045359,0.908544548064042,0.908359909487079,0.906173242601669,0.905355861885281,0.905102046047541,0.904400719534849,0.902322543168491,0.899496320504449,0.898462554236429,0.896467443674625,0.896307269217059,0.894668483292533,0.892571326048385,0.889853112920132,0.889330515882859,0.886233366456003,0.885125903959824,0.88486781956021,0.884831346168139,0.88312252702684,0.882436422272788,0.87995638026805,0.87958410511918,0.877134194412505,0.876852168278282,0.874412007526003,0.873849186257847,0.87094485239194,0.867225111580562,0.864448442990047,0.864160308366443,0.863483288957751,0.862972787583156,0.862361446514391,0.862237564526159,0.858396812083871,0.856871373323113,0.856328234500309,0.855122732556164,0.854300346532891,0.851034522337792,0.848748596166265,0.848177425567856,0.846805027250142,0.846620896277117,0.844981741991259,0.842261598042786,0.842074102145222,0.840376654476131,0.838423251413366,0.837063745550649,0.836492079078417,0.835619172511482,0.835596392071356,0.832106956353759,0.831030940604615,0.827727007686532,0.826747000663655,0.825852220999295,0.823356072208437,0.821360621532286,0.820965844184392,0.817473877440039,0.816239631418647,0.814687413085936,0.81161007036436,0.806739794934697,0.805325634529968,0.802442667983512,0.800502115491422],[null,null,"6_31603441_32714887.L1",null,null,null,"6_28949831_29770194.L2",null,null,null,null,null,null,null,null,null,null,"5_132803957_135441711.L1",null,"19_19766662_20722951.L4",null,"12_67515949_69432762.L1,12_67515949_69432762.L2,12_69432762_70564207.L2","6_31603441_32714887.L3","6_157797687_160159465.L1",null,null,"2_141761033_143761915.L1,2_141761033_143761915.L2",null,null,null,null,null,null,null,null,null,"3_150534217_151630942.L2",null,"16_55869862_57630418.L1","1_169117086_170588635.L1",null,null,"19_9127717_11173352.L5","8_26825008_28304875.L1",null,null,null,"9_110015744_112068802.L1","2_101205867_102072305.L2",null,"12_109898914_112825713.L2","11_46984586_49844498.L1","11_1192365_3644251.L2",null,null,null,null,null,"18_75815032_77101859.L2",null,null,null,null,"5_173251324_174215868.L1",null,"14_34377045_35390387.L1",null,"9_91404921_93909416.L2","9_1916877_3190064.L2,9_1916877_3190064.L1","5_68555033_71944629.L1",null,"17_5838014_7414079.L1",null,"1_23594100_25190354.L1","1_99335048_100360849.L1",null,"3_141620255_143445786.L2","13_112918174_114344378.L2",null,null,"19_48778970_51029311.L1","6_40377376_42070983.L3",null,"2_217530757_219589829.L1","4_6771316_7537965.L1",null,"1_115337972_118296444.L1","18_23069508_25416687.L2","1_22760390_23594100.L2","16_72901251_74937605.L1","20_63558827_64333810.L1",null,null,"19_45599439_46646825.L1","8_139713400_141963553.L1","8_55033021_56043824.L1",null,"7_36173929_37515581.L1",null,"4_36018814_37253425.L1","19_43358303_44239955.L1",null,"12_44631_971165.L1",null,"17_8403107_10062604.L1","7_28320690_31097675.L1","15_89932319_91621162.L1",null,null,"22_23370460_24588236.L3",null,null,null,"17_38653091_40721152.L2","20_3847766_5497204.L1",null,"16_3951195_5068344.L3",null,"5_130183332_132803957.L1","19_18299052_19766662.L2",null,"17_21387045_29007226.L2",null,null,null,null,"6_127219316_129539886.L3","6_121584530_123535036.L1",null,null,null,null,"10_4530082_5941799.L1",null,"10_87367307_89253624.L2","20_48583442_50623121.L2","12_121569746_124493434.L3",null,"19_33772047_35978393.L2",null,"1_159943258_162376931.L5",null,null,"2_237852338_239030947.L1","1_7187275_9305140.L2",null,null,null,null,"9_127293231_129403191.L4",null,null,"1_206268085_208237019.L2","15_78223711_80568637.L2",null,null,"11_15721006_17556855.L1","1_100360849_101575460.L4",null,null,null,null,"19_3019662_4348970.L2","12_121569746_124493434.L2",null,null,"9_127293231_129403191.L1","17_71391676_74676064.L2","9_34642246_36743286.L2","19_33772047_35978393.L1","7_2022763_2732593.L3",null,null,null,null,null,"9_131252501_132423455.L1",null,"9_124209608_126297386.L2",null,"17_38653091_40721152.L5",null,"2_109814855_113164279.L5",null,"10_76947056_79116992.L1","2_113164279_116014894.L1","3_140235755_141620255.L2","1_66473721_68012212.L4",null,null,null,"5_115494673_116495351.L1","11_87719343_89475768.L1","1_43292786_44503511.L1","7_46947122_49172682.L3","10_91575290_93636611.L2","1_226623159_229020501.L1",null,null,"6_127219316_129539886.L3","19_52482037_54099074.L1",null,null,null,"1_153208353_154797927.L1",null,null,null,null,"3_185350467_187172556.L3","2_217530757_219589829.L3","4_149762428_151861032.L2",null,null,"10_91575290_93636611.L1",null,"19_51029311_52482037.L1",null,null,"3_49279539_51797999.L1",null,null,null,"17_71391676_74676064.L1","14_104535386_105874495.L1","7_55623891_57314931.L1","12_57155077_58914885.L1",null,"7_139059933_140233377.L1","11_1192365_3644251.L1","4_53011266_54563389.L2",null,"14_67525600_70665240.L2",null,"7_80258753_82393370.L2","14_92665954_93858939.L2",null,null,"1_39734895_41509656.L1",null,null,null,"1_70906787_71218722.L1",null,null,null,"1_208237019_210614406.L1","18_74304227_75815032.L1","4_149762428_151861032.L1",null,"19_40478694_41625199.L1",null,"8_123849219_124671478.L1",null,null,"5_96627815_97979897.L1","6_9019793_10540084.L1","11_95992877_97186058.L1",null,null,"2_184415446_189017339.L1","9_82825886_84323281.L1",null,"17_3799018_4792966.L1","7_72409900_73920272.L1",null,null,"5_147802435_149283061.L4",null,null,"8_106398526_107635949.L1",null],[null,null,1,null,null,null,1,null,null,null,null,null,null,null,null,null,null,1,null,0.482385320231653,null,0.999999999997419,0.999999999999442,0.99999999999857,null,null,0.999999919417678,null,null,null,null,null,null,null,null,null,0.999986206114315,null,0.9890816986404,0.99997439698381,null,null,0.999959081119329,0.99993581701702,null,null,null,0.999778085916218,0.999743526301369,null,0.999678116807816,0.999629394114317,0.999520570819759,null,null,null,null,null,0.998649933661648,null,null,null,null,0.994680186180728,null,0.995979520256361,null,0.995650262050134,0.994096532819217,0.994046640607306,null,0.928800503595091,null,0.591297352162389,0.0899525421596085,null,0.99129109663309,0.991281516118452,null,null,0.168262167668974,0.990027759143583,null,0.989582779268143,0.988542265358772,null,0.93045750184104,0.988197382794641,0.694308909830129,0.98678298710467,0.985953878451934,null,null,0.0322902838320557,0.851049087142395,0.979847409735086,null,0.529468624228052,null,0.40363703855759,0.776896782440585,null,0.976319136431963,null,0.974783702084865,0.972499282133224,0.972369642010468,null,null,0.31242044840013,null,null,null,0.0627357606659994,0.928752026147585,null,0.968900448502668,null,0.966909219949643,0.966475466126686,null,0.48520257701951,null,null,null,null,0.00240926156514187,0.026055815578428,null,null,null,null,0.0289242518683142,null,0.95902922033865,0.95897909047438,0.958305404376444,null,0.416607550686125,null,0.0163441667583707,null,null,0.929055420858027,0.954467755445039,null,null,null,null,0.223214742078305,null,null,0.0903647000805223,0.93855086886889,null,null,0.54601887734558,0.176137411170526,null,null,null,null,0.939325654134415,0.0023492363669102,null,null,0.936113236272052,0.935536439239361,0.142411203775037,0.933979376207724,0.761719450895058,null,null,null,null,null,0.167561996000162,null,0.93018743063491,null,0.406535947038267,null,0.929170478436774,null,0.160850465945512,0.0698252966277148,0.926635885923778,0.925309677951876,null,null,null,0.922359932647442,0.156878227506604,0.920223321145965,0.119888445197537,0.901658977787144,0.919187915836867,null,null,0.0125721878967243,0.178212566191089,null,null,null,0.906173242601669,null,null,null,null,0.0516703661486407,0.0282003079717777,0.216533661043683,null,null,0.785569021755624,null,0.24447556205672,null,null,0.0349820359593841,null,null,null,0.12308772655978,0.218199970756435,0.0667888170431982,0.0667428597656818,null,0.163700077597399,0.87094485239194,0.070905895349528,null,0.864160308366443,null,0.18294356083148,0.13446133941385,null,null,0.856871373323113,null,null,null,0.390574082294089,null,null,null,0.71629223831454,0.0282904255448807,0.842261598042786,null,0.840376654476131,null,0.412620336600404,null,null,0.25163656504664,0.832106956353759,0.161506442437506,null,null,0.118391061217921,0.0714668676096184,null,0.437805802840579,0.384116925106477,null,null,0.0548468095703859,null,null,0.0623127474791074,null],["1_234463688_235656136.L2",null,null,null,null,null,null,null,"6_32714887_33268720.L2",null,"7_66224822_68769087.L3",null,null,null,"4_80069143_81204161.L1",null,null,null,null,null,null,"12_67515949_69432762.L2",null,null,"1_34334157_37083582.L1",null,"2_141761033_143761915.L3",null,null,null,null,null,null,null,"2_197213386_198446401.L3","17_59410151_61235394.L1",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2_166499460_169111726.L4,2_166499460_169111726.L2",null,null,"5_173251324_174215868.L3",null,null,null,null,null,null,null,null,"1_109761309_111199115.L1","1_23594100_25190354.L1","1_99335048_100360849.L1","9_34642246_36743286.L3",null,null,null,null,null,null,null,null,"4_6771316_7537965.L3",null,"1_115337972_118296444.L1",null,null,null,null,null,null,null,null,null,null,"7_36173929_37515581.L4",null,"4_36018814_37253425.L1","19_43358303_44239955.L1","19_18299052_19766662.L3",null,"14_90830516_92665954.L2",null,null,null,"16_77489781_78422395.L1","5_170078660_171647288.L1",null,"11_64037097_66131160.L1","17_8403107_10062604.L2",null,null,null,null,null,"2_200711561_201953914.L1",null,null,null,"17_21387045_29007226.L2",null,"22_17193405_17813322.L2",null,null,"6_127219316_129539886.L3","6_121584530_123535036.L1",null,"22_15927607_17193405.L4","4_6771316_7537965.L4",null,"10_4530082_5941799.L1","11_101460390_104088908.L1",null,null,null,null,"19_33772047_35978393.L2",null,null,null,"19_6684874_8282629.L3",null,null,"2_109814855_113164279.L1","3_178389377_179656798.L1",null,"1_178985335_181174985.L1","9_127293231_129403191.L4",null,null,"1_206268085_208237019.L2","15_78223711_80568637.L2",null,"17_5838014_7414079.L2","11_15721006_17556855.L1","1_100360849_101575460.L4",null,"5_130183332_132803957.L3","10_98908643_101189482.L2",null,null,"12_121569746_124493434.L2",null,"13_110579726_111595245.L1",null,null,"9_34642246_36743286.L2",null,"7_2022763_2732593.L3","3_42498510_45123661.L1",null,"2_181401304_183492880.L1",null,"3_110794923_113096852.L1",null,null,null,null,"17_38653091_40721152.L5",null,null,"1_109761309_111199115.L2","10_76947056_79116992.L1","2_113164279_116014894.L1",null,null,null,"2_127276771_128716867.L1",null,null,"11_87719343_89475768.L1",null,"7_46947122_49172682.L3","10_91575290_93636611.L2",null,"8_39081287_40845818.L1","6_68813556_70899807.L1","6_127219316_129539886.L3","19_52482037_54099074.L1","7_16862445_19441924.L4",null,null,null,"3_132117672_133533329.L1,3_132117672_133533329.L2","1_204711940_206268085.L2","6_129539886_130614309.L1",null,"3_185350467_187172556.L3","2_217530757_219589829.L3",null,null,null,"10_91575290_93636611.L3,10_91575290_93636611.L1","15_73336373_76106283.L1","19_51029311_52482037.L1",null,"11_9065770_10930480.L1","3_49279539_51797999.L1",null,"7_137191815_139059933.L2",null,"17_71391676_74676064.L1","14_104535386_105874495.L1","7_55623891_57314931.L1",null,null,"7_139059933_140233377.L1",null,"4_53011266_54563389.L2",null,null,"3_118811404_120804208.L2","7_80258753_82393370.L2","14_92665954_93858939.L2","12_57155077_58914885.L2",null,null,null,"12_94120791_95627009.L2","3_181793378_184051895.L2","1_70906787_71218722.L1",null,"1_206268085_208237019.L1","16_31371622_34586599.L2","1_208237019_210614406.L1","18_74304227_75815032.L1",null,"17_47798656_49440038.L1",null,"19_8282629_9127717.L1",null,null,"20_9750273_11268888.L3","5_96627815_97979897.L1",null,"11_95992877_97186058.L1","6_160159465_161748532.L1",null,"2_184415446_189017339.L1","9_82825886_84323281.L1",null,"17_3799018_4792966.L1",null,"19_46646825_48778970.L2","3_47685722_49279539.L2","5_147802435_149283061.L4","10_93636611_94461486.L3",null,"8_106398526_107635949.L1","2_98378738_101205867.L2"],[1,null,null,null,null,null,null,null,1,null,1,null,null,null,1,null,null,null,null,null,null,0.131789901468656,null,null,0.999999999969237,null,0.0846661720001127,null,null,null,null,null,null,null,0.999991595254688,0.999991228650717,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.920947348362035,null,null,0.466012474836518,null,null,null,null,null,null,null,null,0.199352655442022,0.152937252401216,0.181403835357191,0.645145545163889,null,null,null,null,null,null,null,null,0.0354127719687076,null,0.0577568687344766,null,null,null,null,null,null,null,null,null,null,0.955593056230851,null,0.574136873613533,0.200805760922143,0.250088443497706,null,0.709494494615523,null,null,null,0.0963083066387541,0.0309383435299156,null,0.117122916374199,0.971640710345223,null,null,null,null,null,0.967002630192417,null,null,null,0.0153695486539215,null,0.0598480177724272,null,null,0.002057457612057,0.458006503424761,null,0.151464152222155,0.0740420406094822,null,0.365240463750676,0.0139628210420074,null,null,null,null,0.0346376200582688,null,null,null,0.0614279915084143,null,null,0.613261789260066,0.200846589648917,null,0.238642314329362,0.122580293907932,null,null,0.0061882493901052,0.0095733372643918,null,0.292470010336529,0.0219255998747636,0.144104498708587,null,0.0983964436596161,0.940363134454373,null,null,0.00192199673897775,null,0.127332036628305,null,null,0.0655961018660892,null,0.00732501017405285,0.0700654747777104,null,0.867360541006628,null,0.168258945621386,null,null,null,null,0.105047538383118,null,null,0.048676870884939,0.0388182036905451,0.858513534340616,null,null,null,0.111305842300168,null,null,0.0427516327974085,null,0.0248629714678511,0.0178636491920315,null,0.0689229940940813,0.717178585240694,0.0102857768205393,0.127971735756907,0.0407614270060349,null,null,null,0.345203339284195,0.132155060744281,0.0492645675176969,null,0.023266970393383,0.349390540704562,null,null,null,0.108224625555971,0.0639860917761959,0.133287167369993,null,0.719196349344237,0.0858602733325876,null,0.0236278895887999,null,0.756874958958424,0.0552251872703029,0.0546423893447024,null,null,0.0850682473315855,null,0.192145693221656,null,null,0.16672876975557,0.048805659865776,0.121573844044347,0.862237564526159,null,null,null,0.231298033251394,0.144370672402711,0.0401588408916863,null,0.0862660629596261,0.175043617434645,0.0698533311775121,0.0309785408609776,null,0.20603588635773,null,0.721617613507252,null,null,0.214002981285891,0.0723107511756464,null,0.0883483103754824,0.148829871437906,null,0.633082617288177,0.0179133992500808,null,0.025834217054835,null,0.279220513448768,0.0841330826591116,0.0740992195509926,0.0562702159236967,null,0.0509803602931715,0.145822273402195],[null,null,null,"17_78267332_79302554.L3",null,null,null,null,null,null,"7_66224822_68769087.L2","17_38653091_40721152.L1",null,null,null,null,"6_127219316_129539886.L2",null,null,"19_19766662_20722951.L4",null,"12_67515949_69432762.L2",null,null,null,null,"2_141761033_143761915.L3",null,null,null,null,null,null,"19_19766662_20722951.L1",null,null,null,null,"16_55869862_57630418.L2",null,"6_32714887_33268720.L5","2_158720570_160913222.L1",null,null,null,null,"8_58815541_61416540.L2",null,null,null,null,null,null,"4_82451440_83878503.L2",null,"17_44979537_47798656.L4",null,null,null,null,"2_166499460_169111726.L1","10_102620653_104935290.L1","20_38281128_39808119.L1",null,"12_69432762_70564207.L1",null,"3_126496100_128476018.L2",null,null,null,"6_33268720_35487979.L1",null,"1_109761309_111199115.L1","1_23594100_25190354.L1","1_99335048_100360849.L1","9_34642246_36743286.L3",null,null,null,null,null,null,"17_7414079_8403107.L2",null,null,null,null,null,"1_22760390_23594100.L2",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"5_170078660_171647288.L1","22_23370460_24588236.L3",null,null,null,null,null,"7_2022763_2732593.L2",null,null,null,null,null,"17_21387045_29007226.L2",null,"22_17193405_17813322.L2",null,null,"6_127219316_129539886.L1",null,"22_29255810_31043932.L2",null,"4_6771316_7537965.L4","1_29689034_31973084.L1","10_4530082_5941799.L1","11_101460390_104088908.L1",null,null,null,null,"19_33772047_35978393.L2","12_94120791_95627009.L1",null,null,null,null,null,null,"3_178389377_179656798.L1","10_13279600_14984069.L1","1_178985335_181174985.L1","9_127293231_129403191.L4",null,null,"1_206268085_208237019.L2",null,"10_44234627_46978910.L2","17_5838014_7414079.L2","11_15721006_17556855.L1","1_100360849_101575460.L4",null,"5_130183332_132803957.L3",null,null,null,"12_121569746_124493434.L2",null,"13_110579726_111595245.L1",null,null,"9_34642246_36743286.L2",null,"7_2022763_2732593.L3","3_42498510_45123661.L1",null,null,null,"3_110794923_113096852.L1",null,null,null,null,"17_38653091_40721152.L5","19_610729_2098397.L4",null,null,"10_76947056_79116992.L1",null,null,null,null,"2_127276771_128716867.L1",null,null,"11_87719343_89475768.L1",null,"7_46947122_49172682.L3",null,null,"8_39081287_40845818.L1",null,"6_127219316_129539886.L3","19_52482037_54099074.L1","7_16862445_19441924.L4","6_137293081_138501492.L1","11_121305234_122721202.L1",null,"3_132117672_133533329.L1,3_132117672_133533329.L2","1_204711940_206268085.L2","6_129539886_130614309.L1","14_92665954_93858939.L1","3_185350467_187172556.L3","2_217530757_219589829.L3","4_149762428_151861032.L2","16_1157206_2714828.L3",null,null,null,"19_51029311_52482037.L1",null,"11_9065770_10930480.L1","3_49279539_51797999.L1",null,"7_137191815_139059933.L2","9_119498019_122109043.L1",null,"14_104535386_105874495.L1","7_55623891_57314931.L1","12_57155077_58914885.L1",null,"7_139059933_140233377.L1",null,"4_53011266_54563389.L2",null,null,null,"7_80258753_82393370.L2","14_92665954_93858939.L2",null,"2_241210506_242147200.L1",null,null,null,"3_181793378_184051895.L2","1_70906787_71218722.L1","8_143155464_145078481.L1","1_206268085_208237019.L1","16_31371622_34586599.L2","1_208237019_210614406.L1","18_74304227_75815032.L1",null,"17_47798656_49440038.L1",null,"19_8282629_9127717.L1","8_123849219_124671478.L1","9_93909416_96159758.L1",null,"5_96627815_97979897.L1",null,"11_95992877_97186058.L1","6_160159465_161748532.L1",null,"2_184415446_189017339.L1","9_82825886_84323281.L1","19_610729_2098397.L1","17_3799018_4792966.L1","7_72409900_73920272.L1","19_46646825_48778970.L2","3_47685722_49279539.L2","5_147802435_149283061.L4","10_93636611_94461486.L3",null,"8_106398526_107635949.L1","2_98378738_101205867.L2"],[null,null,null,1,null,null,null,null,null,null,1,1,null,null,null,null,1,null,null,0.501060465433235,null,0.505821604407977,null,null,null,null,0.438330716144222,null,null,null,null,null,null,0.999993045058709,null,null,null,null,0.997668391277757,null,0.999974088063678,0.999962952421204,null,null,null,null,0.999793053755757,null,null,null,null,null,null,0.999497222460355,null,0.999051707238897,null,null,null,null,0.034323549649708,0.998179242646721,0.997914267752709,null,0.996130536021728,null,0.995846207751496,null,null,null,0.993928713473568,null,0.32544556349231,0.249619323234736,0.296121832308758,0.232973553595017,null,null,null,null,null,null,0.989668574297465,null,null,null,null,null,0.292917974901244,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.941040450339632,0.425026928139677,null,null,null,null,null,0.0716813238178761,null,null,null,null,null,0.0899693121435287,null,0.304044192275119,null,null,0.135897188154484,null,0.69993590103886,null,0.120871859620727,0.959633350831537,0.0908229154873809,0.603266744651207,null,null,null,null,0.0371067464513013,0.0191132365347224,null,null,null,null,null,null,0.445362217550932,0.0397495166214187,0.476123517690838,0.314354610502547,null,null,0.00591773809513529,null,0.947818011031091,0.477462076993444,0.0841524481874844,0.624823311768579,null,0.3537649470747,null,null,null,0.007376798196989,null,0.488711947503136,null,null,0.031430550916681,null,0.0518170990724146,0.110423382410174,null,null,null,0.274685481621429,null,null,null,null,0.171491825099404,0.929396602673453,null,null,0.450745057517377,null,null,null,null,0.813920758582929,null,null,0.508720417566803,null,0.337349432328041,null,null,0.537390688405764,null,0.0204549943217552,0.0728400574973869,0.156444735855641,0.394732100076525,0.908359909487079,null,0.347278418888911,0.772947118545277,0.0306013561363653,0.902322543168491,0.0488709831137668,0.016792409901913,0.679933782630941,0.896307269217059,null,null,null,0.511568143203146,null,0.165931629271173,0.478056823327385,null,0.656338074319533,0.0404360342386719,null,0.038504731974528,0.209722464353781,0.2095781293948,null,0.191247288258604,null,0.222270047061442,null,null,null,0.469707976808239,0.233798266121404,null,0.858396812083871,null,null,null,0.291645749274404,0.102755524644256,0.200457418181104,0.330937942076858,0.671791143761073,0.0242059233254764,0.633084651353202,null,0.336356744143913,null,0.109644292665713,0.174058444553919,0.818459270211319,null,0.0978864529181562,null,0.338911533012528,0.678897136248626,null,0.0324788946353599,0.127571442439289,0.170981606998819,0.113568022472743,0.00763510975789894,0.17261988089202,0.164500894788413,0.26029792893849,0.382359900946251,null,0.188759329433557,0.279839579695683],[null,"4_119471529_121736832.L1",null,null,"7_5814895_6534226.L2,7_5814895_6534226.L1","15_51385363_52776899.L3",null,null,null,null,null,null,"8_11421489_13634266.L2",null,null,null,null,null,"17_1269105_2025437.L4","19_19766662_20722951.L3",null,null,null,null,null,"2_28375910_28994693.L1",null,null,null,null,"10_102620653_104935290.L3","10_101189482_102620653.L1",null,null,null,null,null,"4_55681477_58068842.L1",null,null,null,null,null,null,"22_31043932_32268999.L1","20_2488855_3847766.L1",null,null,null,"2_198446401_200711561.L1",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"1_109761309_111199115.L1",null,"1_99335048_100360849.L1",null,null,null,"4_73726673_76209554.L2",null,"19_48778970_51029311.L1",null,null,null,null,null,null,null,null,null,null,null,"19_33772047_35978393.L3","19_45599439_46646825.L1",null,null,null,null,"8_29470379_31276213.L3",null,null,"19_18299052_19766662.L3",null,"14_90830516_92665954.L2",null,null,null,"16_77489781_78422395.L1",null,"22_23370460_24588236.L3",null,null,null,"17_38653091_40721152.L2","20_3847766_5497204.L1","7_2022763_2732593.L2",null,null,null,null,"3_195065945_196244537.L1","17_21387045_29007226.L2","21_41901419_43086158.L2","22_17193405_17813322.L2",null,null,"6_127219316_129539886.L3,6_127219316_129539886.L1","6_121584530_123535036.L1","22_29255810_31043932.L2","22_15927607_17193405.L4","4_6771316_7537965.L4",null,"10_4530082_5941799.L1","11_101460390_104088908.L1",null,null,null,"20_40982216_41957049.L1","19_33772047_35978393.L2","12_94120791_95627009.L1",null,null,"19_6684874_8282629.L3","2_237852338_239030947.L1",null,null,null,"10_13279600_14984069.L1","1_178985335_181174985.L1","9_127293231_129403191.L4","6_149932268_151591568.L1","17_41743558_43694719.L1",null,null,null,"17_5838014_7414079.L2","11_15721006_17556855.L1",null,null,"5_130183332_132803957.L3",null,null,null,"12_121569746_124493434.L2","17_21387045_29007226.L1","13_110579726_111595245.L1",null,null,"9_34642246_36743286.L2",null,"7_2022763_2732593.L3",null,"10_71748755_73662792.L1","2_180448012_181401304.L4","11_1192365_3644251.L3","3_110794923_113096852.L1","9_131252501_132423455.L1","6_148599216_149932268.L1",null,"2_37905569_38804195.L1","17_38653091_40721152.L5",null,null,"1_109761309_111199115.L2","10_76947056_79116992.L1",null,null,null,"22_23370460_24588236.L4",null,"10_22886203_25289667.L3",null,"11_87719343_89475768.L1",null,"7_46947122_49172682.L3",null,null,"8_39081287_40845818.L1",null,"6_127219316_129539886.L3","19_52482037_54099074.L1","7_16862445_19441924.L4","6_137293081_138501492.L1",null,null,"3_132117672_133533329.L2,3_132117672_133533329.L1",null,"6_129539886_130614309.L1",null,"3_185350467_187172556.L3","2_217530757_219589829.L3",null,null,"1_204711940_206268085.L3","10_91575290_93636611.L3",null,null,null,null,"3_49279539_51797999.L1","16_74937605_75944056.L1","7_137191815_139059933.L2","9_119498019_122109043.L1",null,"14_104535386_105874495.L1","7_55623891_57314931.L1","12_57155077_58914885.L1",null,"7_139059933_140233377.L1",null,"4_53011266_54563389.L2","17_29007226_31459473.L2",null,"3_118811404_120804208.L2","7_80258753_82393370.L2","14_92665954_93858939.L2",null,null,null,"17_61235394_63468228.L1","12_94120791_95627009.L2","3_181793378_184051895.L2","1_70906787_71218722.L1","8_143155464_145078481.L1","1_206268085_208237019.L1",null,null,"18_74304227_75815032.L1",null,"17_47798656_49440038.L1",null,null,"8_123849219_124671478.L1","9_93909416_96159758.L1","20_9750273_11268888.L3","5_96627815_97979897.L1",null,"11_95992877_97186058.L1",null,"19_610729_2098397.L3","2_184415446_189017339.L1","9_82825886_84323281.L1","19_610729_2098397.L1","17_3799018_4792966.L1","7_72409900_73920272.L1","19_46646825_48778970.L2","3_47685722_49279539.L2","5_147802435_149283061.L4","10_93636611_94461486.L3","10_73662792_76947056.L1","8_106398526_107635949.L1","2_98378738_101205867.L2"],[null,1,null,null,1,1,null,null,null,null,null,null,1,null,null,null,null,null,1,1,null,null,null,null,null,0.999999976264612,null,null,null,null,0.999999289936676,0.999999215478263,null,null,null,null,null,0.999983026743812,null,null,null,null,null,null,0.999899048254865,0.999843689603177,null,null,null,0.999730372367175,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.468155501941522,null,0.425937196191936,null,null,null,0.990997787515927,null,0.569562777196281,null,null,null,null,null,null,null,null,null,null,null,0.982625012819416,0.949737119025331,null,null,null,null,0.978682684954474,null,null,0.587267086713916,null,0.266419724231019,null,null,null,0.726152208516565,null,0.189584890725754,null,null,null,0.908017989501915,0.0417408245595529,0.0452265253363195,null,null,null,null,0.018004408660147,0.37417820282328,0.962642174320693,0.597985867767091,null,null,0.0505033425852308,0.476419469780594,0.260524700645197,0.808551130724547,0.765155406271829,null,0.474626993281485,0.342065121649968,null,null,null,0.958259162834219,0.043806172015192,0.93748361587061,null,null,0.894474996739938,0.0256510380436299,null,null,null,0.9127417711267,0.237495553204245,0.29276001213255,0.950716643186998,0.950712129681372,null,null,null,0.014294152793234,0.294288472807453,null,null,0.491583022639055,null,null,null,0.0206927438459843,0.939127797166464,0.318071797701936,null,null,0.00969458254810074,null,0.00581625221700488,null,0.932424336331205,0.489257727093961,0.931906713825214,0.395138050970369,0.680349518522734,0.914786969629232,null,0.929822192339502,0.246692854413475,null,null,0.880315997373079,0.193636857839097,null,null,null,0.924972193117382,null,0.922667979976598,null,0.213584720053744,null,0.443501032938049,null,null,0.308482980229475,null,0.0562194301578661,0.159782773557427,0.711695549598542,0.513812475113968,null,null,0.345713740685284,null,0.0420065913720009,null,0.404106091638237,0.0609494633395187,null,null,0.894668483292533,0.00334675380165461,null,null,null,null,0.285968686940853,0.884831346168139,0.203159451112232,0.842006017236216,null,0.441151292918293,0.545980523670823,0.537764209347745,null,0.311037031583293,null,0.38560985774052,0.864448442990047,null,0.416483707797715,0.161526694281994,0.373150062499664,null,null,null,0.856328234500309,0.623825440969959,0.37962766508074,0.317546074507761,0.314428873861484,0.430978490871284,null,null,0.152628124232198,null,0.299683959853085,null,null,0.250384964396326,0.0180328088670976,0.502562984141706,0.247908844049179,null,0.219505275526721,null,0.826747000663655,0.0418996478578366,0.292111161194656,0.650379016855356,0.188946464866782,0.147977419921841,0.229310050043873,0.566655870351667,0.395696606589982,0.370232211313105,0.805325634529968,0.500395318025631,0.374840262409711],["1_234463688_235656136.L3",null,null,null,null,null,null,"6_32714887_33268720.L1",null,"6_28949831_29770194.L3,6_28949831_29770194.L1","7_66224822_68769087.L1",null,null,"4_119012357_119471529.L1","4_80069143_81204161.L2","6_33268720_35487979.L3",null,null,null,"19_19766662_20722951.L2","6_26791023_28050041.L4",null,null,null,null,null,null,"17_78267332_79302554.L1","2_109814855_113164279.L2","19_6684874_8282629.L1",null,null,"10_102620653_104935290.L2",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"3_46616010_47685722.L1","17_44979537_47798656.L2","9_112068802_112930865.L1","6_28050041_28949831.L5",null,"18_14440800_21905883.L1","2_166499460_169111726.L4,2_166499460_169111726.L1",null,null,null,null,null,null,null,null,null,null,"17_5838014_7414079.L1",null,null,null,"9_34642246_36743286.L3",null,null,null,"19_16263605_18299052.L1","19_48778970_51029311.L1",null,null,null,null,"19_46646825_48778970.L3",null,null,null,null,null,"16_88974757_90226404.L1",null,null,"8_139713400_141963553.L2",null,"9_34642246_36743286.L1",null,null,null,null,"19_18299052_19766662.L3",null,null,null,null,null,"16_77489781_78422395.L1",null,"22_23370460_24588236.L3","11_64037097_66131160.L1",null,"11_72574973_74701306.L1",null,null,"7_2022763_2732593.L2",null,null,null,null,"3_195065945_196244537.L1",null,null,null,"9_136047132_136605890.L1","1_226623159_229020501.L2","6_127219316_129539886.L1",null,null,null,null,null,null,null,null,null,null,null,"19_33772047_35978393.L4,19_33772047_35978393.L2",null,"1_159943258_162376931.L5","2_26672117_28375910.L1",null,null,null,"2_109814855_113164279.L1","3_178389377_179656798.L1",null,null,null,null,null,"1_206268085_208237019.L2",null,null,"17_5838014_7414079.L2",null,null,"7_1313431_2022763.L1",null,null,"15_64812469_66802429.L2",null,"12_121569746_124493434.L2",null,"13_110579726_111595245.L1",null,null,"9_34642246_36743286.L2",null,"7_2022763_2732593.L3","3_42498510_45123661.L1",null,null,null,"3_110794923_113096852.L1","9_131252501_132423455.L1","6_148599216_149932268.L1",null,null,null,null,null,null,"10_76947056_79116992.L1",null,null,null,null,null,null,null,null,null,null,null,null,"8_39081287_40845818.L1","6_68813556_70899807.L1","6_127219316_129539886.L3","19_52482037_54099074.L1",null,null,null,null,null,null,"6_129539886_130614309.L1",null,"3_185350467_187172556.L3","2_217530757_219589829.L3",null,null,null,null,"15_73336373_76106283.L1",null,"1_25190354_27075376.L2",null,null,null,null,null,null,"14_104535386_105874495.L1",null,"12_57155077_58914885.L1","11_70855_1192365.L4","7_139059933_140233377.L1",null,null,null,null,"3_118811404_120804208.L2",null,null,null,null,null,null,null,"3_181793378_184051895.L2",null,"8_143155464_145078481.L1",null,null,"1_208237019_210614406.L1",null,null,null,null,"19_8282629_9127717.L1",null,null,"20_9750273_11268888.L3","5_96627815_97979897.L1",null,"11_95992877_97186058.L1",null,null,null,"9_82825886_84323281.L1",null,"17_3799018_4792966.L1","7_72409900_73920272.L1","19_46646825_48778970.L2",null,"5_147802435_149283061.L4",null,null,null,null],[1,null,null,null,null,null,null,1,null,1,1,null,null,1,0.999999999993085,1,null,null,null,1,1,null,null,null,null,null,null,0.999999949225681,0.999999860255303,0.99999965022637,null,null,0.999998774308259,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.999104321157698,0.0163275989403284,0.99900503581682,0.998976016653751,null,0.998552449969474,0.927623279173257,null,null,null,null,null,null,null,null,null,null,0.0646524831492148,null,null,null,0.114313182263779,null,null,null,0.9902543239117,0.252277492602847,null,null,null,null,0.98875260581141,null,null,null,null,null,0.984690805351519,null,null,0.877715992932479,null,0.979799161238675,null,null,null,null,0.139131190254725,null,null,null,null,null,0.150091264400792,null,0.0449119920676484,0.8545376610809,null,0.971080871242805,null,null,0.853200575877329,null,null,null,null,0.947661857793262,null,null,null,0.961809425189533,0.961442641944996,0.77549362004699,null,null,null,null,null,null,null,null,null,null,null,0.445433069025035,null,0.940220322321869,0.956545224800035,null,null,null,0.341167266216138,0.306971648625206,null,null,null,null,null,0.846807288933568,null,null,0.162705708309643,null,null,0.943818872648419,null,null,0.93997971904296,null,0.906890584989477,null,0.00259809015736767,null,null,0.684858971762677,null,0.107125163122294,0.752064445775582,null,null,null,0.0936051217533745,0.0831398587545253,0.0156380193781618,null,null,null,null,null,null,0.0853668808275395,null,null,null,null,null,null,null,null,null,null,null,null,0.00211545292074622,0.199641521350046,0.815782372907732,0.371328734707809,null,null,null,null,null,null,0.782528204508786,null,0.371584167882501,0.443129832318841,null,null,null,null,0.825867166077599,null,0.886233366456003,null,null,null,null,null,null,0.126503883978215,null,0.0627674596181667,0.874412007526003,0.122796541486966,null,null,null,null,0.280270837743998,null,null,null,null,null,null,null,0.0386562597750358,null,0.333873005709831,null,null,0.0362694034595881,null,null,null,null,0.00738030220309005,null,null,0.119053256200256,0.165853778881734,null,0.02423718778697,null,null,null,0.314293201714793,null,0.0550919340664798,0.277744422653822,0.135210896010832,null,0.0266699067225887,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>Whole_Blood_cs_id<\/th>\n      <th>Whole_Blood_pip<\/th>\n      <th>Adipose_Subcutaneous_cs_id<\/th>\n      <th>Adipose_Subcutaneous_pip<\/th>\n      <th>Esophagus_Muscularis_cs_id<\/th>\n      <th>Esophagus_Muscularis_pip<\/th>\n      <th>Cells_Cultured_fibroblasts_cs_id<\/th>\n      <th>Cells_Cultured_fibroblasts_pip<\/th>\n      <th>Thyroid_cs_id<\/th>\n      <th>Thyroid_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9,11,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>combined_pip_by_group_multi &lt;- combine_gene_pips(susie_alpha_res_multi, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;group&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = F)

combined_pip_by_group_sig_multi &lt;- combined_pip_by_group_multi[combined_pip_by_group_multi$combined_pip &gt; 0.8,]

plot_heatmap(heatmap_data = combined_pip_by_group_sig_multi, main = &quot;PIP partitions for genes with PIP&gt;0.8&quot;)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-31-3.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
<div id="comparing-with-single-tissue-eqtl-analysis-5"
class="section level2">
<h2>Comparing with single tissue + eQTL analysis</h2>
<pre class="r"><code>ctwas_res_single &lt;- readRDS(paste0(&quot;/project/xinhe/xsun/multi_group_ctwas/10.single_tissue_1007/results/&quot;,trait,&quot;/&quot;,tissue[1],&quot;/&quot;,trait,&quot;_&quot;,tissue[1], &quot;.ctwas.res.RDS&quot;))

susie_alpha_res_single &lt;- ctwas_res_single$susie_alpha_res

susie_alpha_res_single &lt;- anno_susie_alpha_res(susie_alpha_res_single,
                                        mapping_table = mapping_predictdb,
                                        map_by = &quot;molecular_id&quot;,
                                        drop_unmapped = TRUE)</code></pre>
<pre><code>2024-10-16 11:09:02 INFO::Annotating susie alpha result ...
2024-10-16 11:09:02 INFO::Map molecular traits to genes</code></pre>
<pre class="r"><code>combined_pip_by_type_single &lt;- combine_gene_pips(susie_alpha_res_single, 
                                             group_by = &quot;gene_name&quot;,
                                             by = &quot;type&quot;,
                                             method = &quot;combine_cs&quot;,
                                             filter_cs = TRUE,
                                             include_cs_id = F)

combined_pip_by_type_sig_single &lt;- combined_pip_by_type_single[combined_pip_by_type_single$combined_pip &gt; 0.8,]
combined_pip_by_type_sig_multi &lt;- combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$combined_pip &gt; 0.8,]

sprintf(&quot;Number of genes with PIP &gt; 0.8  -- Multi-group = %s&quot;, nrow(combined_pip_by_type_sig_multi))</code></pre>
<pre><code>[1] &quot;Number of genes with PIP &gt; 0.8  -- Multi-group = 272&quot;</code></pre>
<pre class="r"><code>sprintf(&quot;Number of genes with PIP &gt; 0.8  -- single eQTL = %s&quot;, nrow(combined_pip_by_type_sig_single))</code></pre>
<pre><code>[1] &quot;Number of genes with PIP &gt; 0.8  -- single eQTL = 81&quot;</code></pre>
<pre class="r"><code>sprintf(&quot;Number of overlapped genes = %s&quot;, sum(combined_pip_by_type_sig_single$gene_name %in% combined_pip_by_type_sig_multi$gene_name))</code></pre>
<pre><code>[1] &quot;Number of overlapped genes = 61&quot;</code></pre>
<pre class="r"><code>genes_not_reported &lt;- combined_pip_by_type_sig_single$gene_name[!combined_pip_by_type_sig_single$gene_name %in%combined_pip_by_type_sig_multi$gene_name]

DT::datatable(combined_pip_by_type_sig_single[combined_pip_by_type_sig_single$gene_name %in% genes_not_reported,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Genes not reported by multi-group analysis&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-28fc46a89962ff28ef30" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-28fc46a89962ff28ef30">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Genes not reported by multi-group analysis<\/caption>","data":[["1","2","5","29","33","41","45","49","51","52","53","56","57","62","67","73","74","77","79","81"],["RABGEF1","TMED8","MAPT","FCER1G","APOBR","ZFPM1","ERAL1","MLX","FOXJ2","HTT","BAK1","RNF181","TIMM50","JMJD6","CALCOCO2","GPN2","GLS","LIN54","CA11","TCF7L1"],[1,1,0.999999981777348,0.99039712697777,0.986456492435431,0.979814394851034,0.96262472751727,0.953198146442857,0.935462305226436,0.935309719280414,0.929309428863728,0.920590186326879,0.909659637854985,0.888134123658638,0.879413584285318,0.85788133780747,0.853655314243993,0.833936657220567,0.817807567073692,0.800306539782248],[1,1,0.999999981777348,0.99039712697777,0.986456492435431,0.979814394851034,0.96262472751727,0.953198146442857,0.935462305226436,0.935309719280414,0.929309428863728,0.920590186326879,0.909659637854985,0.888134123658638,0.879413584285318,0.85788133780747,0.853655314243993,0.833936657220567,0.817807567073692,0.800306539782248]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>DT::datatable(combined_pip_by_type_cs_multi[combined_pip_by_type_cs_multi$gene_name %in% genes_not_reported,],caption = htmltools::tags$caption( style = &#39;caption-side: topleft; text-align = left; color:black;&#39;,&#39;Genes not reported by multi-group analysis&#39;),options = list(pageLength = 5) )</code></pre>
<div id="htmlwidget-018aa8438ee3bad3ceee" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-018aa8438ee3bad3ceee">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: topleft; text-align = left; color:black;\">Genes not reported by multi-group analysis<\/caption>","data":[["277","300","319","330","367","485","499","539","666","706","707","944"],["MLX","TIMM50","APOBR","JMJD6","GLS","FOXJ2","TCF7L1","RNF181","FCER1G","HTT","CA11","ERAL1"],["17_41743558_43694719.L2","19_37036131_39679979.L1","16_27434434_29025292.L4","17_76379479_78267332.L3","2_189017339_191108631.L1","12_6310587_8224940.L3","2_84913556_87738988.L1,2_84913556_87738988.L2","2_84913556_87738988.L2","1_159943258_162376931.L2","4_2841252_3844313.L1","19_46646825_48778970.L2","17_21387045_29007226.L1"],[0.793903891111874,0.751442165889978,0.722389060756988,0.702148985576424,0.635197710714501,0.428078735595654,0.40546034836741,0.352989114690886,0.18268188642243,0.145576628396604,0.144684598336194,0.0312415051820285],["17_41743558_43694719.L2","19_37036131_39679979.L1","16_27434434_29025292.L4","17_76379479_78267332.L3","2_189017339_191108631.L1","12_6310587_8224940.L3","2_84913556_87738988.L1","2_84913556_87738988.L2","1_159943258_162376931.L2","4_2841252_3844313.L1","19_46646825_48778970.L2","17_21387045_29007226.L1"],[0.555724877298348,0.751442165889978,0.722389060756988,0.576629056335538,0.63320977352553,0.428078735595654,0.400580964070951,0.125268440062605,0.18268188642243,0.0882597827360228,0.144684598336194,0.0312415051820285],["17_41743558_43694719.L2",null,null,null,"2_189017339_191108631.L1",null,null,"2_84913556_87738988.L2",null,"4_2841252_3844313.L1",null,null],[0.198692315264003,null,null,null,0.00198793718897183,null,null,0.071400654107206,null,0.0573168456605813,null,null],["17_41743558_43694719.L2",null,null,"17_76379479_78267332.L3",null,null,"2_84913556_87738988.L2","2_84913556_87738988.L2",null,null,null,null],[0.0395105928689127,null,null,0.125543821852616,null,null,0.0081401888886915,0.156320020521075,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>gene_name<\/th>\n      <th>combined_cs_id<\/th>\n      <th>combined_pip<\/th>\n      <th>eQTL_cs_id<\/th>\n      <th>eQTL_pip<\/th>\n      <th>sQTL_cs_id<\/th>\n      <th>sQTL_pip<\/th>\n      <th>stQTL_cs_id<\/th>\n      <th>stQTL_pip<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,5,7,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>gene_multi_unique_type &lt;- combined_pip_by_group_sig_multi[!combined_pip_by_group_sig_multi$gene_name %in%  combined_pip_by_type_sig_single$gene_name,]

plot_heatmap(heatmap_data = gene_multi_unique_type, main = &quot;PIP partition for unique genes found by multi-group analysis&quot;)</code></pre>
<p><img src="figure/multi_group_6traits_15weights_ess.Rmd/unnamed-chunk-33-1.png" width="1152" style="display: block; margin: auto;" /></p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.0 (2022-04-22)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: CentOS Linux 7 (Core)

Matrix products: default
BLAS/LAPACK: /software/openblas-0.3.13-el7-x86_64/lib/libopenblas_haswellp-r0.3.13.so

locale:
[1] C

attached base packages:
[1] stats4    stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] EnsDb.Hsapiens.v86_2.99.0 ensembldb_2.20.2         
 [3] AnnotationFilter_1.20.0   GenomicFeatures_1.48.3   
 [5] AnnotationDbi_1.58.0      Biobase_2.56.0           
 [7] GenomicRanges_1.48.0      GenomeInfoDb_1.39.9      
 [9] IRanges_2.30.0            S4Vectors_0.34.0         
[11] BiocGenerics_0.42.0       pheatmap_1.0.12          
[13] forcats_0.5.1             stringr_1.5.1            
[15] dplyr_1.1.4               purrr_1.0.2              
[17] readr_2.1.2               tidyr_1.3.0              
[19] tibble_3.2.1              tidyverse_1.3.1          
[21] ggplot2_3.5.1             ctwas_0.4.15             

loaded via a namespace (and not attached):
  [1] readxl_1.4.0                backports_1.4.1            
  [3] workflowr_1.7.0             BiocFileCache_2.4.0        
  [5] lazyeval_0.2.2              BiocParallel_1.30.3        
  [7] crosstalk_1.2.0             LDlinkR_1.2.3              
  [9] digest_0.6.29               htmltools_0.5.2            
 [11] fansi_1.0.3                 magrittr_2.0.3             
 [13] memoise_2.0.1               tzdb_0.4.0                 
 [15] Biostrings_2.64.0           modelr_0.1.8               
 [17] matrixStats_0.62.0          locuszoomr_0.2.1           
 [19] prettyunits_1.1.1           colorspace_2.0-3           
 [21] blob_1.2.3                  rvest_1.0.2                
 [23] rappdirs_0.3.3              ggrepel_0.9.1              
 [25] haven_2.5.0                 xfun_0.41                  
 [27] crayon_1.5.1                RCurl_1.98-1.7             
 [29] jsonlite_1.8.0              zoo_1.8-10                 
 [31] glue_1.6.2                  gtable_0.3.0               
 [33] zlibbioc_1.42.0             XVector_0.36.0             
 [35] DelayedArray_0.22.0         scales_1.3.0               
 [37] DBI_1.2.2                   Rcpp_1.0.12                
 [39] viridisLite_0.4.0           progress_1.2.2             
 [41] bit_4.0.4                   DT_0.22                    
 [43] htmlwidgets_1.5.4           httr_1.4.3                 
 [45] RColorBrewer_1.1-3          ellipsis_0.3.2             
 [47] pkgconfig_2.0.3             XML_3.99-0.14              
 [49] farver_2.1.0                sass_0.4.1                 
 [51] dbplyr_2.1.1                utf8_1.2.2                 
 [53] tidyselect_1.2.0            labeling_0.4.2             
 [55] rlang_1.1.2                 later_1.3.0                
 [57] munsell_0.5.0               pgenlibr_0.3.3             
 [59] cellranger_1.1.0            tools_4.2.0                
 [61] cachem_1.0.6                cli_3.6.1                  
 [63] generics_0.1.2              RSQLite_2.3.1              
 [65] broom_0.8.0                 evaluate_0.15              
 [67] fastmap_1.1.0               yaml_2.3.5                 
 [69] knitr_1.39                  bit64_4.0.5                
 [71] fs_1.5.2                    KEGGREST_1.36.3            
 [73] whisker_0.4                 xml2_1.3.3                 
 [75] biomaRt_2.54.1              compiler_4.2.0             
 [77] rstudioapi_0.13             plotly_4.10.0              
 [79] filelock_1.0.2              curl_4.3.2                 
 [81] png_0.1-7                   reprex_2.0.1               
 [83] bslib_0.3.1                 stringi_1.7.6              
 [85] highr_0.9                   lattice_0.20-45            
 [87] ProtGenerics_1.28.0         Matrix_1.5-3               
 [89] vctrs_0.6.5                 pillar_1.9.0               
 [91] lifecycle_1.0.4             jquerylib_0.1.4            
 [93] data.table_1.14.2           cowplot_1.1.1              
 [95] bitops_1.0-7                irlba_2.3.5                
 [97] httpuv_1.6.5                rtracklayer_1.56.0         
 [99] R6_2.5.1                    BiocIO_1.6.0               
[101] promises_1.2.0.1            gridExtra_2.3              
[103] codetools_0.2-18            assertthat_0.2.1           
[105] SummarizedExperiment_1.26.1 rprojroot_2.0.3            
[107] rjson_0.2.21                withr_2.5.0                
[109] GenomicAlignments_1.32.0    Rsamtools_2.12.0           
[111] GenomeInfoDbData_1.2.8      parallel_4.2.0             
[113] hms_1.1.1                   grid_4.2.0                 
[115] gggrid_0.2-0                rmarkdown_2.25             
[117] MatrixGenerics_1.8.0        logging_0.10-108           
[119] git2r_0.30.1                mixsqp_0.3-43              
[121] lubridate_1.8.0             restfulr_0.0.14            </code></pre>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
